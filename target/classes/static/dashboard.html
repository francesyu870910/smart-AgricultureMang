<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ê∏©ÂÆ§Êï∞Â≠óÂåñÁõëÊéßÁ≥ªÁªü</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå±</text></svg>">
    <script src="dashboard-emergency-fix.js"></script>
    <script src="user-management-standalone.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            color: #333;
        }

        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #2C3E50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            margin-right: 30px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 6px 12px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        /* ‰æßËæπÊ†è */
        .sidebar {
            position: fixed;
            top: 60px;
            left: 0;
            width: 280px;
            height: calc(100vh - 60px);
            background: #34495E;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.2);
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar-menu {
            padding: 30px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            color: #ecf0f1;
            text-decoration: none;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }

        .menu-item:hover {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: #3498db;
            color: #3498db;
            transform: translateX(5px);
        }

        .menu-item.active {
            background: rgba(46, 204, 113, 0.2);
            border-left-color: #2ecc71;
            color: #2ecc71;
            transform: translateX(5px);
        }

        .menu-item .icon {
            margin-right: 15px;
            width: 24px;
            height: 24px;
            font-size: 20px;
            text-align: center;
        }

        /* ‰∏ªÂÜÖÂÆπÂå∫Âüü */
        .main-content {
            margin-left: 280px;
            margin-top: 60px;
            padding: 30px;
            min-height: calc(100vh - 60px);
            background: #f8f9fa;
            transition: all 0.3s ease;
        }

        /* ÂÜÖÂÆπÈ°µÈù¢ÂÆπÂô® */
        .content-page {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .content-page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* È°µÈù¢Ê†áÈ¢ò */
        .page-header {
            background: white;
            padding: 25px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #4CAF50;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin: 0;
            display: flex;
            align-items: center;
        }

        .page-title .icon {
            margin-right: 15px;
            font-size: 32px;
        }

        .page-subtitle {
            color: #7f8c8d;
            margin-top: 8px;
            font-size: 16px;
        }

        /* Á≥ªÁªüÁä∂ÊÄÅÁΩëÊ†º */
        .system-status {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .status-item {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
        }

        .status-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .status-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .status-value.status-online {
            color: #28a745;
        }

        .status-value.status-warning {
            color: #ffc107;
        }

        .status-value.status-error {
            color: #dc3545;
        }

        .status-label {
            color: #666;
            font-size: 14px;
        }

        /* ‰ª™Ë°®ÊùøÂç°Áâá */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            border-color: #4CAF50;
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            font-size: 48px;
            margin-right: 20px;
        }

        .card-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .card-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .card-action {
            color: #4CAF50;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .dashboard-cards {
                grid-template-columns: 1fr;
            }
        }

        /* Âä®ÁîªÊïàÊûú */
        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* ÂºπÁ™óÂä®Áîª */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Ë°®ÂçïÊ†∑Âºè‰ºòÂåñ */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498DB;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
    </style>
</head>

<body>
    <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
    <header class="header">
        <div class="header-left">
            <div class="logo">üå± Ê∏©ÂÆ§Êï∞Â≠óÂåñÁõëÊéßÁ≥ªÁªü</div>
        </div>
        <div class="header-right">
            <div class="user-info">
                <span>üë§ ÁÆ°ÁêÜÂëò</span>
                <button class="logout-btn" onclick="logoutSystem()">ÈÄÄÂá∫Á≥ªÁªü</button>
            </div>
        </div>
    </header>

    <!-- ‰æßËæπÊ†è -->
    <aside class="sidebar">
        <nav class="sidebar-menu">
            <div class="menu-item active" onclick="showPage('dashboard')">
                <span class="icon">üìä</span> Á≥ªÁªüÊ¶ÇËßà
            </div>
            <div class="menu-item" onclick="showPage('environment')">
                <span class="icon">üå°Ô∏è</span> ÁéØÂ¢ÉÁõëÊéß
            </div>
            <div class="menu-item" onclick="showPage('devices')">
                <span class="icon">‚öôÔ∏è</span> ËÆæÂ§áÊéßÂà∂
            </div>
            <div class="menu-item" onclick="showPage('alerts')">
                <span class="icon">üö®</span> Êä•Ë≠¶ÁÆ°ÁêÜ
            </div>
            <div class="menu-item" onclick="showPage('tasks')">
                <span class="icon">‚è∞</span> ÂÆöÊó∂‰ªªÂä°
            </div>
            <div class="menu-item" onclick="showPage('analytics')">
                <span class="icon">üìà</span> Êï∞ÊçÆÂàÜÊûê
            </div>
            <div class="menu-item" onclick="showPage('history')">
                <span class="icon">üìã</span> ÂéÜÂè≤ËÆ∞ÂΩï
            </div>
            <div class="menu-item" onclick="showPage('users')">
                <span class="icon">üë•</span> Áî®Êà∑ÁÆ°ÁêÜ
            </div>
        </nav>
    </aside>

    <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
    <main class="main-content">
        <!-- Á≥ªÁªüÊ¶ÇËßàÈ°µÈù¢ -->
        <div id="dashboard-page" class="content-page active">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">üìä</span>
                    Á≥ªÁªüÊ¶ÇËßà
                </h1>
                <p class="page-subtitle">Ê∏©ÂÆ§Êï∞Â≠óÂåñÁõëÊéßÁ≥ªÁªüÊÄªËßà</p>
            </div>

            <!-- Á≥ªÁªüÁä∂ÊÄÅ -->
            <div class="system-status">
                <h2 style="margin-bottom: 20px;">Á≥ªÁªüÁä∂ÊÄÅ</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-value status-online" id="systemStatus">Ê≠£Â∏∏</div>
                        <div class="status-label">Á≥ªÁªüÁä∂ÊÄÅ</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value status-online" id="deviceCount">12</div>
                        <div class="status-label">Âú®Á∫øËÆæÂ§á</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value status-warning" id="alertCount">3</div>
                        <div class="status-label">ÂæÖÂ§ÑÁêÜÊä•Ë≠¶</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value status-online" id="taskStatus">ËøêË°å‰∏≠</div>
                        <div class="status-label">ÂÆöÊó∂‰ªªÂä°</div>
                    </div>
                </div>
            </div>

            <!-- ÂäüËÉΩÊ®°ÂùóÂç°Áâá -->
            <div class="dashboard-cards">
                <div class="card environment-card" onclick="showPage('environment')">
                    <div class="card-header">
                        <div class="card-icon">üå°Ô∏è</div>
                        <div class="card-title">ÁéØÂ¢ÉÁõëÊéß</div>
                    </div>
                    <div class="card-description">
                        ÂÆûÊó∂ÁõëÊéßÊ∏©ÂÆ§ÂÜÖÁöÑÊ∏©Â∫¶„ÄÅÊπøÂ∫¶„ÄÅÂÖâÁÖßÂº∫Â∫¶„ÄÅÂúüÂ£§ÊπøÂ∫¶ÂíåCO2ÊµìÂ∫¶Á≠âÁéØÂ¢ÉÂèÇÊï∞
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>

                <div class="card device-card" onclick="showPage('devices')">
                    <div class="card-header">
                        <div class="card-icon">‚öôÔ∏è</div>
                        <div class="card-title">ËÆæÂ§áÊéßÂà∂</div>
                    </div>
                    <div class="card-description">
                        ËøúÁ®ãÊéßÂà∂Ê∏©ÂÆ§ÂÜÖÁöÑÂä†ÁÉ≠Âô®„ÄÅÂÜ∑Âç¥Âô®„ÄÅÂä†ÊπøÂô®„ÄÅÈ£éÊâá„ÄÅË°•ÂÖâÁÅØÁ≠âËÆæÂ§á
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>

                <div class="card alert-card" onclick="showPage('alerts')">
                    <div class="card-header">
                        <div class="card-icon">üö®</div>
                        <div class="card-title">Êä•Ë≠¶ÁÆ°ÁêÜ</div>
                    </div>
                    <div class="card-description">
                        ÁÆ°ÁêÜÁéØÂ¢ÉÂèÇÊï∞ÂºÇÂ∏∏„ÄÅËÆæÂ§áÊïÖÈöúÁ≠âÂêÑÁ±ªÊä•Ë≠¶‰ø°ÊÅØÔºåÂèäÊó∂ÂìçÂ∫îÂ§ÑÁêÜ
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>

                <div class="card task-card" onclick="showPage('tasks')">
                    <div class="card-header">
                        <div class="card-icon">‚è∞</div>
                        <div class="card-title">ÂÆöÊó∂‰ªªÂä°</div>
                    </div>
                    <div class="card-description">
                        ÁÆ°ÁêÜÊï∞ÊçÆÈááÈõÜ„ÄÅËÆæÂ§áÊéßÂà∂„ÄÅÊä•Ë≠¶Ê£ÄÊµãÁ≠âËá™Âä®ÂåñÂÆöÊó∂‰ªªÂä°
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>

                <div class="card analytics-card" onclick="showPage('analytics')">
                    <div class="card-header">
                        <div class="card-icon">üìà</div>
                        <div class="card-title">Êï∞ÊçÆÂàÜÊûê</div>
                    </div>
                    <div class="card-description">
                        ÂàÜÊûêÁéØÂ¢ÉÊï∞ÊçÆË∂ãÂäøÔºåÁîüÊàêÁªüËÆ°Êä•Ë°®Ôºå‰ºòÂåñÊ∏©ÂÆ§ÁÆ°ÁêÜÁ≠ñÁï•
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>

                <div class="card history-card" onclick="showPage('history')">
                    <div class="card-header">
                        <div class="card-icon">üìã</div>
                        <div class="card-title">ÂéÜÂè≤ËÆ∞ÂΩï</div>
                    </div>
                    <div class="card-description">
                        Êü•ÁúãÂéÜÂè≤ÁéØÂ¢ÉÊï∞ÊçÆ„ÄÅËÆæÂ§áÊìç‰ΩúËÆ∞ÂΩï„ÄÅÊä•Ë≠¶Â§ÑÁêÜËÆ∞ÂΩïÁ≠â
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>

                <div class="card user-card" onclick="showPage('users')">
                    <div class="card-header">
                        <div class="card-icon">üë•</div>
                        <div class="card-title">Áî®Êà∑ÁÆ°ÁêÜ</div>
                    </div>
                    <div class="card-description">
                        ÁÆ°ÁêÜÁ≥ªÁªüÁî®Êà∑Ë¥¶Êà∑„ÄÅÊùÉÈôêËÆæÁΩÆ„ÄÅÁî®Êà∑Áä∂ÊÄÅÁõëÊéßÁ≠âÂäüËÉΩ
                    </div>
                    <a href="#" class="card-action">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</a>
                </div>
            </div>
        </div>

        <!-- ÁéØÂ¢ÉÁõëÊéßÈ°µÈù¢ -->
        <div id="environment-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">üå°Ô∏è</span>
                    ÁéØÂ¢ÉÁõëÊéß
                </h1>
                <p class="page-subtitle">ÂÆûÊó∂ÁõëÊéßÊ∏©ÂÆ§ÁéØÂ¢ÉÂèÇÊï∞</p>
            </div>
            <div id="environment-content">Ê≠£Âú®Âä†ËΩΩÁéØÂ¢ÉÁõëÊéßÊï∞ÊçÆ...</div>
        </div>

        <!-- ËÆæÂ§áÊéßÂà∂È°µÈù¢ -->
        <div id="devices-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">‚öôÔ∏è</span>
                    ËÆæÂ§áÊéßÂà∂
                </h1>
                <p class="page-subtitle">ËøúÁ®ãÊéßÂà∂Ê∏©ÂÆ§ËÆæÂ§á</p>
            </div>
            <div id="devices-content">Ê≠£Âú®Âä†ËΩΩËÆæÂ§áÊéßÂà∂Èù¢Êùø...</div>
        </div>

        <!-- Êä•Ë≠¶ÁÆ°ÁêÜÈ°µÈù¢ -->
        <div id="alerts-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">üö®</span>
                    Êä•Ë≠¶ÁÆ°ÁêÜ
                </h1>
                <p class="page-subtitle">ÁÆ°ÁêÜÁ≥ªÁªüÊä•Ë≠¶‰ø°ÊÅØ</p>
            </div>
            <div id="alerts-content">Ê≠£Âú®Âä†ËΩΩÊä•Ë≠¶ÁÆ°ÁêÜ...</div>
        </div>

        <!-- ÂÆöÊó∂‰ªªÂä°È°µÈù¢ -->
        <div id="tasks-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">‚è∞</span>
                    ÂÆöÊó∂‰ªªÂä°ÁÆ°ÁêÜ
                </h1>
                <p class="page-subtitle">ÁÆ°ÁêÜÁ≥ªÁªüËá™Âä®Âåñ‰ªªÂä°</p>
            </div>
            <div id="tasks-content">Ê≠£Âú®Âä†ËΩΩÂÆöÊó∂‰ªªÂä°...</div>
        </div>

        <!-- Êï∞ÊçÆÂàÜÊûêÈ°µÈù¢ -->
        <div id="analytics-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">üìà</span>
                    Êï∞ÊçÆÂàÜÊûê
                </h1>
                <p class="page-subtitle">ÂàÜÊûêÁéØÂ¢ÉÊï∞ÊçÆÂíåÁ≥ªÁªüÊÄßËÉΩ</p>
            </div>
            <div id="analytics-content">Ê≠£Âú®Âä†ËΩΩÊï∞ÊçÆÂàÜÊûê...</div>
        </div>

        <!-- ÂéÜÂè≤ËÆ∞ÂΩïÈ°µÈù¢ -->
        <div id="history-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">üìã</span>
                    ÂéÜÂè≤ËÆ∞ÂΩï
                </h1>
                <p class="page-subtitle">Êü•ÁúãÁ≥ªÁªüÂéÜÂè≤Êï∞ÊçÆ</p>
            </div>
            <div id="history-content">Ê≠£Âú®Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩï...</div>
        </div>

        <!-- Áî®Êà∑ÁÆ°ÁêÜÈ°µÈù¢ -->
        <div id="users-page" class="content-page">
            <div class="page-header">
                <h1 class="page-title">
                    <span class="icon">üë•</span>
                    Áî®Êà∑ÁÆ°ÁêÜ
                </h1>
                <p class="page-subtitle">ÁÆ°ÁêÜÁ≥ªÁªüÁî®Êà∑Ë¥¶Êà∑ÂíåÊùÉÈôê</p>
            </div>
            <div id="users-content">Ê≠£Âú®Âä†ËΩΩÁî®Êà∑ÁÆ°ÁêÜ...</div>
        </div>
    </main>
    <script>
        // ÊúÄÂ∞èÂåñËÑöÊú¨ - ÊâÄÊúâ‰∏ªË¶ÅÂäüËÉΩÂ∑≤ÁßªËá≥ dashboard-emergency-fix.js
        console.log('Dashboard main script loading...');

        // Á°Æ‰øùÁ¥ßÊÄ•‰øÆÂ§çËÑöÊú¨Â∑≤Âä†ËΩΩ
        if (typeof window.showPage !== 'function') {
            console.error('Emergency fix script not loaded! Defining fallback functions...');

            // ÂêéÂ§áÂáΩÊï∞ÂÆö‰πâ
            window.showPage = function (pageId) {
                console.log('Fallback showPage called:', pageId);
                UserFriendlyAlert.showInfo('È°µÈù¢ÂàáÊç¢ÂäüËÉΩÊ≠£Âú®Âä†ËΩΩ‰∏≠ÔºåËØ∑Á®çÂêéÂÜçËØï...');
            };

            window.logoutSystem = function () {
                if (confirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁªüÂêóÔºü')) {
                    window.location.href = '/login.html';
                }
            };
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁöÑÂü∫Êú¨ÂàùÂßãÂåñ

        // Ê∂àÊÅØÊò†Â∞ÑË°® - Â∞ÜÊìç‰ΩúËΩ¨Êç¢‰∏∫Áî®Êà∑ÂèãÂ•ΩÁöÑÊ∂àÊÅØ
        const MESSAGE_MAPPINGS = {
            // ÁéØÂ¢ÉÁõëÊéßÁõ∏ÂÖ≥
            'environment_data_refresh': 'ÁéØÂ¢ÉÊï∞ÊçÆÂ∑≤Âà∑Êñ∞',
            'environment_data_export': 'ÁéØÂ¢ÉÊï∞ÊçÆÂØºÂá∫ÊàêÂäü',
            'environment_alerts_set': 'ÁéØÂ¢ÉÊä•Ë≠¶ËÆæÁΩÆÂ∑≤‰øùÂ≠ò',
            'environment_trends_generated': 'ÁéØÂ¢ÉË∂ãÂäøÂàÜÊûêÂ∑≤ÁîüÊàê',
            'sensors_calibrated': '‰º†ÊÑüÂô®Ê†°ÂáÜÂÆåÊàê',
            'environment_report_generated': 'ÁéØÂ¢ÉÁõëÊµãÊä•ÂëäÁîüÊàêÊàêÂäü',

            // ËÆæÂ§áÊéßÂà∂Áõ∏ÂÖ≥
            'device_start_all': 'ÊâÄÊúâËÆæÂ§áÂêØÂä®ÊàêÂäü',
            'device_stop_all': 'ÊâÄÊúâËÆæÂ§áÂ∑≤ÂÅúÊ≠¢',
            'device_refresh': 'ËÆæÂ§áÁä∂ÊÄÅÂ∑≤Êõ¥Êñ∞',
            'device_start_single': 'ËÆæÂ§áÂêØÂä®ÊàêÂäü',
            'device_stop_single': 'ËÆæÂ§áÂ∑≤ÂÅúÊ≠¢',

            // ‰ªªÂä°ÁÆ°ÁêÜÁõ∏ÂÖ≥
            'tasks_start_all': 'ÊâÄÊúâ‰ªªÂä°Â∑≤ÂêØÂä®',
            'tasks_stop_all': 'ÊâÄÊúâ‰ªªÂä°Â∑≤ÂÅúÊ≠¢',
            'tasks_refresh': '‰ªªÂä°Áä∂ÊÄÅÂ∑≤Âà∑Êñ∞',
            'tasks_trigger_all': '‰ªªÂä°ÊâãÂä®Ëß¶ÂèëÂÆåÊàê',

            // Êï∞ÊçÆÂàÜÊûêÁõ∏ÂÖ≥
            'report_generated': 'ÂàÜÊûêÊä•ÂëäÁîüÊàêÊàêÂäü',
            'analytics_exported': 'ÂàÜÊûêÊï∞ÊçÆÂØºÂá∫ÂÆåÊàê',
            'analytics_refreshed': 'ÂàÜÊûêÊï∞ÊçÆÂ∑≤Êõ¥Êñ∞',

            // Êä•Ë°®‰∏≠ÂøÉÁõ∏ÂÖ≥
            'daily_report_generated': 'ÁéØÂ¢ÉÊï∞ÊçÆÊó•Êä•ÁîüÊàêÊàêÂäü',
            'daily_report_exported': 'ÁéØÂ¢ÉÊï∞ÊçÆÊó•Êä•ÂØºÂá∫ÊàêÂäü',
            'device_report_generated': 'ËÆæÂ§áËøêË°åÊä•ÂëäÁîüÊàêÊàêÂäü',
            'device_report_exported': 'ËÆæÂ§áËøêË°åÊä•ÂëäÂØºÂá∫ÊàêÂäü',
            'monthly_report_generated': 'ÊúàÂ∫¶ÂàÜÊûêÊä•ÂëäÁîüÊàêÊàêÂäü',
            'monthly_report_exported': 'ÊúàÂ∫¶ÂàÜÊûêÊä•ÂëäÂØºÂá∫ÊàêÂäü',
            'alert_report_generated': 'Êä•Ë≠¶ÁªüËÆ°Êä•ÂëäÁîüÊàêÊàêÂäü',
            'alert_report_exported': 'Êä•Ë≠¶ÁªüËÆ°Êä•ÂëäÂØºÂá∫ÊàêÂäü',
            'comprehensive_report_generated': 'ÁªºÂêàÊä•ÂëäÁîüÊàêÊàêÂäü',
            'all_data_exported': 'ÂÖ®ÈÉ®Êï∞ÊçÆÂØºÂá∫ÊàêÂäü',
            'all_analytics_refreshed': 'ÂÖ®ÈÉ®Êï∞ÊçÆÂ∑≤Âà∑Êñ∞',

            // ÂéÜÂè≤ËÆ∞ÂΩïÁõ∏ÂÖ≥
            'history_searched': 'ÂéÜÂè≤ËÆ∞ÂΩïÊêúÁ¥¢ÂÆåÊàê',

            // Áî®Êà∑ÁÆ°ÁêÜÁõ∏ÂÖ≥
            'user_added': 'Áî®Êà∑Ê∑ªÂä†ÊàêÂäü',
            'user_edited': 'Áî®Êà∑‰ø°ÊÅØÊõ¥Êñ∞ÊàêÂäü',
            'user_deleted': 'Áî®Êà∑Âà†Èô§ÊàêÂäü',
            'password_reset': 'ÂØÜÁ†ÅÈáçÁΩÆÊàêÂäü',
            'user_list_exported': 'Áî®Êà∑ÂàóË°®ÂØºÂá∫ÊàêÂäü',
            'user_list_refreshed': 'Áî®Êà∑ÂàóË°®Â∑≤Âà∑Êñ∞',
            'user_searched': 'Áî®Êà∑ÊêúÁ¥¢ÂÆåÊàê',
            'logout_success': 'ÈÄÄÂá∫Á≥ªÁªüÊàêÂäü',

            // Êä•Ë≠¶ÁÆ°ÁêÜÁõ∏ÂÖ≥
            'alert_handled': 'Êä•Ë≠¶Â§ÑÁêÜÊàêÂäü',
            'alert_assigned': 'Êä•Ë≠¶ÂàÜÈÖçÊàêÂäü',
            'alert_ignored': 'Êä•Ë≠¶Â∑≤ÂøΩÁï•',
            'alert_escalated': 'Êä•Ë≠¶‰∏äÊä•ÊàêÂäü',
            'alerts_exported': 'Êä•Ë≠¶ËÆ∞ÂΩïÂØºÂá∫ÊàêÂäü',
            'alerts_refreshed': 'Êä•Ë≠¶ÂàóË°®Â∑≤Âà∑Êñ∞',
            'alerts_filtered': 'Êä•Ë≠¶Á≠õÈÄâÂÆåÊàê'
        };

        // ÈîôËØØÊ∂àÊÅØÊò†Â∞ÑË°®
        const ERROR_MAPPINGS = {
            'connection_failed': 'ÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËÆæÁΩÆ',
            'server_error': 'ÊúçÂä°Âô®ÊöÇÊó∂Êó†Ê≥ïÂìçÂ∫îÔºåËØ∑Á®çÂêéÈáçËØï',
            'data_not_found': 'Êú™ÊâæÂà∞Áõ∏ÂÖ≥Êï∞ÊçÆ',
            'permission_denied': 'ÊùÉÈôê‰∏çË∂≥ÔºåËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëò',
            'validation_failed': 'ËæìÂÖ•‰ø°ÊÅØÊúâËØØÔºåËØ∑Ê£ÄÊü•ÂêéÈáçËØï'
        };

        // Ê∂àÊÅØÊ∏ÖÁêÜÂô®Á±ª
        class MessageCleaner {
            // Ê∏ÖÁêÜÊäÄÊúØ‰ø°ÊÅØ
            static cleanTechnicalInfo(message) {
                if (!message) return message;

                // ÁßªÈô§ÊúçÂä°Âô®Âú∞ÂùÄÂíåÁ´ØÂè£‰ø°ÊÅØ
                let cleanedMessage = message
                    .replace(/localhost:\d+/g, '')
                    .replace(/http:\/\/[^\/\s]+/g, '')
                    .replace(/https:\/\/[^\/\s]+/g, '')
                    .replace(/\d+\.\d+\.\d+\.\d+:\d+/g, '')
                    .replace(/:\d+/g, '')
                    .replace(/localhost/g, '')
                    .replace(/127\.0\.0\.1/g, '');

                // Ê∏ÖÁêÜÂ§ö‰ΩôÁöÑÁ©∫Ê†ºÂíåÊ†áÁÇπ
                cleanedMessage = cleanedMessage
                    .replace(/\s+/g, ' ')
                    .replace(/^\s+|\s+$/g, '')
                    .replace(/^[:\-\s]+|[:\-\s]+$/g, '');

                return cleanedMessage || 'Êìç‰ΩúÂÆåÊàê';
            }

            // ÁßªÈô§ÊúçÂä°Âô®‰ø°ÊÅØ
            static removeServerInfo(message) {
                return this.cleanTechnicalInfo(message);
            }

            // ÁßªÈô§Á´ØÂè£‰ø°ÊÅØ
            static removePortInfo(message) {
                return message ? message.replace(/:\d+/g, '') : message;
            }

            // Ê∏ÖÁêÜURL‰ø°ÊÅØ
            static cleanUrlInfo(message) {
                return message ? message.replace(/https?:\/\/[^\s]+/g, '') : message;
            }
        }

        // Ê∂àÊÅØÊ†ºÂºèÂåñÂô®Á±ª
        class MessageFormatter {
            // Ê†ºÂºèÂåñÊàêÂäüÊ∂àÊÅØ
            static formatSuccess(operation, details = null) {
                const baseMessage = MESSAGE_MAPPINGS[operation] || 'Êìç‰ΩúÊàêÂäü';
                const cleanMessage = MessageCleaner.cleanTechnicalInfo(baseMessage);
                return details ? `${cleanMessage} - ${details}` : cleanMessage;
            }

            // Ê†ºÂºèÂåñÈîôËØØÊ∂àÊÅØ
            static formatError(operation, error = null) {
                if (error && ERROR_MAPPINGS[error]) {
                    return ERROR_MAPPINGS[error];
                }

                const cleanError = error ? MessageCleaner.cleanTechnicalInfo(error) : 'Êìç‰ΩúÂ§±Ë¥•';
                return cleanError || 'Êìç‰ΩúÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï';
            }

            // Ê†ºÂºèÂåñ‰ø°ÊÅØÊèêÁ§∫
            static formatInfo(message) {
                return MessageCleaner.cleanTechnicalInfo(message) || '‰ø°ÊÅØÊèêÁ§∫';
            }

            // Ê†ºÂºèÂåñË≠¶ÂëäÊ∂àÊÅØ
            static formatWarning(message) {
                return MessageCleaner.cleanTechnicalInfo(message) || 'Ë≠¶ÂëäÊèêÁ§∫';
            }
        }

        // Áî®Êà∑ÂèãÂ•ΩÁöÑÂºπÊ°ÜÁªÑ‰ª∂Á±ª
        class UserFriendlyAlert {
            // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
            static showSuccess(message, duration = 3000) {
                const cleanMessage = MessageCleaner.cleanTechnicalInfo(message);
                this.showNotification(cleanMessage, 'success', duration);
            }

            // ÊòæÁ§∫ÈîôËØØÊèêÁ§∫
            static showError(message, duration = 5000) {
                const cleanMessage = MessageCleaner.cleanTechnicalInfo(message);
                this.showNotification(cleanMessage, 'error', duration);
            }

            // ÊòæÁ§∫‰ø°ÊÅØÊèêÁ§∫
            static showInfo(message, duration = 3000) {
                const cleanMessage = MessageCleaner.cleanTechnicalInfo(message);
                this.showNotification(cleanMessage, 'info', duration);
            }

            // ÊòæÁ§∫Ë≠¶ÂëäÊèêÁ§∫
            static showWarning(message, duration = 4000) {
                const cleanMessage = MessageCleaner.cleanTechnicalInfo(message);
                this.showNotification(cleanMessage, 'warning', duration);
            }

            // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
            static showConfirm(message, onConfirm, onCancel) {
                const cleanMessage = MessageCleaner.cleanTechnicalInfo(message);
                this.showCustomConfirm(cleanMessage, onConfirm, onCancel);
            }

            // Ëá™ÂÆö‰πâÁ°ÆËÆ§ÂØπËØùÊ°Ü
            static showCustomConfirm(message, onConfirm, onCancel) {
                // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    z-index: 10001;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                `;

                // ÂàõÂª∫ÂØπËØùÊ°Ü
                const dialog = document.createElement('div');
                dialog.style.cssText = `
                    background: white;
                    border-radius: 12px;
                    padding: 30px;
                    max-width: 400px;
                    width: 90%;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                    text-align: center;
                `;

                dialog.innerHTML = `
                    <div style="font-size: 18px; color: #333; margin-bottom: 25px; line-height: 1.5;">${message}</div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button id="confirm-btn" style="padding: 12px 24px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600;">Á°ÆÂÆö</button>
                        <button id="cancel-btn" style="padding: 12px 24px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600;">ÂèñÊ∂à</button>
                    </div>
                `;

                overlay.appendChild(dialog);
                document.body.appendChild(overlay);

                // ÁªëÂÆö‰∫ã‰ª∂
                const confirmBtn = dialog.querySelector('#confirm-btn');
                const cancelBtn = dialog.querySelector('#cancel-btn');

                confirmBtn.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                    if (onConfirm) onConfirm();
                });

                cancelBtn.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                    if (onCancel) onCancel();
                });

                // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        document.body.removeChild(overlay);
                        if (onCancel) onCancel();
                    }
                });
            }

            // ÈÄöÁî®ÈÄöÁü•ÊòæÁ§∫ÊñπÊ≥ï
            static showNotification(message, type = 'info', duration = 3000) {
                // ÂàõÂª∫ÈÄöÁü•ÂÆπÂô®ÔºàÂ¶ÇÊûú‰∏çÂ≠òÂú®Ôºâ
                let container = document.getElementById('notification-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'notification-container';
                    container.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        z-index: 10000;
                        pointer-events: none;
                    `;
                    document.body.appendChild(container);
                }

                // ÂàõÂª∫ÈÄöÁü•ÂÖÉÁ¥†
                const notification = document.createElement('div');
                const icons = {
                    success: '‚úÖ',
                    error: '‚ùå',
                    warning: '‚ö†Ô∏è',
                    info: '‚ÑπÔ∏è'
                };

                const colors = {
                    success: '#d4edda',
                    error: '#f8d7da',
                    warning: '#fff3cd',
                    info: '#d1ecf1'
                };

                const borderColors = {
                    success: '#c3e6cb',
                    error: '#f5c6cb',
                    warning: '#ffeaa7',
                    info: '#bee5eb'
                };

                notification.style.cssText = `
                    background: ${colors[type] || colors.info};
                    border: 1px solid ${borderColors[type] || borderColors.info};
                    border-radius: 8px;
                    padding: 12px 16px;
                    margin-bottom: 10px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    display: flex;
                    align-items: center;
                    font-size: 14px;
                    font-weight: 500;
                    color: #333;
                    pointer-events: auto;
                    transform: translateX(100%);
                    transition: transform 0.3s ease-in-out;
                    max-width: 350px;
                    word-wrap: break-word;
                `;

                notification.innerHTML = `
                    <span style="margin-right: 8px; font-size: 16px;">${icons[type] || icons.info}</span>
                    <span>${message}</span>
                `;

                container.appendChild(notification);

                // ÊòæÁ§∫Âä®Áîª
                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                }, 10);

                // Ëá™Âä®ÈöêËóè
                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, duration);

                // ÁÇπÂáªÂÖ≥Èó≠
                notification.addEventListener('click', () => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                });
            }
        }







        // È°µÈù¢ÂàáÊç¢ÂáΩÊï∞ÔºàÂ§áÁî®ÂÆö‰πâÔºåÂ¶ÇÊûúÁ¨¨‰∏Ä‰∏™ÂÆö‰πâÂ§±Ë¥•Ôºâ
        if (typeof showPage === 'undefined') {
            function showPage(pageId) {
                // ÈöêËóèÊâÄÊúâÈ°µÈù¢
                document.querySelectorAll('.content-page').forEach(page => {
                    page.classList.remove('active');
                });

                // ÊòæÁ§∫ÁõÆÊ†áÈ°µÈù¢
                const targetPage = document.getElementById(pageId + '-page');
                if (targetPage) {
                    targetPage.classList.add('active');
                }

                // Êõ¥Êñ∞ËèúÂçïÁä∂ÊÄÅ
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.classList.remove('active');
                });

                // ÊâæÂà∞Ë¢´ÁÇπÂáªÁöÑËèúÂçïÈ°πÂπ∂ËÆæ‰∏∫Ê¥ªË∑ÉÁä∂ÊÄÅ
                const clickedMenuItem = event ? event.target.closest('.menu-item') : null;
                if (clickedMenuItem) {
                    clickedMenuItem.classList.add('active');
                }

                // Êõ¥Êñ∞ÂΩìÂâçÈ°µÈù¢
                currentPage = pageId;

                // Âä†ËΩΩÈ°µÈù¢ÂÜÖÂÆπ
                loadPageContent(pageId);
            }
        }

        // Âä†ËΩΩÈ°µÈù¢ÂÜÖÂÆπ
        function loadPageContent(pageId) {
            const contentContainer = document.getElementById(pageId + '-content');
            if (!contentContainer) return;

            switch (pageId) {
                case 'environment':
                    loadEnvironmentContent(contentContainer);
                    break;
                case 'devices':
                    loadDevicesContent(contentContainer);
                    break;
                case 'alerts':
                    loadAlertsContent(contentContainer);
                    break;
                case 'tasks':
                    loadTasksContent(contentContainer);
                    break;
                case 'analytics':
                    loadAnalyticsContent(contentContainer);
                    break;
                case 'history':
                    loadHistoryContent(contentContainer);
                    break;
                case 'users':
                    loadUsersContent(contentContainer);
                    break;
                default:
                    // ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏çÈúÄË¶ÅÂä†ËΩΩÈ¢ùÂ§ñÂÜÖÂÆπ
                    break;
            }
        }

        // ÈÄÄÂá∫Á≥ªÁªüÂáΩÊï∞
        function logoutSystem() {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁªüÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess('ÈÄÄÂá∫Á≥ªÁªüÊàêÂäü');
                    // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÁöÑÈÄÄÂá∫ÈÄªËæë
                    setTimeout(() => {
                        window.location.href = '/login.html';
                    }, 1500);
                }
            );
        }

        // Âä†ËΩΩÁéØÂ¢ÉÁõëÊéßÂÜÖÂÆπ
        async function loadEnvironmentContent(container) {
            container.innerHTML = `
                <!-- Ê∏©ÂÆ§ÈÄâÊã©Âô® -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üè†</span>Ê∏©ÂÆ§ÈÄâÊã©
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="greenhouse-btn active" onclick="selectGreenhouse(1)" style="padding: 12px 20px; background: #2C3E50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">1Âè∑Ê∏©ÂÆ§ (Ëî¨ËèúÂå∫)</button>
                        <button class="greenhouse-btn" onclick="selectGreenhouse(2)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">2Âè∑Ê∏©ÂÆ§ (Ëä±ÂçâÂå∫)</button>
                        <button class="greenhouse-btn" onclick="selectGreenhouse(3)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">3Âè∑Ê∏©ÂÆ§ (ËÇ≤ËãóÂå∫)</button>
                        <button class="greenhouse-btn" onclick="selectGreenhouse(4)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">4Âè∑Ê∏©ÂÆ§ (ÂÆûÈ™åÂå∫)</button>
                    </div>
                </div>

                <!-- ÁéØÂ¢ÉÂèÇÊï∞ÁõëÊéß -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;" id="environmentGrid">
                    <!-- Âü∫Á°ÄÁéØÂ¢ÉÂèÇÊï∞ -->
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üå°Ô∏è</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">Á©∫Ê∞îÊ∏©Â∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="airTemp">23.5¬∞C</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">Ê≠£Â∏∏ËåÉÂõ¥</div>
                    </div>
                    
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üíß</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">Á©∫Ê∞îÊπøÂ∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="airHumidity">65.8%</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">Ê≠£Â∏∏ËåÉÂõ¥</div>
                    </div>
                    
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚òÄÔ∏è</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">ÂÖâÁÖßÂº∫Â∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="lightIntensity">25000 lux</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">ÂÖÖË∂≥</div>
                    </div>
                    
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üå±</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">ÂúüÂ£§ÊπøÂ∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="soilMoisture">58.2%</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">ÈÄÇÂÆú</div>
                    </div>

                    <!-- Êâ©Â±ïÁéØÂ¢ÉÂèÇÊï∞ -->
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üí®</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">CO2ÊµìÂ∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="co2Level">420 ppm</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">Ê≠£Â∏∏</div>
                    </div>

                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üå°Ô∏è</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">ÂúüÂ£§Ê∏©Â∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="soilTemp">21.8¬∞C</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">ÈÄÇÂÆú</div>
                    </div>

                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üå¨Ô∏è</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">È£éÈÄü</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="windSpeed">0.8 m/s</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">ÂæÆÈ£é</div>
                    </div>

                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üß™</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">ÂúüÂ£§pHÂÄº</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="soilPH">6.8</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">ÈÄÇÂÆú</div>
                    </div>

                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚ö°</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">ÂúüÂ£§ECÂÄº</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="soilEC">1.2 mS/cm</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">Ê≠£Â∏∏</div>
                    </div>

                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üå°Ô∏è</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">Âè∂Èù¢Ê∏©Â∫¶</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="leafTemp">22.3¬∞C</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">Ê≠£Â∏∏</div>
                    </div>

                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">üåä</div>
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #333;">Ëí∏ËÖæÈÄüÁéá</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #2C3E50;" id="transpiration">2.4 mm/h</div>
                        <div style="color: #27AE60; font-size: 14px; font-weight: 600;">Ê≠£Â∏∏</div>
                    </div>
                </div>

                <!-- ÁéØÂ¢ÉË¥®ÈáèÁªºÂêàËØÑ‰º∞ -->
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üìä</span>ÁéØÂ¢ÉË¥®ÈáèËØÑ‰º∞
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <div style="font-size: 24px; font-weight: bold; color: #27AE60; margin-bottom: 5px;">‰ºòÁßÄ</div>
                            <div style="font-size: 14px; color: #666;">ÁªºÂêàÁéØÂ¢ÉËØÑÁ∫ß</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <div style="font-size: 24px; font-weight: bold; color: #3498DB; margin-bottom: 5px;">96.8%</div>
                            <div style="font-size: 14px; color: #666;">ÁéØÂ¢ÉÈÄÇÂÆúÂ∫¶</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <div style="font-size: 24px; font-weight: bold; color: #F39C12; margin-bottom: 5px;">12</div>
                            <div style="font-size: 14px; color: #666;">‰º†ÊÑüÂô®Êï∞Èáè</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <div style="font-size: 24px; font-weight: bold; color: #8E44AD; margin-bottom: 5px;">Ê≠£Â∏∏</div>
                            <div style="font-size: 14px; color: #666;">Á≥ªÁªüÁä∂ÊÄÅ</div>
                        </div>
                    </div>
                </div>
                
                <!-- ÊéßÂà∂Èù¢Êùø -->
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üõ†Ô∏è</span>ÁõëÊéßÊéßÂà∂
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <button style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="refreshEnvironmentData()">üîÑ Âà∑Êñ∞Êï∞ÊçÆ</button>
                        <button style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="exportEnvironmentData()">üì§ ÂØºÂá∫Êï∞ÊçÆ</button>
                        <button style="padding: 12px 20px; background: #F39C12; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="setEnvironmentAlerts()">‚ö†Ô∏è ËÆæÁΩÆÊä•Ë≠¶</button>
                        <button style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="viewEnvironmentTrends()">üìà Êü•ÁúãË∂ãÂäø</button>
                        <button style="padding: 12px 20px; background: #E74C3C; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="calibrateSensors()">üîß ‰º†ÊÑüÂô®Ê†°ÂáÜ</button>
                        <button style="padding: 12px 20px; background: #2C3E50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="generateEnvironmentReport()">üìã ÁîüÊàêÊä•Âëä</button>
                    </div>
                </div>
            `;

            // ÂêØÂä®Êï∞ÊçÆÊõ¥Êñ∞
            setInterval(updateEnvironmentData, 30000);
        }



        // Âä†ËΩΩÊä•Ë≠¶ÁÆ°ÁêÜÂÜÖÂÆπ
        async function loadAlertsContent(container) {
            container.innerHTML = `
                <!-- Ê∏©ÂÆ§ÈÄâÊã©Âô® -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üè†</span>Ê∏©ÂÆ§ÈÄâÊã©
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="alert-greenhouse-btn active" onclick="selectAlertGreenhouse(1)" style="padding: 12px 20px; background: #2C3E50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">1Âè∑Ê∏©ÂÆ§ (Ëî¨ËèúÂå∫)</button>
                        <button class="alert-greenhouse-btn" onclick="selectAlertGreenhouse(2)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">2Âè∑Ê∏©ÂÆ§ (Ëä±ÂçâÂå∫)</button>
                        <button class="alert-greenhouse-btn" onclick="selectAlertGreenhouse(3)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">3Âè∑Ê∏©ÂÆ§ (ËÇ≤ËãóÂå∫)</button>
                        <button class="alert-greenhouse-btn" onclick="selectAlertGreenhouse(4)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">4Âè∑Ê∏©ÂÆ§ (ÂÆûÈ™åÂå∫)</button>
                    </div>
                </div>

                <!-- Êä•Ë≠¶ÁªüËÆ°Âç°Áâá -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;" id="alertStatsGrid">
                    <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: 10px;">üö®</div>
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px; color: #E74C3C;" id="criticalAlerts">2</div>
                        <div style="color: #666; font-size: 14px;">‰∏•ÈáçÊä•Ë≠¶</div>
                    </div>
                    <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: 10px;">‚ö†Ô∏è</div>
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px; color: #F39C12;" id="warningAlerts">5</div>
                        <div style="color: #666; font-size: 14px;">Ë≠¶ÂëäÊä•Ë≠¶</div>
                    </div>
                    <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: 10px;">‚ÑπÔ∏è</div>
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px; color: #3498DB;" id="infoAlerts">3</div>
                        <div style="color: #666; font-size: 14px;">‰ø°ÊÅØÊä•Ë≠¶</div>
                    </div>
                    <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: 10px;">‚úÖ</div>
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px; color: #27AE60;" id="resolvedAlerts">12</div>
                        <div style="color: #666; font-size: 14px;">Â∑≤Â§ÑÁêÜ</div>
                    </div>
                </div>

                <!-- Êä•Ë≠¶Á≠õÈÄâÂ∑•ÂÖ∑Ê†è -->
                <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="margin: 0; color: #333; display: flex; align-items: center; font-size: 16px;">
                            <span style="margin-right: 10px;">üîç</span>Êä•Ë≠¶Á≠õÈÄâ
                        </h4>
                        <button style="padding: 6px 12px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="refreshAlerts()">üîÑ Âà∑Êñ∞</button>
                    </div>
                    
                    <!-- Á≠õÈÄâÊù°‰ª∂ -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
                        <div>
                            <label style="display: block; margin-bottom: 4px; font-size: 11px; color: #666; font-weight: 600;">Êä•Ë≠¶‰∏•ÈáçÁ®ãÂ∫¶</label>
                            <select id="alertTypeFilter" onchange="applyAlertFilters()" style="width: 100%; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                <option value="">ÂÖ®ÈÉ®</option>
                                <option value="‰∏•Èáç">‰∏•Èáç</option>
                                <option value="Ë≠¶Âëä">Ë≠¶Âëä</option>
                                <option value="‰ø°ÊÅØ">‰ø°ÊÅØ</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 4px; font-size: 11px; color: #666; font-weight: 600;">Â§ÑÁêÜÁä∂ÊÄÅ</label>
                            <select id="alertStatusFilter" onchange="applyAlertFilters()" style="width: 100%; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                <option value="">ÂÖ®ÈÉ®Áä∂ÊÄÅ</option>
                                <option value="Êú™Â§ÑÁêÜ">Êú™Â§ÑÁêÜ</option>
                                <option value="Â§ÑÁêÜ‰∏≠">Â§ÑÁêÜ‰∏≠</option>
                                <option value="Â∑≤Â§ÑÁêÜ">Â∑≤Â§ÑÁêÜ</option>
                                <option value="Â∑≤ÂøΩÁï•">Â∑≤ÂøΩÁï•</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 4px; font-size: 11px; color: #666; font-weight: 600;">Êó•ÊúüÁ≠õÈÄâ</label>
                            <input type="date" id="alertDateFilter" onchange="applyAlertFilters()" style="width: 100%; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 4px; font-size: 11px; color: #666; font-weight: 600;">ÂÖ≥ÈîÆËØçÊêúÁ¥¢</label>
                            <input type="text" id="alertKeywordFilter" placeholder="ÊêúÁ¥¢ÂÖ≥ÈîÆËØç..." oninput="applyAlertFilters()" style="width: 100%; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                        </div>
                        <div style="display: flex; align-items: end;">
                            <button onclick="clearAlertFilters()" style="width: 100%; padding: 6px 10px; background: #95A5A6; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 11px;">Ê∏ÖÈô§Á≠õÈÄâ</button>
                        </div>
                    </div>
                </div>

                <!-- Êä•Ë≠¶ÂàóË°® -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <!-- Êä•Ë≠¶ÂàóË°®Ê†áÈ¢òÂíåÂÜÖÂÆπ -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üö®</span>Êä•Ë≠¶ÂàóË°®
                            <span style="margin-left: 10px; font-size: 14px; color: #666; font-weight: normal;" id="alertCountDisplay">ÂÖ± 0 Êù°Êä•Ë≠¶</span>
                        </h3>
                    </div>
                    <div id="alertsList">
                        ${generateAlertItems(currentAlertGreenhouse)}
                    </div>
                </div>
            `;
        }

        // Âä†ËΩΩÂÆöÊó∂‰ªªÂä°ÂÜÖÂÆπ
        async function loadTasksContent(container) {
            container.innerHTML = `
                <div style="background: #2C3E50; border-radius: 12px; padding: 20px; margin-bottom: 30px; color: white;">
                    <h3 style="margin-bottom: 15px; font-size: 1.3rem;">üöÄ Á≥ªÁªüËá™Âä®ÂåñÁâπÊÄß</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div style="display: flex; align-items: center; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; font-size: 14px;">‚úì ÊØè30ÁßíËá™Âä®ÁîüÊàêÁéØÂ¢ÉÊï∞ÊçÆ</div>
                        <div style="display: flex; align-items: center; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; font-size: 14px;">‚úì ÊØè1ÂàÜÈíüÊõ¥Êñ∞ËÆæÂ§áÁä∂ÊÄÅ</div>
                        <div style="display: flex; align-items: center; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; font-size: 14px;">‚úì ÊØè2ÂàÜÈíüÊâßË°åËá™Âä®ÂåñÊéßÂà∂</div>
                        <div style="display: flex; align-items: center; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; font-size: 14px;">‚úì ÊØè1ÂàÜÈíüÊ£ÄÊµãÁéØÂ¢ÉÊä•Ë≠¶</div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 10px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px;">‰ªªÂä°ÊéßÂà∂‰∏≠ÂøÉ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <button style="padding: 15px 25px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="startAllTasks()">üöÄ ÂêØÂä®ÊâÄÊúâ‰ªªÂä°</button>
                        <button style="padding: 15px 25px; background: #E74C3C; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="stopAllTasks()">üõë ÂÅúÊ≠¢ÊâÄÊúâ‰ªªÂä°</button>
                        <button style="padding: 15px 25px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="refreshTaskStatus()">üîÑ Âà∑Êñ∞Áä∂ÊÄÅ</button>
                        <button style="padding: 15px 25px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="triggerAllTasks()">‚ö° ÊâãÂä®Ëß¶ÂèëÊâÄÊúâ‰ªªÂä°</button>
                    </div>
                    
                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 15px; padding: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
                        <div style="display: flex; align-items: center; font-size: 1.1rem; font-weight: 500;">
                            <span style="width: 12px; height: 12px; border-radius: 50%; margin-right: 10px; background: #56ab2f; box-shadow: 0 0 10px rgba(86, 171, 47, 0.5); animation: pulse 2s infinite;" id="taskStatusDot"></span>
                            <span>Á≥ªÁªüÁä∂ÊÄÅÔºö<strong id="taskStatusText">ËøêË°å‰∏≠</strong></span>
                        </div>
                    </div>
                </div>

                <!-- ‰ªªÂä°ÂàóË°® -->
                <div style="background: white; border-radius: 10px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px;">ÂΩìÂâç‰ªªÂä°ÂàóË°®</h3>
                    <div style="background: rgba(248, 249, 250, 0.8); border-radius: 15px; overflow: hidden; border: 1px solid rgba(0, 0, 0, 0.1);">
                        <div style="display: grid; grid-template-columns: 2fr 1fr 1.5fr 1.5fr 1.5fr 1fr 1.5fr; background: linear-gradient(135deg, #2C3E50 0%, #34495E 100%); color: white; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;">
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">‰ªªÂä°ÂêçÁß∞</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">Áä∂ÊÄÅ</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">ÊâßË°åÈ¢ëÁéá</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">‰∏äÊ¨°ÊâßË°å</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">‰∏ãÊ¨°ÊâßË°å</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">ÊâßË°åÊ¨°Êï∞</div>
                            <div style="padding: 15px 12px; text-align: center;">Êìç‰Ωú</div>
                        </div>
                        <div style="max-height: 400px; overflow-y: auto;">
                            ${generateTaskListHTML()}
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin: 30px 0;">
                    <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: #2C3E50;"></div>
                        <div style="font-size: 14px; color: #666; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; font-weight: 600;">ÁéØÂ¢ÉÊï∞ÊçÆÁîüÊàê</div>
                        <div style="font-size: 2.5rem; font-weight: 700; color: #333; margin-bottom: 10px;" id="envTaskCount">156</div>
                        <div style="font-size: 12px; color: #888; font-weight: 500;">Ê¨°ÊâßË°å</div>
                    </div>
                    
                    <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: #34495E;"></div>
                        <div style="font-size: 14px; color: #666; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; font-weight: 600;">ËÆæÂ§áÁä∂ÊÄÅÊõ¥Êñ∞</div>
                        <div style="font-size: 2.5rem; font-weight: 700; color: #333; margin-bottom: 10px;" id="deviceTaskCount">89</div>
                        <div style="font-size: 12px; color: #888; font-weight: 500;">Ê¨°ÊâßË°å</div>
                    </div>
                    
                    <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: #5D6D7E;"></div>
                        <div style="font-size: 14px; color: #666; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; font-weight: 600;">Êä•Ë≠¶Ê£ÄÊµã</div>
                        <div style="font-size: 2.5rem; font-weight: 700; color: #333; margin-bottom: 10px;" id="alertTaskCount">67</div>
                        <div style="font-size: 12px; color: #888; font-weight: 500;">Ê¨°ÊâßË°å</div>
                    </div>
                </div>
            `;
        }

        // Âä†ËΩΩÊï∞ÊçÆÂàÜÊûêÂÜÖÂÆπ
        async function loadAnalyticsContent(container) {
            container.innerHTML = `
                <!-- Êï∞ÊçÆÊ¶ÇËßàÂç°Áâá -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: #2C3E50; border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(44, 62, 80, 0.15);">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <span style="font-size: 32px; margin-right: 15px;">üìä</span>
                            <div>
                                <h4 style="margin: 0; font-size: 16px; opacity: 0.9;">ÊÄªÊï∞ÊçÆÁÇπ</h4>
                                <div style="font-size: 28px; font-weight: bold; margin-top: 5px;">12,847</div>
                            </div>
                        </div>
                        <div style="font-size: 14px; opacity: 0.8;">ËæÉÊò®Êó•Â¢ûÈïø +8.5%</div>
                    </div>
                    
                    <div style="background: #34495E; border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(52, 73, 94, 0.15);">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <span style="font-size: 32px; margin-right: 15px;">üìà</span>
                            <div>
                                <h4 style="margin: 0; font-size: 16px; opacity: 0.9;">Âπ≥ÂùáÊ∏©Â∫¶</h4>
                                <div style="font-size: 28px; font-weight: bold; margin-top: 5px;">24.3¬∞C</div>
                            </div>
                        </div>
                        <div style="font-size: 14px; opacity: 0.8;">Ë∂ãÂäøÔºöÁ®≥ÂÆö‰∏äÂçá</div>
                    </div>
                    
                    <div style="background: #5D6D7E; border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(93, 109, 126, 0.15);">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <span style="font-size: 32px; margin-right: 15px;">üíß</span>
                            <div>
                                <h4 style="margin: 0; font-size: 16px; opacity: 0.9;">Âπ≥ÂùáÊπøÂ∫¶</h4>
                                <div style="font-size: 28px; font-weight: bold; margin-top: 5px;">67.8%</div>
                            </div>
                        </div>
                        <div style="font-size: 14px; opacity: 0.8;">Ë∂ãÂäøÔºöËΩªÂæÆ‰∏ãÈôç</div>
                    </div>
                    
                    <div style="background: #566573; border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(86, 101, 115, 0.15);">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <span style="font-size: 32px; margin-right: 15px;">‚ö°</span>
                            <div>
                                <h4 style="margin: 0; font-size: 16px; opacity: 0.9;">Á≥ªÁªüÊïàÁéá</h4>
                                <div style="font-size: 28px; font-weight: bold; margin-top: 5px;">96.7%</div>
                            </div>
                        </div>
                        <div style="font-size: 14px; opacity: 0.8;">ËøêË°åÁä∂ÊÄÅÔºö‰ºòÁßÄ</div>
                    </div>
                </div>

                <!-- ËØ¶ÁªÜÊï∞ÊçÆÂàÜÊûê -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìä</span>ÁéØÂ¢ÉÊï∞ÊçÆË∂ãÂäøÂàÜÊûê
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #4CAF50;">
                                <div style="font-size: 14px; color: #666; margin-bottom: 5px;">Ê∏©Â∫¶ÂèòÂåñÁéá</div>
                                <div style="font-size: 20px; font-weight: bold; color: #4CAF50;">+2.3%</div>
                                <div style="font-size: 12px; color: #999;">ËøáÂéª7Â§©</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #2196F3;">
                                <div style="font-size: 14px; color: #666; margin-bottom: 5px;">ÊπøÂ∫¶Á®≥ÂÆöÊÄß</div>
                                <div style="font-size: 20px; font-weight: bold; color: #2196F3;">98.5%</div>
                                <div style="font-size: 12px; color: #999;">Á®≥ÂÆöÂ∫¶ÊåáÊ†á</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #FF9800;">
                                <div style="font-size: 14px; color: #666; margin-bottom: 5px;">ÂÖâÁÖßÂà©Áî®Áéá</div>
                                <div style="font-size: 20px; font-weight: bold; color: #FF9800;">87.2%</div>
                                <div style="font-size: 12px; color: #999;">Êó•ÂùáÂà©Áî®Áéá</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #9C27B0;">
                                <div style="font-size: 14px; color: #666; margin-bottom: 5px;">ÂúüÂ£§ÂÅ•Â∫∑Â∫¶</div>
                                <div style="font-size: 20px; font-weight: bold; color: #9C27B0;">‰ºòÁßÄ</div>
                                <div style="font-size: 12px; color: #999;">ÁªºÂêàËØÑ‰º∞</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üéØ</span>ÂÖ≥ÈîÆÊåáÊ†á
                        </h3>
                        <div style="space-y: 15px;">
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: #666;">ËÉΩËÄóÊïàÁéá</span>
                                    <span style="font-size: 14px; font-weight: bold; color: #4CAF50;">92%</span>
                                </div>
                                <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px;">
                                    <div style="width: 92%; height: 100%; background: #27AE60; border-radius: 4px;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: #666;">ËÆæÂ§áËøêË°åÁéá</span>
                                    <span style="font-size: 14px; font-weight: bold; color: #3498DB;">96%</span>
                                </div>
                                <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px;">
                                    <div style="width: 96%; height: 100%; background: #3498DB; border-radius: 4px;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-size: 14px; color: #666;">Êï∞ÊçÆÂáÜÁ°ÆÊÄß</span>
                                    <span style="font-size: 14px; font-weight: bold; color: #F39C12;">99%</span>
                                </div>
                                <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px;">
                                    <div style="width: 99%; height: 100%; background: #F39C12; border-radius: 4px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Êä•Ë°®‰∏≠ÂøÉ -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 25px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üìã</span>Êä•Ë°®‰∏≠ÂøÉ
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 25px;">
                        <div style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 20px; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#4CAF50'; this.style.boxShadow='0 4px 15px rgba(76, 175, 80, 0.2)'" onmouseout="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none'">
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <span style="font-size: 24px; margin-right: 12px;">üìä</span>
                                <div>
                                    <h4 style="margin: 0; color: #333;">ÁéØÂ¢ÉÊï∞ÊçÆÊó•Êä•</h4>
                                    <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">ÊØèÊó•ÁéØÂ¢ÉÂèÇÊï∞ÁªüËÆ°ÂàÜÊûê</p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button style="flex: 1; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="generateDailyReport()">ÁîüÊàêÊä•Ë°®</button>
                                <button style="flex: 1; padding: 8px 16px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="exportDailyReport()">ÂØºÂá∫Êä•Ë°®</button>
                            </div>
                        </div>
                        
                        <div style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 20px; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#2196F3'; this.style.boxShadow='0 4px 15px rgba(33, 150, 243, 0.2)'" onmouseout="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none'">
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <span style="font-size: 24px; margin-right: 12px;">‚öôÔ∏è</span>
                                <div>
                                    <h4 style="margin: 0; color: #333;">ËÆæÂ§áËøêË°åÊä•Âëä</h4>
                                    <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">ËÆæÂ§áÁä∂ÊÄÅÂíåËøêË°åÊïàÁéáÂàÜÊûê</p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button style="flex: 1; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="generateDeviceReport()">ÁîüÊàêÊä•Ë°®</button>
                                <button style="flex: 1; padding: 8px 16px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="exportDeviceReport()">ÂØºÂá∫Êä•Ë°®</button>
                            </div>
                        </div>
                        
                        <div style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 20px; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#FF9800'; this.style.boxShadow='0 4px 15px rgba(255, 152, 0, 0.2)'" onmouseout="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none'">
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <span style="font-size: 24px; margin-right: 12px;">üìà</span>
                                <div>
                                    <h4 style="margin: 0; color: #333;">ÊúàÂ∫¶ÂàÜÊûêÊä•Âëä</h4>
                                    <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">ÊúàÂ∫¶Êï∞ÊçÆË∂ãÂäøÂíåÂØπÊØîÂàÜÊûê</p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button style="flex: 1; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="generateMonthlyReport()">ÁîüÊàêÊä•Ë°®</button>
                                <button style="flex: 1; padding: 8px 16px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="exportMonthlyReport()">ÂØºÂá∫Êä•Ë°®</button>
                            </div>
                        </div>
                        
                        <div style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 20px; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#9C27B0'; this.style.boxShadow='0 4px 15px rgba(156, 39, 176, 0.2)'" onmouseout="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none'">
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <span style="font-size: 24px; margin-right: 12px;">üö®</span>
                                <div>
                                    <h4 style="margin: 0; color: #333;">Êä•Ë≠¶ÁªüËÆ°Êä•Âëä</h4>
                                    <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">Á≥ªÁªüÊä•Ë≠¶ËÆ∞ÂΩïÂíåÂ§ÑÁêÜÁªüËÆ°</p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button style="flex: 1; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="generateAlertReport()">ÁîüÊàêÊä•Ë°®</button>
                                <button style="flex: 1; padding: 8px 16px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" onclick="exportAlertReport()">ÂØºÂá∫Êä•Ë°®</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Âø´ÈÄüÊìç‰ΩúÂ∑•ÂÖ∑Ê†è -->
                <div style="background: #34495E; border-radius: 15px; padding: 25px; color: white;">
                    <h3 style="margin-bottom: 20px; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üõ†Ô∏è</span>Âø´ÈÄüÊìç‰Ωú
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button style="padding: 15px 20px; background: rgba(255, 255, 255, 0.2); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'" onclick="generateComprehensiveReport()">üìä ÁîüÊàêÁªºÂêàÊä•Âëä</button>
                        <button style="padding: 15px 20px; background: rgba(255, 255, 255, 0.2); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'" onclick="exportAllData()">üíæ ÂØºÂá∫ÂÖ®ÈÉ®Êï∞ÊçÆ</button>
                        <button style="padding: 15px 20px; background: rgba(255, 255, 255, 0.2); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'" onclick="refreshAllAnalytics()">üîÑ Âà∑Êñ∞ÂÖ®ÈÉ®Êï∞ÊçÆ</button>
                        <button style="padding: 15px 20px; background: rgba(255, 255, 255, 0.2); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'" onclick="scheduleReport()">‚è∞ ÂÆöÊó∂Êä•ÂëäËÆæÁΩÆ</button>
                    </div>
                </div>
            `;
        }

        // Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩïÂÜÖÂÆπ
        async function loadHistoryContent(container) {
            container.innerHTML = `
                <!-- Ê∏©ÂÆ§ÈÄâÊã©Âô® -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üè†</span>Ê∏©ÂÆ§ÈÄâÊã©
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="history-greenhouse-btn active" onclick="selectHistoryGreenhouse(1)" style="padding: 12px 20px; background: #2C3E50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">1Âè∑Ê∏©ÂÆ§ (Ëî¨ËèúÂå∫)</button>
                        <button class="history-greenhouse-btn" onclick="selectHistoryGreenhouse(2)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">2Âè∑Ê∏©ÂÆ§ (Ëä±ÂçâÂå∫)</button>
                        <button class="history-greenhouse-btn" onclick="selectHistoryGreenhouse(3)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">3Âè∑Ê∏©ÂÆ§ (ËÇ≤ËãóÂå∫)</button>
                        <button class="history-greenhouse-btn" onclick="selectHistoryGreenhouse(4)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">4Âè∑Ê∏©ÂÆ§ (ÂÆûÈ™åÂå∫)</button>
                    </div>
                </div>

                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üîç</span>Á≠õÈÄâÊù°‰ª∂
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <select style="padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                            <option>ÈÄâÊã©Êï∞ÊçÆÁ±ªÂûã</option>
                            <option>ÁéØÂ¢ÉÊï∞ÊçÆ</option>
                            <option>ËÆæÂ§áÊìç‰Ωú</option>
                            <option>Êä•Ë≠¶ËÆ∞ÂΩï</option>
                            <option>Áî®Êà∑Êìç‰Ωú</option>
                            <option>Á≥ªÁªü‰∫ã‰ª∂</option>
                        </select>
                        <input type="date" style="padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                        <input type="date" style="padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                        <button style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="searchHistory()">üîç ÊêúÁ¥¢ËÆ∞ÂΩï</button>
                        <button style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="exportHistory()">üì§ ÂØºÂá∫ËÆ∞ÂΩï</button>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 10px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px;">ÂéÜÂè≤ËÆ∞ÂΩï</h3>
                    <div id="historyList">
                        ${generateHistoryItems()}
                    </div>
                </div>
            `;
        }

        // Âä†ËΩΩÁî®Êà∑ÁÆ°ÁêÜÂÜÖÂÆπ
        async function loadUsersContent(container) {
            container.innerHTML = `
                <!-- Áî®Êà∑ÁÆ°ÁêÜÊìç‰ΩúÊ†è -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üõ†Ô∏è</span>Áî®Êà∑Êìç‰Ωú
                        </h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button style="padding: 12px 20px; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="batchManageUsers()">üìã ÊâπÈáèÂà†Èô§</button>
                        <button style="padding: 12px 20px; background: #FF9800; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="exportUserList()">üì§ ÂØºÂá∫Áî®Êà∑ÂàóË°®</button>
                        <button style="padding: 12px 20px; background: #607D8B; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="refreshUserList()">üîÑ Âà∑Êñ∞ÂàóË°®</button>
                    </div>
                </div>

                <!-- Áî®Êà∑ÂàóË°® -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üìã</span>Áî®Êà∑ÂàóË°®
                    </h3>
                    
                    <!-- ÊêúÁ¥¢Ê†è -->
                    <div style="margin-bottom: 20px; display: flex; gap: 15px; align-items: center;">
                        <input type="text" placeholder="ÊêúÁ¥¢Áî®Êà∑ÂêçÊàñÈÇÆÁÆ±..." style="flex: 1; padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;" id="userSearchInput">
                        <select style="padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                            <option value="">ÂÖ®ÈÉ®ËßíËâ≤</option>
                            <option value="admin">ÁÆ°ÁêÜÂëò</option>
                            <option value="user">ÊôÆÈÄöÁî®Êà∑</option>
                        </select>
                        <button style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer;" onclick="searchUsers()">ÊêúÁ¥¢</button>
                    </div>
                    
                    <!-- Áî®Êà∑Ë°®Ê†º -->
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                            <thead>
                                <tr style="background: #f8f9fa; border-bottom: 2px solid #e0e0e0;">
                                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #333;">
                                        <input type="checkbox" onclick="toggleAllUsers(this)" style="margin-right: 8px;">
                                        Áî®Êà∑‰ø°ÊÅØ
                                    </th>
                                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #333;">ËßíËâ≤</th>
                                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #333;">Áä∂ÊÄÅ</th>
                                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #333;">ÊúÄÂêéÁôªÂΩï</th>
                                    <th style="padding: 15px; text-align: center; font-weight: 600; color: #333;">Êìç‰Ωú</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody">
                                ${generateUserTableRows()}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // ËÆæÂ§áÊï∞ÊçÆÂ≠òÂÇ®
        const devicesByGreenhouse = {
            1: [
                {
                    name: 'Âä†ÁÉ≠Âô®A1', icon: 'üî•', status: 'ËøêË°å‰∏≠', color: '#27AE60',
                    runningHours: 720, usageFrequency: 85, lastMaintenance: '2024-07-15',
                    nextMaintenance: '2024-08-15', maintenanceStatus: 'ÈúÄË¶ÅÁª¥Êä§',
                    maintenanceRecords: [
                        { date: '2024-07-15', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂä†ÁÉ≠ÂÖÉ‰ª∂ÔºåÊ£ÄÊü•ÁîµË∑ØËøûÊé•', technician: 'Âº†Â∏àÂÇÖ' },
                        { date: '2024-06-10', type: 'ÊïÖÈöúÁª¥‰øÆ', description: 'Êõ¥Êç¢Ê∏©Â∫¶‰º†ÊÑüÂô®', technician: 'ÊùéÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'ÂÜ∑Âç¥Âô®A1', icon: '‚ùÑÔ∏è', status: 'ÂæÖÊú∫', color: '#3498DB',
                    runningHours: 450, usageFrequency: 60, lastMaintenance: '2024-08-01',
                    nextMaintenance: '2024-09-01', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-08-01', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂÜ∑ÂáùÂô®ÔºåÊ£ÄÊü•Âà∂ÂÜ∑ÂâÇ', technician: 'ÁéãÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'Âä†ÊπøÂô®A1', icon: 'üí®', status: 'ËøêË°å‰∏≠', color: '#5DADE2',
                    runningHours: 320, usageFrequency: 70, lastMaintenance: '2024-07-20',
                    nextMaintenance: '2024-08-20', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-07-20', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÊ∞¥ÁÆ±ÔºåÊõ¥Êç¢Êª§ËäØ', technician: 'ÈôàÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'È£éÊâáA1', icon: 'üå™Ô∏è', status: 'ËøêË°å‰∏≠', color: '#58D68D',
                    runningHours: 890, usageFrequency: 95, lastMaintenance: '2024-06-30',
                    nextMaintenance: '2024-08-14', maintenanceStatus: 'Âç≥Â∞ÜÂà∞Êúü',
                    maintenanceRecords: [
                        { date: '2024-06-30', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂè∂ÁâáÔºåÊ∂¶ÊªëËΩ¥Êâø', technician: 'ÂàòÂ∏àÂÇÖ' },
                        { date: '2024-05-15', type: 'ÊïÖÈöúÁª¥‰øÆ', description: 'Êõ¥Êç¢ÁîµÊú∫ËΩ¥Êâø', technician: 'Âº†Â∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'Ë°•ÂÖâÁÅØA1', icon: 'üí°', status: 'ÂÖ≥Èó≠', color: '#F7DC6F',
                    runningHours: 1200, usageFrequency: 80, lastMaintenance: '2024-05-10',
                    nextMaintenance: '2024-08-10', maintenanceStatus: 'Â∑≤ËøáÊúü',
                    maintenanceRecords: [
                        { date: '2024-05-10', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÁÅØÂÖ∑ÔºåÊ£ÄÊü•LEDÊ®°Âùó', technician: 'ËµµÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'Ê∞¥Ê≥µA1', icon: 'üö∞', status: 'ËøêË°å‰∏≠', color: '#85C1E9',
                    runningHours: 650, usageFrequency: 75, lastMaintenance: '2024-07-25',
                    nextMaintenance: '2024-08-25', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-07-25', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê£ÄÊü•Ê∞¥Ê≥µÂØÜÂ∞ÅÔºåÊ∏ÖÊ¥ÅËøáÊª§Âô®', technician: 'Â≠ôÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'ÈÄöÈ£éÁ≥ªÁªüA1', icon: 'üå¨Ô∏è', status: 'ËøêË°å‰∏≠', color: '#A9DFBF',
                    runningHours: 780, usageFrequency: 88, lastMaintenance: '2024-07-05',
                    nextMaintenance: '2024-08-16', maintenanceStatus: 'Âç≥Â∞ÜÂà∞Êúü',
                    maintenanceRecords: [
                        { date: '2024-07-05', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÈÄöÈ£éÁÆ°ÈÅìÔºåÊ£ÄÊü•È£éÈó®', technician: 'È©¨Â∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'CO2ÂèëÁîüÂô®A1', icon: 'üí®', status: 'ÂæÖÊú∫', color: '#D7DBDD',
                    runningHours: 280, usageFrequency: 45, lastMaintenance: '2024-08-05',
                    nextMaintenance: '2024-09-05', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-08-05', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê£ÄÊü•CO2ÊµìÂ∫¶‰º†ÊÑüÂô®ÔºåÊ∏ÖÊ¥ÅÂèëÁîüÂô®', technician: 'Âë®Â∏àÂÇÖ' }
                    ]
                }
            ],
            2: [
                {
                    name: 'Âä†ÁÉ≠Âô®B1', icon: 'üî•', status: 'ÂæÖÊú∫', color: '#95A5A6',
                    runningHours: 380, usageFrequency: 55, lastMaintenance: '2024-08-01',
                    nextMaintenance: '2024-09-01', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-08-01', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂä†ÁÉ≠ÂÖÉ‰ª∂ÔºåÊ£ÄÊü•ÁîµË∑Ø', technician: 'Âº†Â∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'ÂÜ∑Âç¥Âô®B1', icon: '‚ùÑÔ∏è', status: 'ËøêË°å‰∏≠', color: '#3498DB',
                    runningHours: 520, usageFrequency: 70, lastMaintenance: '2024-07-28',
                    nextMaintenance: '2024-08-28', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-07-28', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂÜ∑ÂáùÂô®ÔºåÊ£ÄÊü•Âà∂ÂÜ∑ÂâÇ', technician: 'ÁéãÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'Âä†ÊπøÂô®B1', icon: 'üí®', status: 'ËøêË°å‰∏≠', color: '#5DADE2',
                    runningHours: 420, usageFrequency: 65, lastMaintenance: '2024-07-15',
                    nextMaintenance: '2024-08-15', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-07-15', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÊ∞¥ÁÆ±ÔºåÊõ¥Êç¢Êª§ËäØ', technician: 'ÈôàÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'È£éÊâáB1', icon: 'üå™Ô∏è', status: 'ËøêË°å‰∏≠', color: '#58D68D',
                    runningHours: 680, usageFrequency: 80, lastMaintenance: '2024-07-10',
                    nextMaintenance: '2024-08-18', maintenanceStatus: 'Âç≥Â∞ÜÂà∞Êúü',
                    maintenanceRecords: [
                        { date: '2024-07-10', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂè∂ÁâáÔºåÊ∂¶ÊªëËΩ¥Êâø', technician: 'ÂàòÂ∏àÂÇÖ' }
                    ]
                }
            ],
            3: [
                {
                    name: 'Âä†ÁÉ≠Âô®C1', icon: 'üî•', status: 'ËøêË°å‰∏≠', color: '#E74C3C',
                    runningHours: 290, usageFrequency: 50, lastMaintenance: '2024-08-05',
                    nextMaintenance: '2024-09-05', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-08-05', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂä†ÁÉ≠ÂÖÉ‰ª∂', technician: 'Âº†Â∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'ËÇ≤ËãóÁÅØC1', icon: 'üí°', status: 'ËøêË°å‰∏≠', color: '#F7DC6F',
                    runningHours: 850, usageFrequency: 90, lastMaintenance: '2024-06-20',
                    nextMaintenance: '2024-08-12', maintenanceStatus: 'Â∑≤ËøáÊúü',
                    maintenanceRecords: [
                        { date: '2024-06-20', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÁÅØÂÖ∑ÔºåÊ£ÄÊü•LEDÊ®°Âùó', technician: 'ËµµÂ∏àÂÇÖ' }
                    ]
                },
                {
                    name: 'Êª¥ÁÅåÁ≥ªÁªüC1', icon: 'üíß', status: 'ËøêË°å‰∏≠', color: '#85C1E9',
                    runningHours: 340, usageFrequency: 60, lastMaintenance: '2024-07-30',
                    nextMaintenance: '2024-08-30', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-07-30', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÊª¥Â§¥ÔºåÊ£ÄÊü•ÁÆ°Ë∑Ø', technician: 'Â≠ôÂ∏àÂÇÖ' }
                    ]
                }
            ],
            4: [
                {
                    name: 'Á≤æÂØÜÂä†ÁÉ≠Âô®D1', icon: 'üî•', status: 'ËøêË°å‰∏≠', color: '#E74C3C',
                    runningHours: 450, usageFrequency: 75, lastMaintenance: '2024-07-25',
                    nextMaintenance: '2024-08-25', maintenanceStatus: 'Ê≠£Â∏∏',
                    maintenanceRecords: [
                        { date: '2024-07-25', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Á≤æÂØÜÊ†°ÂáÜÔºåÊ∏ÖÊ¥Å‰º†ÊÑüÂô®', technician: '‰∏ì‰∏öÊäÄÂ∏à' }
                    ]
                },
                {
                    name: 'Êï∞ÊçÆÈááÈõÜÂô®D1', icon: 'üìä', status: 'ËøêË°å‰∏≠', color: '#BB8FCE',
                    runningHours: 2100, usageFrequency: 100, lastMaintenance: '2024-05-01',
                    nextMaintenance: '2024-08-01', maintenanceStatus: 'Â∑≤ËøáÊúü',
                    maintenanceRecords: [
                        { date: '2024-05-01', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê†°ÂáÜ‰º†ÊÑüÂô®ÔºåÊõ¥Êñ∞Âõ∫‰ª∂', technician: 'ÊäÄÊúØ‰∏ìÂÆ∂' }
                    ]
                }
            ]
        };

        // ÁîüÊàêËÆæÂ§áÂç°Áâá
        function generateDeviceCards(greenhouseId = 1) {
            const devices = devicesByGreenhouse[greenhouseId] || devicesByGreenhouse[1];

            return devices.map(device => {
                const maintenanceColor = getMaintenanceStatusColor(device.maintenanceStatus);
                const maintenanceIcon = getMaintenanceStatusIcon(device.maintenanceStatus);

                return `
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: all 0.3s; cursor: pointer; position: relative;" 
                     onmouseover="this.style.boxShadow='0 6px 20px rgba(0,0,0,0.15)'; this.style.transform='translateY(-2px)'" 
                     onmouseout="this.style.boxShadow='0 4px 15px rgba(0,0,0,0.1)'; this.style.transform='translateY(0)'"
                     onclick="showDeviceControlModal('${device.name}', '${device.icon}', '${device.status}', '${device.color}', ${JSON.stringify(device).replace(/"/g, '&quot;')})">
                    
                    <!-- Áª¥Êä§Áä∂ÊÄÅÊåáÁ§∫Âô® -->
                    <div style="position: absolute; top: 10px; right: 10px; background: ${maintenanceColor}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; display: flex; align-items: center; gap: 4px;">
                        ${maintenanceIcon} ${device.maintenanceStatus}
                    </div>
                    
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 32px; margin-right: 15px;">${device.icon}</div>
                        <div style="flex: 1;">
                            <div style="font-size: 18px; font-weight: bold; color: #333;">${device.name}</div>
                            <div style="color: ${device.color}; font-size: 14px; font-weight: 600; margin-bottom: 5px;">${device.status}</div>
                            <div style="font-size: 12px; color: #666;">
                                ËøêË°åÊó∂Èó¥: ${device.runningHours}h | ‰ΩøÁî®Áéá: ${device.usageFrequency}%
                            </div>
                            <div style="font-size: 12px; color: #666;">
                                ‰∏ãÊ¨°Áª¥Êä§: ${device.nextMaintenance}
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button style="flex: 1; padding: 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="event.stopPropagation(); startDevice('${device.name}')">ÂêØÂä®</button>
                        <button style="flex: 1; padding: 8px; background: #E74C3C; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="event.stopPropagation(); stopDevice('${device.name}')">ÂÅúÊ≠¢</button>
                        <button style="flex: 1; padding: 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="event.stopPropagation(); showMaintenanceModal('${device.name}')">Áª¥Êä§</button>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Êä•Ë≠¶Êï∞ÊçÆÂ≠òÂÇ® - ÊåâÊ∏©ÂÆ§ÂàÜÁªÑ
        const alertsData = {
            1: [
                { id: 1, type: '‰∏•Èáç', message: 'Ê∏©Â∫¶ËøáÈ´òÔºöÂΩìÂâçÊ∏©Â∫¶35¬∞CÔºåË∂ÖÂá∫ÂÆâÂÖ®ËåÉÂõ¥ÔºåÂèØËÉΩÂΩ±Âìç‰ΩúÁâ©ÁîüÈïø', time: '2ÂàÜÈíüÂâç', color: '#E74C3C', status: 'Êú™Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 1 },
                { id: 2, type: 'Ë≠¶Âëä', message: 'ÊπøÂ∫¶ÂÅè‰ΩéÔºöÂΩìÂâçÊπøÂ∫¶45%ÔºåÂª∫ËÆÆÂêØÂä®Âä†ÊπøËÆæÂ§á', time: '5ÂàÜÈíüÂâç', color: '#F39C12', status: 'Â§ÑÁêÜ‰∏≠', date: '2024-01-15', greenhouse: 1 },
                { id: 3, type: '‰ø°ÊÅØ', message: 'ËÆæÂ§áÁª¥Êä§ÊèêÈÜíÔºöÂä†ÁÉ≠Âô®Â∑≤ËøêË°å720Â∞èÊó∂ÔºåÂª∫ËÆÆËøõË°åÂÆöÊúüÊ£ÄÊü•', time: '10ÂàÜÈíüÂâç', color: '#3498DB', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 1 },
                { id: 4, type: '‰∏•Èáç', message: 'ÂúüÂ£§ÊπøÂ∫¶ÂºÇÂ∏∏Ôºö‰º†ÊÑüÂô®Ê£ÄÊµãÂà∞ÂúüÂ£§Ëøá‰∫éÂπ≤Áá•ÔºåÈúÄË¶ÅÁ´ãÂç≥ÁÅåÊ∫â', time: '15ÂàÜÈíüÂâç', color: '#E74C3C', status: 'Êú™Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 1 },
                { id: 5, type: 'Ë≠¶Âëä', message: 'ÂÖâÁÖßÂº∫Â∫¶‰∏çË∂≥ÔºöÂΩìÂâçÂÖâÁÖß15000luxÔºå‰Ωé‰∫éÊúÄ‰Ω≥ÁîüÈïøÈúÄÊ±Ç', time: '20ÂàÜÈíüÂâç', color: '#F39C12', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 1 }
            ],
            2: [
                { id: 6, type: '‰ø°ÊÅØ', message: 'Á≥ªÁªüÊõ¥Êñ∞ÈÄöÁü•ÔºöÊñ∞ÁâàÊú¨Âõ∫‰ª∂ÂèØÁî®ÔºåÂª∫ËÆÆÂú®Áª¥Êä§Á™óÂè£ÊúüÈó¥Êõ¥Êñ∞', time: '25ÂàÜÈíüÂâç', color: '#3498DB', status: 'Â∑≤ÂøΩÁï•', date: '2024-01-15', greenhouse: 2 },
                { id: 7, type: '‰∏•Èáç', message: 'ËÆæÂ§áÊïÖÈöúÔºö2Âè∑Ê∏©Â∫¶‰º†ÊÑüÂô®ËøûÊé•ÂºÇÂ∏∏ÔºåÊï∞ÊçÆÈááÈõÜ‰∏≠Êñ≠', time: '30ÂàÜÈíüÂâç', color: '#E74C3C', status: 'Â§ÑÁêÜ‰∏≠', date: '2024-01-15', greenhouse: 2 },
                { id: 8, type: 'Ë≠¶Âëä', message: 'CO2ÊµìÂ∫¶ÂÅèÈ´òÔºöÂΩìÂâçÊµìÂ∫¶1200ppmÔºåÂª∫ËÆÆÂ¢ûÂº∫ÈÄöÈ£é', time: '35ÂàÜÈíüÂâç', color: '#F39C12', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 2 },
                { id: 9, type: '‰ø°ÊÅØ', message: 'ÂÆöÊó∂‰ªªÂä°ÂÆåÊàêÔºöÁéØÂ¢ÉÊï∞ÊçÆÂ§á‰ªΩÂ∑≤ÊàêÂäüÂÆåÊàê', time: '40ÂàÜÈíüÂâç', color: '#3498DB', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 2 }
            ],
            3: [
                { id: 10, type: 'Ë≠¶Âëä', message: 'ÁîµÊ∫êÁîµÂéãÊ≥¢Âä®ÔºöÊ£ÄÊµãÂà∞‰æõÁîµ‰∏çÁ®≥ÂÆöÔºåÂèØËÉΩÂΩ±ÂìçËÆæÂ§áÊ≠£Â∏∏ËøêË°å', time: '45ÂàÜÈíüÂâç', color: '#F39C12', status: 'Êú™Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 3 },
                { id: 11, type: '‰∏•Èáç', message: 'ÁΩëÁªúËøûÊé•ÂºÇÂ∏∏Ôºö‰∏é‰∏≠Â§ÆÊúçÂä°Âô®ÈÄö‰ø°‰∏≠Êñ≠ÔºåÊï∞ÊçÆÂêåÊ≠•Â§±Ë¥•', time: '50ÂàÜÈíüÂâç', color: '#E74C3C', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 3 },
                { id: 12, type: '‰ø°ÊÅØ', message: 'Áî®Êà∑ÁôªÂΩïÈÄöÁü•ÔºöÁÆ°ÁêÜÂëòÁéãÂª∫ÂõΩ‰∫é16:30ÁôªÂΩïÁ≥ªÁªü', time: '55ÂàÜÈíüÂâç', color: '#3498DB', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 3 }
            ],
            4: [
                { id: 13, type: 'Ë≠¶Âëä', message: 'Â≠òÂÇ®Á©∫Èó¥‰∏çË∂≥ÔºöÁ≥ªÁªüÂ≠òÂÇ®‰ΩøÁî®ÁéáËææÂà∞85%ÔºåÂª∫ËÆÆÊ∏ÖÁêÜÂéÜÂè≤Êï∞ÊçÆ', time: '1Â∞èÊó∂Ââç', color: '#F39C12', status: 'Êú™Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 4 },
                { id: 14, type: '‰∏•Èáç', message: 'ÂÆâÂÖ®Ë≠¶Êä•ÔºöÊ£ÄÊµãÂà∞ÂºÇÂ∏∏ËÆøÈóÆÂ∞ùËØïÔºåÂ∑≤Ëá™Âä®ÈîÅÂÆöÁõ∏ÂÖ≥Ë¥¶Êà∑', time: '1Â∞èÊó∂5ÂàÜÈíüÂâç', color: '#E74C3C', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 4 },
                { id: 15, type: '‰ø°ÊÅØ', message: 'Á≥ªÁªüÊÄßËÉΩÊä•ÂëäÔºöËøáÂéª24Â∞èÊó∂Á≥ªÁªüËøêË°åÁ®≥ÂÆöÔºåÂπ≥ÂùáÂìçÂ∫îÊó∂Èó¥120ms', time: '1Â∞èÊó∂10ÂàÜÈíüÂâç', color: '#3498DB', status: 'Â∑≤Â§ÑÁêÜ', date: '2024-01-15', greenhouse: 4 }
            ]
        };

        // ÂΩìÂâçÁ≠õÈÄâÊù°‰ª∂
        let currentAlertFilters = {
            type: '',
            status: '',
            date: '',
            keyword: ''
        };

        // ÁîüÊàêÊä•Ë≠¶È°πÁõÆ
        function generateAlertItems(greenhouseId = 1) {
            let alerts = alertsData[greenhouseId] || [];

            // Â∫îÁî®Á≠õÈÄâÊù°‰ª∂
            alerts = applyFiltersToAlerts(alerts);

            // Êõ¥Êñ∞Êä•Ë≠¶ËÆ°Êï∞ÊòæÁ§∫
            updateAlertCountDisplay(alerts.length);

            if (alerts.length === 0) {
                return '<div style="text-align: center; padding: 40px; color: #666; font-size: 16px;">ÊöÇÊó†Á¨¶ÂêàÊù°‰ª∂ÁöÑÊä•Ë≠¶‰ø°ÊÅØ</div>';
            }

            const statusColors = {
                'Êú™Â§ÑÁêÜ': '#E74C3C',
                'Â§ÑÁêÜ‰∏≠': '#F39C12',
                'Â∑≤Â§ÑÁêÜ': '#27AE60',
                'Â∑≤ÂøΩÁï•': '#95A5A6'
            };

            return alerts.map(alert => `
                <div style="border-left: 4px solid ${alert.color}; padding: 20px; margin-bottom: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s;" onmouseover="this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="background: ${alert.color}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">${alert.type}</span>
                            <span style="background: ${statusColors[alert.status]}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">${alert.status}</span>
                        </div>
                        <span style="color: #666; font-size: 12px; font-weight: 500;">${alert.time}</span>
                    </div>
                    <div style="color: #333; font-size: 14px; line-height: 1.5; margin-bottom: 15px;">${alert.message}</div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button style="padding: 6px 16px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;" onclick="viewAlertDetails(${alert.id})">Êü•ÁúãËØ¶ÊÉÖ</button>
                        ${alert.status !== 'Â∑≤Â§ÑÁêÜ' && alert.status !== 'Â∑≤ÂøΩÁï•' ?
                    `<button style="padding: 6px 16px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;" onclick="markAlertAsHandled(${alert.id})">Ê†áËÆ∞Â§ÑÁêÜ</button>` :
                    `<button style="padding: 6px 16px; background: #95A5A6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;" disabled>Â∑≤Â§ÑÁêÜ</button>`
                }
                    </div>
                </div>
            `).join('');
        }

        // Â∫îÁî®Á≠õÈÄâÊù°‰ª∂Âà∞Êä•Ë≠¶Êï∞ÊçÆ
        function applyFiltersToAlerts(alerts) {
            return alerts.filter(alert => {
                // Á±ªÂûãÁ≠õÈÄâ
                if (currentAlertFilters.type && alert.type !== currentAlertFilters.type) {
                    return false;
                }

                // Áä∂ÊÄÅÁ≠õÈÄâ
                if (currentAlertFilters.status && alert.status !== currentAlertFilters.status) {
                    return false;
                }

                // Êó•ÊúüÁ≠õÈÄâ
                if (currentAlertFilters.date && alert.date !== currentAlertFilters.date) {
                    return false;
                }

                // ÂÖ≥ÈîÆËØçÁ≠õÈÄâ
                if (currentAlertFilters.keyword) {
                    const keyword = currentAlertFilters.keyword.toLowerCase();
                    if (!alert.message.toLowerCase().includes(keyword)) {
                        return false;
                    }
                }

                return true;
            });
        }

        // Êõ¥Êñ∞Êä•Ë≠¶ËÆ°Êï∞ÊòæÁ§∫
        function updateAlertCountDisplay(count) {
            const countDisplay = document.getElementById('alertCountDisplay');
            if (countDisplay) {
                countDisplay.textContent = `ÂÖ± ${count} Êù°Êä•Ë≠¶`;
            }
        }

        // Â∫îÁî®Êä•Ë≠¶Á≠õÈÄâ
        function applyAlertFilters() {
            currentAlertFilters.type = document.getElementById('alertTypeFilter')?.value || '';
            currentAlertFilters.status = document.getElementById('alertStatusFilter')?.value || '';
            currentAlertFilters.date = document.getElementById('alertDateFilter')?.value || '';
            currentAlertFilters.keyword = document.getElementById('alertKeywordFilter')?.value || '';

            // ÈáçÊñ∞ÁîüÊàêÊä•Ë≠¶ÂàóË°®
            const alertsList = document.getElementById('alertsList');
            if (alertsList) {
                alertsList.innerHTML = generateAlertItems(currentAlertGreenhouse);
            }

            // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
            updateAlertStats(currentAlertGreenhouse);
        }

        // Ê∏ÖÈô§Êä•Ë≠¶Á≠õÈÄâ
        function clearAlertFilters() {
            currentAlertFilters = {
                type: '',
                status: '',
                date: '',
                keyword: ''
            };

            // Ê∏ÖÁ©∫Á≠õÈÄâË°®Âçï
            const typeFilter = document.getElementById('alertTypeFilter');
            const statusFilter = document.getElementById('alertStatusFilter');
            const dateFilter = document.getElementById('alertDateFilter');
            const keywordFilter = document.getElementById('alertKeywordFilter');

            if (typeFilter) typeFilter.value = '';
            if (statusFilter) statusFilter.value = '';
            if (dateFilter) dateFilter.value = '';
            if (keywordFilter) keywordFilter.value = '';

            // ÈáçÊñ∞ÁîüÊàêÊä•Ë≠¶ÂàóË°®
            const alertsList = document.getElementById('alertsList');
            if (alertsList) {
                alertsList.innerHTML = generateAlertItems(currentAlertGreenhouse);
            }

            // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
            updateAlertStats(currentAlertGreenhouse);
        }

        // Ê†áËÆ∞Êä•Ë≠¶‰∏∫Â∑≤Â§ÑÁêÜÔºàÂ∏¶Á°ÆËÆ§ÂºπÁ™óÔºâ
        function markAlertAsHandled(alertId) {
            // ÊâæÂà∞ÂØπÂ∫îÁöÑÊä•Ë≠¶
            let alert = null;
            let alertIndex = -1;
            let greenhouseAlerts = null;

            for (let greenhouse in alertsData) {
                const alerts = alertsData[greenhouse];
                const index = alerts.findIndex(a => a.id === alertId);
                if (index !== -1) {
                    alert = alerts[index];
                    alertIndex = index;
                    greenhouseAlerts = alerts;
                    break;
                }
            }

            if (!alert) {
                alert('Êú™ÊâæÂà∞ÂØπÂ∫îÁöÑÊä•Ë≠¶‰ø°ÊÅØ');
                return;
            }

            // ÊòæÁ§∫Á°ÆËÆ§ÂºπÁ™ó
            showAlertHandleConfirmModal(alert, function () {
                // Á°ÆËÆ§Â§ÑÁêÜ
                alert.status = 'Â∑≤Â§ÑÁêÜ';
                alert.handledTime = new Date().toLocaleString();
                alert.handledBy = 'ÂΩìÂâçÁî®Êà∑'; // ËøôÈáåÂèØ‰ª•ÊõøÊç¢‰∏∫ÂÆûÈôÖÁöÑÁî®Êà∑‰ø°ÊÅØ

                // Âà∑Êñ∞Êä•Ë≠¶ÂàóË°®
                const alertsList = document.getElementById('alertsList');
                if (alertsList) {
                    alertsList.innerHTML = generateAlertItems(currentAlertGreenhouse);
                }

                // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
                updateAlertStats(currentAlertGreenhouse);

                // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                UserFriendlyAlert.showSuccess('Êä•Ë≠¶Â∑≤Ê†áËÆ∞‰∏∫Â∑≤Â§ÑÁêÜ');
            });
        }

        // ÊòæÁ§∫Êä•Ë≠¶Â§ÑÁêÜÁ°ÆËÆ§ÂºπÁ™ó
        function showAlertHandleConfirmModal(alert, onConfirm) {
            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.3s ease;
            `;

            // ÂàõÂª∫ÂºπÁ™ó
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 15px;
                width: 90%;
                max-width: 500px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                animation: slideIn 0.3s ease;
            `;

            modal.innerHTML = `
                <div style="padding: 25px; border-bottom: 1px solid #eee;">
                    <h3 style="margin: 0; color: #333; font-size: 20px; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">‚ö†Ô∏è</span>Á°ÆËÆ§Â§ÑÁêÜÊä•Ë≠¶
                    </h3>
                </div>
                
                <div style="padding: 25px;">
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                            <span style="background: ${alert.color}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">${alert.type}</span>
                            <span style="color: #666; font-size: 12px;">${alert.time}</span>
                        </div>
                        <div style="color: #333; font-size: 14px; line-height: 1.5;">${alert.message}</div>
                    </div>
                    
                    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <div style="color: #856404; font-size: 14px; font-weight: 600; margin-bottom: 5px;">‚ö†Ô∏è Â§ÑÁêÜÁ°ÆËÆ§</div>
                        <div style="color: #856404; font-size: 13px;">Á°ÆËÆ§Â∞ÜÊ≠§Êä•Ë≠¶Ê†áËÆ∞‰∏∫Â∑≤Â§ÑÁêÜÔºüÊ≠§Êìç‰ΩúÂ∞ÜÊõ¥Êñ∞Êä•Ë≠¶Áä∂ÊÄÅÔºåËØ∑Á°Æ‰øùÈóÆÈ¢òÂ∑≤ÂæóÂà∞Â¶•ÂñÑËß£ÂÜ≥„ÄÇ</div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-size: 14px; color: #555; font-weight: 600;">Â§ÑÁêÜÂ§áÊ≥®ÔºàÂèØÈÄâÔºâ</label>
                        <textarea id="handleNotes" placeholder="ËØ∑ËæìÂÖ•Â§ÑÁêÜÊÉÖÂÜµËØ¥Êòé..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;" rows="3"></textarea>
                    </div>
                </div>
                
                <div style="padding: 20px 25px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px;">
                    <button type="button" onclick="closeAlertHandleModal()" style="padding: 10px 20px; background: #95A5A6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">ÂèñÊ∂à</button>
                    <button type="button" onclick="confirmAlertHandle()" style="padding: 10px 20px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Á°ÆËÆ§Â§ÑÁêÜ</button>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
            overlay.addEventListener('click', function (e) {
                if (e.target === overlay) {
                    closeAlertHandleModal();
                }
            });

            // ‰øùÂ≠òÂºπÁ™óÂºïÁî®ÂíåÂõûË∞ÉÂáΩÊï∞
            window.currentAlertHandleModal = overlay;
            window.currentAlertHandleCallback = onConfirm;
        }

        // ÂÖ≥Èó≠Êä•Ë≠¶Â§ÑÁêÜÁ°ÆËÆ§ÂºπÁ™ó
        function closeAlertHandleModal() {
            if (window.currentAlertHandleModal) {
                document.body.removeChild(window.currentAlertHandleModal);
                window.currentAlertHandleModal = null;
                window.currentAlertHandleCallback = null;
            }
        }

        // Á°ÆËÆ§Â§ÑÁêÜÊä•Ë≠¶
        function confirmAlertHandle() {
            const notes = document.getElementById('handleNotes')?.value || '';

            // ÊâßË°åÂõûË∞ÉÂáΩÊï∞
            if (window.currentAlertHandleCallback) {
                window.currentAlertHandleCallback(notes);
            }

            // ÂÖ≥Èó≠ÂºπÁ™ó
            closeAlertHandleModal();
        }

        // Êü•ÁúãÊä•Ë≠¶ËØ¶ÊÉÖ
        function viewAlertDetails(alertId) {
            // ÊâæÂà∞ÂØπÂ∫îÁöÑÊä•Ë≠¶
            let alert = null;

            for (let greenhouse in alertsData) {
                const alerts = alertsData[greenhouse];
                alert = alerts.find(a => a.id === alertId);
                if (alert) break;
            }

            if (!alert) {
                alert('Êú™ÊâæÂà∞ÂØπÂ∫îÁöÑÊä•Ë≠¶‰ø°ÊÅØ');
                return;
            }

            // ÊòæÁ§∫ËØ¶ÊÉÖÂºπÁ™ó
            showAlertDetailsModal(alert);
        }

        // ÊòæÁ§∫Êä•Ë≠¶ËØ¶ÊÉÖÂºπÁ™ó
        function showAlertDetailsModal(alert) {
            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.3s ease;
            `;

            // ÂàõÂª∫ÂºπÁ™ó
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 15px;
                width: 90%;
                max-width: 600px;
                max-height: 90vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                animation: slideIn 0.3s ease;
            `;

            // Ëé∑ÂèñÊ∏©ÂÆ§ÂêçÁß∞
            const greenhouseName = `${alert.greenhouse}Âè∑Ê∏©ÂÆ§`;

            // Ëé∑ÂèñÁä∂ÊÄÅÈ¢úËâ≤
            const statusColors = {
                'Êú™Â§ÑÁêÜ': '#E74C3C',
                'Â§ÑÁêÜ‰∏≠': '#F39C12',
                'Â∑≤Â§ÑÁêÜ': '#27AE60',
                'Â∑≤ÂøΩÁï•': '#95A5A6'
            };

            modal.innerHTML = `
                <div style="padding: 25px; border-bottom: 1px solid #eee;">
                    <h3 style="margin: 0; color: #333; font-size: 20px; display: flex; align-items: center; justify-content: space-between;">
                        <span style="display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üö®</span>Êä•Ë≠¶ËØ¶ÊÉÖ
                        </span>
                        <button onclick="closeAlertDetailsModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">√ó</button>
                    </h3>
                </div>
                
                <div style="padding: 25px;">
                    <!-- Âü∫Êú¨‰ø°ÊÅØÂç°Áâá -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Âü∫Êú¨‰ø°ÊÅØ</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Êä•Ë≠¶Á±ªÂûã</label>
                                <div style="margin-top: 5px;">
                                    <span style="background: \${alert.color}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">\${alert.type}</span>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Â§ÑÁêÜÁä∂ÊÄÅ</label>
                                <div style="margin-top: 5px;">
                                    <span style="background: \${statusColors[alert.status]}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">\${alert.status}</span>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">ÂèëÁîüÊó∂Èó¥</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">\${alert.time}</div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">ÊâÄÂ±ûÊ∏©ÂÆ§</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">\${greenhouseName}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Êä•Ë≠¶ÂÜÖÂÆπÂç°Áâá -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Êä•Ë≠¶ÂÜÖÂÆπ</h4>
                        <div style="font-size: 14px; color: #333; line-height: 1.6; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid \${alert.color};">
                            \${alert.message}
                        </div>
                    </div>
                    
                    <!-- Â§ÑÁêÜ‰ø°ÊÅØÂç°Áâá -->
                    ${alert.status === 'Â∑≤Â§ÑÁêÜ' && alert.handledTime ? `
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Â§ÑÁêÜ‰ø°ÊÅØ</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Â§ÑÁêÜÊó∂Èó¥</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">\${alert.handledTime}</div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Â§ÑÁêÜ‰∫∫Âëò</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">\${alert.handledBy || 'Á≥ªÁªüÁî®Êà∑'}</div>
                            </div>
                        </div>
                        ${alert.handleNotes ? `
                        <div style="margin-top: 15px;">
                            <label style="font-size: 12px; color: #666; font-weight: 600;">Â§ÑÁêÜÂ§áÊ≥®</label>
                            <div style="font-size: 14px; color: #333; margin-top: 5px; padding: 10px; background: white; border-radius: 6px;">${alert.handleNotes}</div>
                        </div>
                        ` : ''}
                    </div>
                    ` : ''}
                    
                    <!-- Âª∫ËÆÆÊìç‰ΩúÂç°Áâá -->
                    <div style="background: #e3f2fd; border: 1px solid #bbdefb; border-radius: 10px; padding: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #1976d2;">üí° Âª∫ËÆÆÊìç‰Ωú</h4>
                        <div style="font-size: 14px; color: #1976d2; line-height: 1.6;">
                            \${getSuggestedActions(alert)}
                        </div>
                    </div>
                </div>
                
                <div style="padding: 20px 25px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px;">
                    ${alert.status !== 'Â∑≤Â§ÑÁêÜ' && alert.status !== 'Â∑≤ÂøΩÁï•' ?
                    `<button type="button" onclick="markAlertAsHandledFromDetails(${alert.id})" style="padding: 10px 20px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Ê†áËÆ∞Â§ÑÁêÜ</button>` :
                    ''
                }
                    <button type="button" onclick="closeAlertDetailsModal()" style="padding: 10px 20px; background: #95A5A6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">ÂÖ≥Èó≠</button>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
            overlay.addEventListener('click', function (e) {
                if (e.target === overlay) {
                    closeAlertDetailsModal();
                }
            });

            // ‰øùÂ≠òÂºπÁ™óÂºïÁî®
            window.currentAlertDetailsModal = overlay;
        }

        // ÂÖ≥Èó≠Êä•Ë≠¶ËØ¶ÊÉÖÂºπÁ™ó
        function closeAlertDetailsModal() {
            if (window.currentAlertDetailsModal) {
                document.body.removeChild(window.currentAlertDetailsModal);
                window.currentAlertDetailsModal = null;
            }
        }

        // ‰ªéËØ¶ÊÉÖÈ°µÈù¢Ê†áËÆ∞Â§ÑÁêÜ
        function markAlertAsHandledFromDetails(alertId) {
            closeAlertDetailsModal();
            markAlertAsHandled(alertId);
        }

        // Ëé∑ÂèñÂª∫ËÆÆÊìç‰Ωú
        function getSuggestedActions(alert) {
            const suggestions = {
                '‰∏•Èáç': {
                    'Ê∏©Â∫¶': 'Á´ãÂç≥Ê£ÄÊü•Ê∏©ÊéßËÆæÂ§áÔºåË∞ÉÊï¥Ê∏©Â∫¶ËÆæÁΩÆÔºåÁ°Æ‰øùÈÄöÈ£éÁ≥ªÁªüÊ≠£Â∏∏ËøêË°å',
                    'ÊπøÂ∫¶': 'Ê£ÄÊü•Âä†Êπø/Èô§ÊπøËÆæÂ§áÔºåË∞ÉÊï¥ÊπøÂ∫¶ÊéßÂà∂ÂèÇÊï∞ÔºåÊ£ÄÊü•ÈÄöÈ£éÊÉÖÂÜµ',
                    'ËÆæÂ§á': 'Á´ãÂç≥Ê£ÄÊü•ËÆæÂ§áËøûÊé•Áä∂ÊÄÅÔºåÈáçÂêØËÆæÂ§áÊàñËÅîÁ≥ªÊäÄÊúØ‰∫∫ÂëòÁª¥‰øÆ',
                    'ÁΩëÁªú': 'Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÔºåÈáçÂêØÁΩëÁªúËÆæÂ§áÔºåËÅîÁ≥ªÁΩëÁªúÁÆ°ÁêÜÂëò',
                    'ÂÆâÂÖ®': 'Á´ãÂç≥Ê£ÄÊü•Á≥ªÁªüÂÆâÂÖ®Áä∂ÊÄÅÔºåÊõ¥ÊîπÂØÜÁ†ÅÔºåÊ£ÄÊü•ËÆøÈóÆÊó•Âøó'
                },
                'Ë≠¶Âëä': {
                    'Ê∏©Â∫¶': 'ÁõëÊéßÊ∏©Â∫¶ÂèòÂåñË∂ãÂäøÔºåÈÄÇÂΩìË∞ÉÊï¥Ê∏©ÊéßËÆæÂ§áÂèÇÊï∞',
                    'ÊπøÂ∫¶': 'ÂÖ≥Ê≥®ÊπøÂ∫¶ÂèòÂåñÔºåÂøÖË¶ÅÊó∂ÂêØÂä®ÊπøÂ∫¶Ë∞ÉËäÇËÆæÂ§á',
                    'ÂÖâÁÖß': 'Ê£ÄÊü•Ë°•ÂÖâËÆæÂ§áÁä∂ÊÄÅÔºåË∞ÉÊï¥ÂÖâÁÖßÊó∂Èó¥ÂíåÂº∫Â∫¶',
                    'ÁîµÊ∫ê': 'Ê£ÄÊü•ÁîµÊ∫ê‰æõÂ∫îÁ®≥ÂÆöÊÄßÔºåÂáÜÂ§áÂ§áÁî®ÁîµÊ∫ê',
                    'Â≠òÂÇ®': 'Ê∏ÖÁêÜ‰∏çÂøÖË¶ÅÁöÑÂéÜÂè≤Êï∞ÊçÆÔºåÊâ©Â±ïÂ≠òÂÇ®Á©∫Èó¥'
                },
                '‰ø°ÊÅØ': {
                    'Áª¥Êä§': 'ÊåâËÆ°ÂàíËøõË°åËÆæÂ§áÁª¥Êä§ÔºåËÆ∞ÂΩïÁª¥Êä§ÊÉÖÂÜµ',
                    'Êõ¥Êñ∞': 'Âú®ÂêàÈÄÇÊó∂Èó¥ËøõË°åÁ≥ªÁªüÊõ¥Êñ∞ÔºåÂ§á‰ªΩÈáçË¶ÅÊï∞ÊçÆ',
                    'Áî®Êà∑': 'ËÆ∞ÂΩïÁî®Êà∑Êìç‰ΩúÊó•ÂøóÔºåÂøÖË¶ÅÊó∂ËøõË°åÂÆâÂÖ®Ê£ÄÊü•',
                    'ÊÄßËÉΩ': 'ÊåÅÁª≠ÁõëÊéßÁ≥ªÁªüÊÄßËÉΩÔºå‰ºòÂåñÁ≥ªÁªüÈÖçÁΩÆ'
                }
            };

            const type = alert.type;
            const message = alert.message.toLowerCase();

            if (suggestions[type]) {
                for (let key in suggestions[type]) {
                    if (message.includes(key)) {
                        return suggestions[type][key];
                    }
                }
            }

            // ÈªòËÆ§Âª∫ËÆÆ
            return 'ËØ∑Ê†πÊçÆÊä•Ë≠¶ÂÜÖÂÆπÈááÂèñÁõ∏Â∫îÁöÑÂ§ÑÁêÜÊé™ÊñΩÔºåÁ°Æ‰øùÁ≥ªÁªüÊ≠£Â∏∏ËøêË°å„ÄÇÂ¶ÇÈúÄÂ∏ÆÂä©ÔºåËØ∑ËÅîÁ≥ªÊäÄÊúØÊîØÊåÅ„ÄÇ';
        }

        // ÁîüÊàêÂéÜÂè≤ËÆ∞ÂΩïÈ°πÁõÆ
        function generateHistoryItems(greenhouseId = 1) {
            const history = [
                { type: 'ÁéØÂ¢ÉÊï∞ÊçÆ', content: 'Ê∏©Â∫¶: 24.5¬∞C, ÊπøÂ∫¶: 68%, ÂÖâÁÖß: 25000lux, ÂúüÂ£§ÊπøÂ∫¶: 58%', time: '2024-01-15 16:30:00' },
                { type: 'ËÆæÂ§áÊìç‰Ωú', content: 'ÂêØÂä®Âä†ÁÉ≠Âô® - Ê∏©Â∫¶Ë∞ÉËäÇËá≥ÁõÆÊ†áÂÄº', time: '2024-01-15 16:25:00' },
                { type: 'Êä•Ë≠¶ËÆ∞ÂΩï', content: 'ÊπøÂ∫¶Ëøá‰ΩéÊä•Ë≠¶Â∑≤Â§ÑÁêÜ - ÂêØÂä®Âä†ÊπøÂô®', time: '2024-01-15 16:20:00' },
                { type: 'ÁéØÂ¢ÉÊï∞ÊçÆ', content: 'Ê∏©Â∫¶: 23.8¬∞C, ÊπøÂ∫¶: 65%, ÂÖâÁÖß: 24500lux, ÂúüÂ£§ÊπøÂ∫¶: 60%', time: '2024-01-15 16:15:00' },
                { type: 'ËÆæÂ§áÊìç‰Ωú', content: 'ÂÅúÊ≠¢È£éÊâá - Ê∏©Â∫¶Â∑≤ËææÂà∞ÈÄÇÂÆúËåÉÂõ¥', time: '2024-01-15 16:10:00' },
                { type: 'Áî®Êà∑Êìç‰Ωú', content: 'ÁÆ°ÁêÜÂëòÈôàÂøóÂº∫ÁôªÂΩïÁ≥ªÁªü', time: '2024-01-15 16:05:00' },
                { type: 'Êä•Ë≠¶ËÆ∞ÂΩï', content: 'Ê∏©Â∫¶ËøáÈ´òÊä•Ë≠¶ - Ëá™Âä®ÂêØÂä®ÂÜ∑Âç¥Á≥ªÁªü', time: '2024-01-15 16:00:00' },
                { type: 'ÁéØÂ¢ÉÊï∞ÊçÆ', content: 'Ê∏©Â∫¶: 26.2¬∞C, ÊπøÂ∫¶: 62%, ÂÖâÁÖß: 24000lux, ÂúüÂ£§ÊπøÂ∫¶: 55%', time: '2024-01-15 15:55:00' },
                { type: 'ËÆæÂ§áÊìç‰Ωú', content: 'ÂêØÂä®Ê∞¥Ê≥µ - ÂúüÂ£§ÊπøÂ∫¶Ë°•ÂÖÖ', time: '2024-01-15 15:50:00' },
                { type: 'Á≥ªÁªü‰∫ã‰ª∂', content: 'ÂÆöÊó∂‰ªªÂä°ÊâßË°å - ÁéØÂ¢ÉÊï∞ÊçÆÈááÈõÜÂÆåÊàê', time: '2024-01-15 15:45:00' },
                { type: 'ËÆæÂ§áÊìç‰Ωú', content: 'ÂºÄÂêØË°•ÂÖâÁÅØ - ÂÖâÁÖßÂº∫Â∫¶‰∏çË∂≥', time: '2024-01-15 15:40:00' },
                { type: 'ÁéØÂ¢ÉÊï∞ÊçÆ', content: 'Ê∏©Â∫¶: 22.1¬∞C, ÊπøÂ∫¶: 70%, ÂÖâÁÖß: 18000lux, ÂúüÂ£§ÊπøÂ∫¶: 52%', time: '2024-01-15 15:35:00' },
                { type: 'Êä•Ë≠¶ËÆ∞ÂΩï', content: 'ÂÖâÁÖßÂº∫Â∫¶‰∏çË∂≥Êä•Ë≠¶ - Â∑≤Ëá™Âä®Ë∞ÉËäÇ', time: '2024-01-15 15:30:00' },
                { type: 'Áî®Êà∑Êìç‰Ωú', content: 'Áî®Êà∑ÊùéÁæéÂçéÂØºÂá∫ÁéØÂ¢ÉÊï∞ÊçÆÊä•Ë°®', time: '2024-01-15 15:25:00' },
                { type: 'Á≥ªÁªü‰∫ã‰ª∂', content: 'Á≥ªÁªüËá™Ê£ÄÂÆåÊàê - ÊâÄÊúâËÆæÂ§áËøêË°åÊ≠£Â∏∏', time: '2024-01-15 15:20:00' }
            ];

            const typeColors = {
                'ÁéØÂ¢ÉÊï∞ÊçÆ': '#2C3E50',
                'ËÆæÂ§áÊìç‰Ωú': '#27AE60',
                'Êä•Ë≠¶ËÆ∞ÂΩï': '#E74C3C',
                'Áî®Êà∑Êìç‰Ωú': '#3498DB',
                'Á≥ªÁªü‰∫ã‰ª∂': '#8E44AD'
            };

            return history.map(item => `
                <div style="border-bottom: 1px solid #eee; padding: 15px 0; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f8f9fa'" onmouseout="this.style.backgroundColor='white'">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="background: ${typeColors[item.type] || '#4CAF50'}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">${item.type}</span>
                        <span style="color: #666; font-size: 12px; font-weight: 500;">${item.time}</span>
                    </div>
                    <div style="color: #333; font-size: 14px; line-height: 1.4;">${item.content}</div>
                </div>
            `).join('');
        }

        // Ê∏©ÂÆ§Êï∞ÊçÆÈÖçÁΩÆ
        const greenhouseData = {
            1: {
                name: '1Âè∑Ê∏©ÂÆ§ (Ëî¨ËèúÂå∫)',
                data: {
                    airTemp: '23.5¬∞C',
                    airHumidity: '65.8%',
                    lightIntensity: '25000 lux',
                    soilMoisture: '58.2%',
                    co2Level: '420 ppm',
                    soilTemp: '21.8¬∞C',
                    windSpeed: '0.8 m/s',
                    soilPH: '6.8',
                    soilEC: '1.2 mS/cm',
                    leafTemp: '22.3¬∞C',
                    transpiration: '2.4 mm/h'
                }
            },
            2: {
                name: '2Âè∑Ê∏©ÂÆ§ (Ëä±ÂçâÂå∫)',
                data: {
                    airTemp: '25.2¬∞C',
                    airHumidity: '72.3%',
                    lightIntensity: '28000 lux',
                    soilMoisture: '62.5%',
                    co2Level: '380 ppm',
                    soilTemp: '23.1¬∞C',
                    windSpeed: '1.2 m/s',
                    soilPH: '6.5',
                    soilEC: '1.4 mS/cm',
                    leafTemp: '24.1¬∞C',
                    transpiration: '3.1 mm/h'
                }
            },
            3: {
                name: '3Âè∑Ê∏©ÂÆ§ (ËÇ≤ËãóÂå∫)',
                data: {
                    airTemp: '26.8¬∞C',
                    airHumidity: '78.5%',
                    lightIntensity: '22000 lux',
                    soilMoisture: '68.9%',
                    co2Level: '450 ppm',
                    soilTemp: '25.3¬∞C',
                    windSpeed: '0.5 m/s',
                    soilPH: '6.2',
                    soilEC: '0.9 mS/cm',
                    leafTemp: '25.6¬∞C',
                    transpiration: '2.8 mm/h'
                }
            },
            4: {
                name: '4Âè∑Ê∏©ÂÆ§ (ÂÆûÈ™åÂå∫)',
                data: {
                    airTemp: '22.1¬∞C',
                    airHumidity: '60.4%',
                    lightIntensity: '30000 lux',
                    soilMoisture: '55.7%',
                    co2Level: '500 ppm',
                    soilTemp: '20.9¬∞C',
                    windSpeed: '1.5 m/s',
                    soilPH: '7.1',
                    soilEC: '1.6 mS/cm',
                    leafTemp: '21.8¬∞C',
                    transpiration: '2.1 mm/h'
                }
            }
        };

        // Ê∏©ÂÆ§ÈÄâÊã©ÂáΩÊï∞
        function selectGreenhouse(id) {
            currentGreenhouse = id;

            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.greenhouse-btn').forEach(btn => {
                btn.style.background = '#95A5A6';
            });
            event.target.style.background = '#2C3E50';

            // Êõ¥Êñ∞ÁéØÂ¢ÉÊï∞ÊçÆÊòæÁ§∫
            updateGreenhouseData(id);

            UserFriendlyAlert.showSuccess(`Â∑≤ÂàáÊç¢Âà∞${greenhouseData[id].name}`);
        }

        // Êõ¥Êñ∞Ê∏©ÂÆ§Êï∞ÊçÆÊòæÁ§∫
        function updateGreenhouseData(id) {
            const data = greenhouseData[id].data;

            // Êõ¥Êñ∞ÊâÄÊúâ‰º†ÊÑüÂô®Êï∞ÊçÆ
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = data[key];
                }
            });
        }

        // ÁéØÂ¢ÉÊï∞ÊçÆÁõ∏ÂÖ≥ÂáΩÊï∞
        function refreshEnvironmentData() {
            updateGreenhouseData(currentGreenhouse);
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('environment_data_refresh'));
        }

        function exportEnvironmentData() {
            UserFriendlyAlert.showSuccess(`${greenhouseData[currentGreenhouse].name}ÁéØÂ¢ÉÊï∞ÊçÆÂØºÂá∫ÊàêÂäü`);
        }

        function setEnvironmentAlerts() {
            UserFriendlyAlert.showSuccess('ÁéØÂ¢ÉÊä•Ë≠¶ÈòàÂÄºËÆæÁΩÆÂ∑≤‰øùÂ≠ò');
        }

        function viewEnvironmentTrends() {
            UserFriendlyAlert.showSuccess('Ê≠£Âú®ÁîüÊàêÁéØÂ¢ÉË∂ãÂäøÂàÜÊûêÂõæË°®');
        }

        function calibrateSensors() {
            UserFriendlyAlert.showSuccess(`${greenhouseData[currentGreenhouse].name}‰º†ÊÑüÂô®Ê†°ÂáÜÂÆåÊàê`);
        }

        function generateEnvironmentReport() {
            UserFriendlyAlert.showSuccess(`${greenhouseData[currentGreenhouse].name}ÁéØÂ¢ÉÁõëÊµãÊä•ÂëäÁîüÊàêÊàêÂäü`);
        }

        function updateEnvironmentData() {
            // Ê®°ÊãüÊï∞ÊçÆÊõ¥Êñ∞
            updateGreenhouseData(currentGreenhouse);
        }

        // ËÆæÂ§áÊéßÂà∂È°µÈù¢Ê∏©ÂÆ§ÈÄâÊã©
        function selectDeviceGreenhouse(id) {
            currentDeviceGreenhouse = id;

            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.device-greenhouse-btn').forEach(btn => {
                btn.style.background = '#95A5A6';
            });
            event.target.style.background = '#2C3E50';

            // ÈáçÊñ∞ÁîüÊàêËÆæÂ§áÂç°Áâá
            const devicesGrid = document.getElementById('devicesGrid');
            if (devicesGrid) {
                devicesGrid.innerHTML = generateDeviceCards(id);
            }

            UserFriendlyAlert.showSuccess(`Â∑≤ÂàáÊç¢Âà∞${greenhouseData[id].name}ÁöÑËÆæÂ§áÊéßÂà∂`);
        }

        // Êä•Ë≠¶ÁÆ°ÁêÜÈ°µÈù¢Ê∏©ÂÆ§ÈÄâÊã©
        function selectAlertGreenhouse(id) {
            currentAlertGreenhouse = id;

            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.alert-greenhouse-btn').forEach(btn => {
                btn.style.background = '#95A5A6';
            });
            event.target.style.background = '#2C3E50';

            // Êõ¥Êñ∞Êä•Ë≠¶ÁªüËÆ°Êï∞ÊçÆ
            updateAlertStats(id);

            // ÈáçÊñ∞ÁîüÊàêÊä•Ë≠¶ÂàóË°®
            const alertsList = document.getElementById('alertsList');
            if (alertsList) {
                alertsList.innerHTML = generateAlertItems(id);
            }

            UserFriendlyAlert.showSuccess(`Â∑≤ÂàáÊç¢Âà∞${greenhouseData[id].name}ÁöÑÊä•Ë≠¶ÁÆ°ÁêÜ`);
        }

        // ÂéÜÂè≤ËÆ∞ÂΩïÈ°µÈù¢Ê∏©ÂÆ§ÈÄâÊã©
        function selectHistoryGreenhouse(id) {
            currentHistoryGreenhouse = id;

            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.history-greenhouse-btn').forEach(btn => {
                btn.style.background = '#95A5A6';
            });
            event.target.style.background = '#2C3E50';

            // ÈáçÊñ∞ÁîüÊàêÂéÜÂè≤ËÆ∞ÂΩï
            const historyList = document.getElementById('historyList');
            if (historyList) {
                historyList.innerHTML = generateHistoryItems(id);
            }

            UserFriendlyAlert.showSuccess(`Â∑≤ÂàáÊç¢Âà∞${greenhouseData[id].name}ÁöÑÂéÜÂè≤ËÆ∞ÂΩï`);
        }

        // Êõ¥Êñ∞Êä•Ë≠¶ÁªüËÆ°Êï∞ÊçÆ
        function updateAlertStats(greenhouseId) {
            const alerts = alertsData[greenhouseId] || [];

            // Â∫îÁî®ÂΩìÂâçÁ≠õÈÄâÊù°‰ª∂
            const filteredAlerts = applyFiltersToAlerts(alerts);

            // ÁªüËÆ°ÂêÑÁ±ªÂûãÊä•Ë≠¶Êï∞Èáè
            const stats = {
                critical: filteredAlerts.filter(alert => alert.type === '‰∏•Èáç').length,
                warning: filteredAlerts.filter(alert => alert.type === 'Ë≠¶Âëä').length,
                info: filteredAlerts.filter(alert => alert.type === '‰ø°ÊÅØ').length,
                resolved: filteredAlerts.filter(alert => alert.status === 'Â∑≤Â§ÑÁêÜ').length
            };

            // Êõ¥Êñ∞ÊòæÁ§∫
            const criticalElement = document.getElementById('criticalAlerts');
            const warningElement = document.getElementById('warningAlerts');
            const infoElement = document.getElementById('infoAlerts');
            const resolvedElement = document.getElementById('resolvedAlerts');

            if (criticalElement) criticalElement.textContent = stats.critical;
            if (warningElement) warningElement.textContent = stats.warning;
            if (infoElement) infoElement.textContent = stats.info;
            if (resolvedElement) resolvedElement.textContent = stats.resolved;
        }

        // ËÆæÂ§áÊéßÂà∂Áõ∏ÂÖ≥ÂáΩÊï∞
        function startAllDevices() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_start_all'));
        }

        function stopAllDevices() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_stop_all'));
        }

        function refreshDevices() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_refresh'));
        }

        function startDevice(deviceName) {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_start_single', `${deviceName}Â∑≤ÂêØÂä®`));
        }

        function stopDevice(deviceName) {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_stop_single', `${deviceName}Â∑≤ÂÅúÊ≠¢`));
        }

        // ÊòæÁ§∫ËÆæÂ§áÊéßÂà∂ÂºπÊ°Ü
        function showDeviceControlModal(deviceName, deviceIcon, deviceStatus, deviceColor) {
            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                backdrop-filter: blur(5px);
            `;

            // Ëé∑ÂèñËÆæÂ§áÁ±ªÂûã
            const deviceType = getDeviceType(deviceName);
            const deviceId = deviceName.replace(/\s+/g, '-').toLowerCase();

            // ÂàõÂª∫ÂºπÊ°Ü
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 20px;
                padding: 0;
                max-width: 500px;
                width: 90%;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                transform: scale(0.9);
                transition: transform 0.3s ease;
            `;

            modal.innerHTML = `
                <!-- ÂºπÊ°ÜÂ§¥ÈÉ® -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 20px 20px 0 0; position: relative;">
                    <button onclick="closeDeviceModal()" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); border: none; color: white; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">√ó</button>
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 48px; margin-right: 20px;">${deviceIcon}</div>
                        <div>
                            <h2 style="margin: 0; font-size: 24px; font-weight: 700;">${deviceName}</h2>
                            <div style="font-size: 16px; opacity: 0.9; margin-top: 5px;">ËÆæÂ§áÁ±ªÂûãÔºö${deviceType}</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="padding: 6px 12px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; font-weight: 600;">
                            Áä∂ÊÄÅÔºö<span style="color: ${deviceColor};">${deviceStatus}</span>
                        </span>
                        <span id="device-power-display" style="padding: 6px 12px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; font-weight: 600;">
                            ÂäüÁéáÔºö75%
                        </span>
                    </div>
                </div>

                <!-- ÂºπÊ°ÜÂÜÖÂÆπ -->
                <div style="padding: 30px;">
                    <!-- ËÆæÂ§á‰ø°ÊÅØ -->
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìã</span>ËÆæÂ§á‰ø°ÊÅØ
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 14px;">
                                <div><strong>ËÆæÂ§áIDÔºö</strong>${deviceId}</div>
                                <div><strong>ËÆæÂ§áÁ±ªÂûãÔºö</strong>${deviceType}</div>
                                <div><strong>ÂΩìÂâçÁä∂ÊÄÅÔºö</strong><span style="color: ${deviceColor}; font-weight: 600;">${deviceStatus}</span></div>
                                <div><strong>ËøêË°åÊó∂Èó¥Ôºö</strong>2Â∞èÊó∂35ÂàÜÈíü</div>
                                <div><strong>ÊúÄÂêéÁª¥Êä§Ôºö</strong>2024-08-10</div>
                                <div><strong>‰∏ãÊ¨°Áª¥Êä§Ôºö</strong>2024-09-10</div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂäüÁéáÊéßÂà∂ -->
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">‚ö°</span>ÂäüÁéáÊéßÂà∂
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ËÆæÁΩÆÂäüÁéáÁ∫ßÂà´Ôºö</label>
                                <input type="range" id="power-slider" min="0" max="100" value="75" 
                                       style="width: 100%; height: 8px; border-radius: 5px; background: #ddd; outline: none; -webkit-appearance: none;"
                                       oninput="updatePowerDisplay(this.value)">
                                <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666; margin-top: 5px;">
                                    <span>0%</span>
                                    <span>25%</span>
                                    <span>50%</span>
                                    <span>75%</span>
                                    <span>100%</span>
                                </div>
                            </div>
                            <div style="text-align: center; font-size: 18px; font-weight: 600; color: #333;">
                                ÂΩìÂâçÂäüÁéáÔºö<span id="power-value">75</span>%
                            </div>
                        </div>
                    </div>

                    <!-- ÊéßÂà∂ÊåâÈíÆ -->
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üéõÔ∏è</span>ËÆæÂ§áÊéßÂà∂
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                            <button onclick="controlDevice('${deviceName}', 'start')" style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#229954'" onmouseout="this.style.background='#27AE60'">
                                üöÄ ÂêØÂä®
                            </button>
                            <button onclick="controlDevice('${deviceName}', 'stop')" style="padding: 12px 20px; background: #E74C3C; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#C0392B'" onmouseout="this.style.background='#E74C3C'">
                                üõë ÂÅúÊ≠¢
                            </button>
                            <button onclick="controlDevice('${deviceName}', 'pause')" style="padding: 12px 20px; background: #F39C12; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#E67E22'" onmouseout="this.style.background='#F39C12'">
                                ‚è∏Ô∏è ÊöÇÂÅú
                            </button>
                            <button onclick="controlDevice('${deviceName}', 'reset')" style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#7D3C98'" onmouseout="this.style.background='#8E44AD'">
                                üîÑ ÈáçÁΩÆ
                            </button>
                        </div>
                    </div>

                    <!-- ËøêË°åÂèÇÊï∞ -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìä</span>ËøêË°åÂèÇÊï∞
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #3498DB;">2.3A</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">ÁîµÊµÅ</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #E74C3C;">220V</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">ÁîµÂéã</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #F39C12;">506W</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">ÂäüËÄó</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #27AE60;">42¬∞C</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">Ê∏©Â∫¶</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // ÊòæÁ§∫Âä®Áîª
            setTimeout(() => {
                modal.style.transform = 'scale(1)';
            }, 10);

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    closeDeviceModal();
                }
            });

            // ‰øùÂ≠òÂºπÊ°ÜÂºïÁî®‰ª•‰æøÂÖ≥Èó≠
            window.currentDeviceModal = overlay;
        }

        // ÂÖ≥Èó≠ËÆæÂ§áÊéßÂà∂ÂºπÊ°Ü
        function closeDeviceModal() {
            if (window.currentDeviceModal) {
                const modal = window.currentDeviceModal.querySelector('div');
                modal.style.transform = 'scale(0.9)';
                setTimeout(() => {
                    document.body.removeChild(window.currentDeviceModal);
                    window.currentDeviceModal = null;
                }, 300);
            }
        }

        // Ëé∑ÂèñËÆæÂ§áÁ±ªÂûã
        function getDeviceType(deviceName) {
            if (deviceName.includes('Âä†ÁÉ≠Âô®')) return 'Ê∏©Â∫¶ÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('ÂÜ∑Âç¥Âô®')) return 'Ê∏©Â∫¶ÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('Âä†ÊπøÂô®')) return 'ÊπøÂ∫¶ÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('È£éÊâá')) return 'ÈÄöÈ£éËÆæÂ§á';
            if (deviceName.includes('Ë°•ÂÖâÁÅØ') || deviceName.includes('ËÇ≤ËãóÁÅØ')) return 'ÂÖâÁÖßËÆæÂ§á';
            if (deviceName.includes('Ê∞¥Ê≥µ')) return 'ÁÅåÊ∫âËÆæÂ§á';
            if (deviceName.includes('ÈÄöÈ£é')) return 'ÈÄöÈ£éËÆæÂ§á';
            if (deviceName.includes('CO2')) return 'Ê∞î‰ΩìÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('Âñ∑Èõæ')) return 'ÊπøÂ∫¶ÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('ÈÅÆÈò≥')) return 'ÂÖâÁÖßÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('Êª¥ÁÅå')) return 'ÁÅåÊ∫âËÆæÂ§á';
            if (deviceName.includes('Ê∏©Êéß')) return 'Ê∏©Â∫¶ÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('Êï∞ÊçÆÈááÈõÜ')) return 'ÁõëÊµãËÆæÂ§á';
            if (deviceName.includes('ÁéØÂ¢ÉÊéßÂà∂')) return 'ÁªºÂêàÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('pH')) return 'Ê∞¥Ë¥®ÊéßÂà∂ËÆæÂ§á';
            if (deviceName.includes('Ëê•ÂÖªÊ∂≤')) return 'Ëê•ÂÖª‰æõÁªôËÆæÂ§á';
            return 'Êô∫ËÉΩËÆæÂ§á';
        }

        // Êõ¥Êñ∞ÂäüÁéáÊòæÁ§∫
        function updatePowerDisplay(value) {
            document.getElementById('power-value').textContent = value;
            document.getElementById('device-power-display').innerHTML = `ÂäüÁéáÔºö${value}%`;
        }

        // ËÆæÂ§áÊéßÂà∂Êìç‰Ωú
        function controlDevice(deviceName, action) {
            const actionMap = {
                'start': 'ÂêØÂä®',
                'stop': 'ÂÅúÊ≠¢',
                'pause': 'ÊöÇÂÅú',
                'reset': 'ÈáçÁΩÆ'
            };

            const actionText = actionMap[action] || action;
            const powerValue = document.getElementById('power-value').textContent;

            let message = `${deviceName} ${actionText}ÊàêÂäü`;
            if (action === 'start') {
                message += `ÔºåÂäüÁéáËÆæÁΩÆ‰∏∫ ${powerValue}%`;
            }

            UserFriendlyAlert.showSuccess(message);

            // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†ÂÆûÈôÖÁöÑAPIË∞ÉÁî®
            // ‰æãÂ¶ÇÔºöawait deviceControlAPI(deviceName, action, powerValue);
        }

        // Ëé∑ÂèñÁª¥Êä§Áä∂ÊÄÅÈ¢úËâ≤
        function getMaintenanceStatusColor(status) {
            const colorMap = {
                'Ê≠£Â∏∏': '#27AE60',
                'Âç≥Â∞ÜÂà∞Êúü': '#F39C12',
                'ÈúÄË¶ÅÁª¥Êä§': '#E67E22',
                'Â∑≤ËøáÊúü': '#E74C3C'
            };
            return colorMap[status] || '#95A5A6';
        }

        // Ëé∑ÂèñÁª¥Êä§Áä∂ÊÄÅÂõæÊ†á
        function getMaintenanceStatusIcon(status) {
            const iconMap = {
                'Ê≠£Â∏∏': '‚úÖ',
                'Âç≥Â∞ÜÂà∞Êúü': '‚ö†Ô∏è',
                'ÈúÄË¶ÅÁª¥Êä§': 'üîß',
                'Â∑≤ËøáÊúü': '‚ùå'
            };
            return iconMap[status] || 'üîß';
        }

        // ÊòæÁ§∫Áª¥Êä§ÁÆ°ÁêÜÂºπÊ°Ü
        function showMaintenanceModal(deviceName) {
            // Êü•ÊâæËÆæÂ§áÊï∞ÊçÆ
            const allDevices = [];
            Object.values(devicesByGreenhouse).forEach(devices => {
                allDevices.push(...devices);
            });
            const device = allDevices.find(d => d.name === deviceName);

            if (!device) {
                UserFriendlyAlert.showError('ËÆæÂ§á‰ø°ÊÅØÊú™ÊâæÂà∞');
                return;
            }

            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                backdrop-filter: blur(5px);
            `;

            // ÂàõÂª∫ÂºπÊ°Ü
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 20px;
                padding: 0;
                max-width: 700px;
                width: 90%;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                transform: scale(0.9);
                transition: transform 0.3s ease;
            `;

            const maintenanceStatusColor = getMaintenanceStatusColor(device.maintenanceStatus);
            const maintenanceIcon = getMaintenanceStatusIcon(device.maintenanceStatus);

            modal.innerHTML = `
                <!-- ÂºπÊ°ÜÂ§¥ÈÉ® -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 20px 20px 0 0; position: relative;">
                    <button onclick="closeMaintenanceModal()" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); border: none; color: white; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">√ó</button>
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 48px; margin-right: 20px;">${device.icon}</div>
                        <div>
                            <h2 style="margin: 0; font-size: 24px; font-weight: 700;">${device.name} - Áª¥Êä§ÁÆ°ÁêÜ</h2>
                            <div style="font-size: 16px; opacity: 0.9; margin-top: 5px;">ËÆæÂ§áËøêË°åÁä∂ÊÄÅÔºö${device.status}</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <span style="padding: 8px 16px; background: ${maintenanceStatusColor}; border-radius: 20px; font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 5px;">
                            ${maintenanceIcon} ${device.maintenanceStatus}
                        </span>
                        <span style="padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; font-weight: 600;">
                            ËøêË°åÊó∂Èó¥Ôºö${device.runningHours}Â∞èÊó∂
                        </span>
                        <span style="padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; font-weight: 600;">
                            ‰ΩøÁî®ÁéáÔºö${device.usageFrequency}%
                        </span>
                    </div>
                </div>

                <!-- ÂºπÊ°ÜÂÜÖÂÆπ -->
                <div style="padding: 30px;">
                    <!-- Áª¥Êä§ËÆ°Âàí -->
                    <div style="margin-bottom: 30px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìÖ</span>Áª¥Êä§ËÆ°Âàí
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div>
                                    <div style="font-size: 14px; color: #666; margin-bottom: 5px;">‰∏äÊ¨°Áª¥Êä§Êó∂Èó¥</div>
                                    <div style="font-size: 16px; font-weight: 600; color: #333;">${device.lastMaintenance}</div>
                                </div>
                                <div>
                                    <div style="font-size: 14px; color: #666; margin-bottom: 5px;">‰∏ãÊ¨°Áª¥Êä§Êó∂Èó¥</div>
                                    <div style="font-size: 16px; font-weight: 600; color: ${maintenanceStatusColor};">${device.nextMaintenance}</div>
                                </div>
                            </div>
                            <div style="background: white; border-radius: 8px; padding: 15px; border-left: 4px solid ${maintenanceStatusColor};">
                                <div style="font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px;">Áª¥Êä§ÊèêÈÜí</div>
                                <div style="font-size: 13px; color: #666; line-height: 1.5;">
                                    ${getMaintenanceReminder(device)}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ËÆ∞ÂΩï -->
                    <div style="margin-bottom: 30px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìã</span>Áª¥Êä§ËÆ∞ÂΩï
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            ${generateMaintenanceRecords(device.maintenanceRecords)}
                        </div>
                    </div>

                    <!-- Áª¥Êä§Êìç‰Ωú -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üîß</span>Áª¥Êä§Êìç‰Ωú
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                            <button onclick="scheduleMaintenance('${device.name}')" style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#2980B9'" onmouseout="this.style.background='#3498DB'">
                                üìÖ ÂÆâÊéíÁª¥Êä§
                            </button>
                            <button onclick="completeMaintenance('${device.name}')" style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#229954'" onmouseout="this.style.background='#27AE60'">
                                ‚úÖ ÂÆåÊàêÁª¥Êä§
                            </button>
                            <button onclick="postponeMaintenance('${device.name}')" style="padding: 12px 20px; background: #F39C12; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#E67E22'" onmouseout="this.style.background='#F39C12'">
                                ‚è∞ Âª∂ÊúüÁª¥Êä§
                            </button>
                            <button onclick="viewMaintenanceGuide('${device.name}')" style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#7D3C98'" onmouseout="this.style.background='#8E44AD'">
                                üìñ Áª¥Êä§ÊåáÂçó
                            </button>
                        </div>
                    </div>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // ÊòæÁ§∫Âä®Áîª
            setTimeout(() => {
                modal.style.transform = 'scale(1)';
            }, 10);

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    closeMaintenanceModal();
                }
            });

            // ‰øùÂ≠òÂºπÊ°ÜÂºïÁî®‰ª•‰æøÂÖ≥Èó≠
            window.currentMaintenanceModal = overlay;
        }

        // ÂÖ≥Èó≠Áª¥Êä§ÁÆ°ÁêÜÂºπÊ°Ü
        function closeMaintenanceModal() {
            if (window.currentMaintenanceModal) {
                const modal = window.currentMaintenanceModal.querySelector('div');
                modal.style.transform = 'scale(0.9)';
                setTimeout(() => {
                    document.body.removeChild(window.currentMaintenanceModal);
                    window.currentMaintenanceModal = null;
                }, 300);
            }
        }

        // Ëé∑ÂèñÁª¥Êä§ÊèêÈÜí‰ø°ÊÅØ
        function getMaintenanceReminder(device) {
            switch (device.maintenanceStatus) {
                case 'Ê≠£Â∏∏':
                    return `ËÆæÂ§áÁª¥Êä§Áä∂ÊÄÅËâØÂ•ΩÔºå‰∏ãÊ¨°Áª¥Êä§Êó∂Èó¥‰∏∫ ${device.nextMaintenance}„ÄÇÂª∫ËÆÆÂÆöÊúüÊ£ÄÊü•ËÆæÂ§áËøêË°åÁä∂ÊÄÅ„ÄÇ`;
                case 'Âç≥Â∞ÜÂà∞Êúü':
                    return `ËÆæÂ§áÁª¥Êä§Âç≥Â∞ÜÂà∞ÊúüÔºåËØ∑Âú® ${device.nextMaintenance} ÂâçÂÆâÊéíÁª¥Êä§Â∑•‰ΩúÔºåÈÅøÂÖçÂΩ±ÂìçËÆæÂ§áÊ≠£Â∏∏ËøêË°å„ÄÇ`;
                case 'ÈúÄË¶ÅÁª¥Êä§':
                    return `ËÆæÂ§áÈúÄË¶ÅËøõË°åÁª¥Êä§ÔºåÂª∫ËÆÆÂ∞ΩÂø´ÂÆâÊéí‰∏ì‰∏öÊäÄÊúØ‰∫∫ÂëòËøõË°åÊ£ÄÊü•Âíå‰øùÂÖªÔºåÁ°Æ‰øùËÆæÂ§áÁ®≥ÂÆöËøêË°å„ÄÇ`;
                case 'Â∑≤ËøáÊúü':
                    return `ËÆæÂ§áÁª¥Êä§Â∑≤ËøáÊúüÔºÅËØ∑Á´ãÂç≥ÂÆâÊéíÁª¥Êä§Â∑•‰ΩúÔºåÈïøÊúüÊú™Áª¥Êä§ÂèØËÉΩÂØºËá¥ËÆæÂ§áÊïÖÈöúÊàñÊÄßËÉΩ‰∏ãÈôç„ÄÇ`;
                default:
                    return 'ËØ∑ÂÆöÊúüÁª¥Êä§ËÆæÂ§á‰ª•Á°Æ‰øùÊ≠£Â∏∏ËøêË°å„ÄÇ';
            }
        }

        // ÁîüÊàêÁª¥Êä§ËÆ∞ÂΩïHTML
        function generateMaintenanceRecords(records) {
            if (!records || records.length === 0) {
                return '<div style="text-align: center; color: #666; padding: 20px;">ÊöÇÊó†Áª¥Êä§ËÆ∞ÂΩï</div>';
            }

            return records.map(record => `
                <div style="background: white; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 4px solid #3498DB;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="font-size: 14px; font-weight: 600; color: #333;">${record.type}</div>
                        <div style="font-size: 12px; color: #666;">${record.date}</div>
                    </div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px; line-height: 1.4;">${record.description}</div>
                    <div style="font-size: 12px; color: #3498DB;">Áª¥Êä§‰∫∫ÂëòÔºö${record.technician}</div>
                </div>
            `).join('');
        }

        // Áª¥Êä§Êìç‰ΩúÂáΩÊï∞
        function scheduleMaintenance(deviceName) {
            UserFriendlyAlert.showSuccess(`Â∑≤‰∏∫ ${deviceName} ÂÆâÊéíÁª¥Êä§ËÆ°Âàí`);
            closeMaintenanceModal();
        }

        function completeMaintenance(deviceName) {
            UserFriendlyAlert.showSuccess(`${deviceName} Áª¥Êä§Â∑≤ÂÆåÊàêÔºåÁª¥Êä§ËÆ∞ÂΩïÂ∑≤Êõ¥Êñ∞`);
            closeMaintenanceModal();
        }

        function postponeMaintenance(deviceName) {
            UserFriendlyAlert.showWarning(`${deviceName} Áª¥Êä§Â∑≤Âª∂ÊúüÔºåËØ∑Â∞ΩÂø´ÂÆâÊéíÁª¥Êä§Â∑•‰Ωú`);
            closeMaintenanceModal();
        }

        function viewMaintenanceGuide(deviceName) {
            UserFriendlyAlert.showInfo(`Ê≠£Âú®ÊâìÂºÄ ${deviceName} ÁöÑÁª¥Êä§ÊåáÂçó...`);
        }

        // Áª¥Êä§ÁÆ°ÁêÜÊ¶ÇËßàÂäüËÉΩ
        function showMaintenanceSchedule() {
            UserFriendlyAlert.showInfo('Ê≠£Âú®ÊâìÂºÄÁª¥Êä§ËÆ°ÂàíÁÆ°ÁêÜÁïåÈù¢...');
        }

        function exportMaintenanceReport() {
            UserFriendlyAlert.showSuccess('Áª¥Êä§Êä•ÂëäÂØºÂá∫ÊàêÂäü');
        }

        function showMaintenanceGuides() {
            UserFriendlyAlert.showInfo('Ê≠£Âú®ÊâìÂºÄËÆæÂ§áÁª¥Êä§ÊåáÂçóÂ∫ì...');
        }

        function scheduleMaintenanceReminder() {
            UserFriendlyAlert.showSuccess('Áª¥Êä§ÊèêÈÜíÂ∑≤ËÆæÁΩÆÔºåÁ≥ªÁªüÂ∞ÜÂú®Áª¥Êä§Âà∞ÊúüÂâçÈÄöÁü•ÊÇ®');
        }

        // ÁîüÊàêÁª¥Êä§ËÆ°ÂàíÂàóË°®
        function generateMaintenanceScheduleList() {
            const schedules = [
                { deviceName: 'Ë°•ÂÖâÁÅØA1', deviceIcon: 'üí°', scheduledDate: '2024-08-10', priority: 'È´ò', status: 'Â∑≤ËøáÊúü', description: 'Ê∏ÖÊ¥ÅÁÅØÂÖ∑ÔºåÊ£ÄÊü•LEDÊ®°Âùó' },
                { deviceName: 'Êï∞ÊçÆÈááÈõÜÂô®D1', deviceIcon: 'üìä', scheduledDate: '2024-08-01', priority: 'È´ò', status: 'Â∑≤ËøáÊúü', description: 'Ê†°ÂáÜ‰º†ÊÑüÂô®ÔºåÊõ¥Êñ∞Âõ∫‰ª∂' },
                { deviceName: 'È£éÊâáA1', deviceIcon: 'üå™Ô∏è', scheduledDate: '2024-08-14', priority: '‰∏≠', status: 'Âç≥Â∞ÜÂà∞Êúü', description: 'Ê∏ÖÊ¥ÅÂè∂ÁâáÔºåÊ∂¶ÊªëËΩ¥Êâø' },
                { deviceName: 'ÈÄöÈ£éÁ≥ªÁªüA1', deviceIcon: 'üå¨Ô∏è', scheduledDate: '2024-08-16', priority: '‰∏≠', status: 'Âç≥Â∞ÜÂà∞Êúü', description: 'Ê∏ÖÊ¥ÅÈÄöÈ£éÁÆ°ÈÅìÔºåÊ£ÄÊü•È£éÈó®' },
                { deviceName: 'È£éÊâáB1', deviceIcon: 'üå™Ô∏è', scheduledDate: '2024-08-18', priority: '‰∏≠', status: 'ËÆ°Âàí‰∏≠', description: 'Ê∏ÖÊ¥ÅÂè∂ÁâáÔºåÊ∂¶ÊªëËΩ¥Êâø' },
                { deviceName: 'Âä†ÁÉ≠Âô®A1', deviceIcon: 'üî•', scheduledDate: '2024-08-15', priority: 'È´ò', status: 'ÈúÄË¶ÅÁª¥Êä§', description: 'Ê∏ÖÊ¥ÅÂä†ÁÉ≠ÂÖÉ‰ª∂ÔºåÊ£ÄÊü•ÁîµË∑ØËøûÊé•' },
                { deviceName: 'ÂÜ∑Âç¥Âô®A1', deviceIcon: '‚ùÑÔ∏è', scheduledDate: '2024-09-01', priority: '‰Ωé', status: 'ËÆ°Âàí‰∏≠', description: 'Ê∏ÖÊ¥ÅÂÜ∑ÂáùÂô®ÔºåÊ£ÄÊü•Âà∂ÂÜ∑ÂâÇ' },
                { deviceName: 'Ê∞¥Ê≥µA1', deviceIcon: 'üö∞', scheduledDate: '2024-08-25', priority: '‰∏≠', status: 'ËÆ°Âàí‰∏≠', description: 'Ê£ÄÊü•Ê∞¥Ê≥µÂØÜÂ∞ÅÔºåÊ∏ÖÊ¥ÅËøáÊª§Âô®' }
            ];

            return schedules.map(schedule => {
                const priorityColor = schedule.priority === 'È´ò' ? '#E74C3C' : schedule.priority === '‰∏≠' ? '#F39C12' : '#27AE60';
                const statusColor = getMaintenanceStatusColor(schedule.status);

                return `
                <div style="background: white; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 4px solid ${priorityColor}; display: flex; align-items: center; justify-content: space-between; transition: all 0.3s;" onmouseover="this.style.boxShadow='0 4px 15px rgba(0,0,0,0.1)'" onmouseout="this.style.boxShadow='none'">
                    <div style="display: flex; align-items: center; flex: 1;">
                        <div style="font-size: 24px; margin-right: 15px;">${schedule.deviceIcon}</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #333; margin-bottom: 4px;">${schedule.deviceName}</div>
                            <div style="font-size: 13px; color: #666; margin-bottom: 4px;">${schedule.description}</div>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <span style="font-size: 12px; color: #666;">ËÆ°ÂàíÊó∂Èó¥Ôºö${schedule.scheduledDate}</span>
                                <span style="padding: 2px 8px; background: ${priorityColor}; color: white; border-radius: 10px; font-size: 10px; font-weight: 600;">${schedule.priority}‰ºòÂÖàÁ∫ß</span>
                                <span style="padding: 2px 8px; background: ${statusColor}; color: white; border-radius: 10px; font-size: 10px; font-weight: 600;">${schedule.status}</span>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button style="padding: 6px 12px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;" onclick="completePlannedMaintenance('${schedule.deviceName}')">ÂÆåÊàê</button>
                        <button style="padding: 6px 12px; background: #F39C12; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;" onclick="postponePlannedMaintenance('${schedule.deviceName}')">Âª∂Êúü</button>
                        <button style="padding: 6px 12px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;" onclick="editMaintenancePlan('${schedule.deviceName}')">ÁºñËæë</button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // ÁîüÊàêÁª¥Êä§ËÆ∞ÂΩïÂàóË°®
        function generateMaintenanceRecordsList() {
            const records = [
                { deviceName: 'Âä†ÁÉ≠Âô®A1', deviceIcon: 'üî•', date: '2024-07-15', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂä†ÁÉ≠ÂÖÉ‰ª∂ÔºåÊ£ÄÊü•ÁîµË∑ØËøûÊé•', technician: 'Âº†Â∏àÂÇÖ', result: 'Ê≠£Â∏∏', nextDate: '2024-08-15' },
                { deviceName: 'Ê∞¥Ê≥µA1', deviceIcon: 'üö∞', date: '2024-07-25', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê£ÄÊü•Ê∞¥Ê≥µÂØÜÂ∞ÅÔºåÊ∏ÖÊ¥ÅËøáÊª§Âô®', technician: 'Â≠ôÂ∏àÂÇÖ', result: 'Ê≠£Â∏∏', nextDate: '2024-08-25' },
                { deviceName: 'CO2ÂèëÁîüÂô®A1', deviceIcon: 'üí®', date: '2024-08-05', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê£ÄÊü•CO2ÊµìÂ∫¶‰º†ÊÑüÂô®ÔºåÊ∏ÖÊ¥ÅÂèëÁîüÂô®', technician: 'Âë®Â∏àÂÇÖ', result: 'Ê≠£Â∏∏', nextDate: '2024-09-05' },
                { deviceName: 'ÂÜ∑Âç¥Âô®A1', deviceIcon: '‚ùÑÔ∏è', date: '2024-08-01', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÂÜ∑ÂáùÂô®ÔºåÊ£ÄÊü•Âà∂ÂÜ∑ÂâÇ', technician: 'ÁéãÂ∏àÂÇÖ', result: 'Ê≠£Â∏∏', nextDate: '2024-09-01' },
                { deviceName: 'Âä†ÊπøÂô®A1', deviceIcon: 'üí®', date: '2024-07-20', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÊ∞¥ÁÆ±ÔºåÊõ¥Êç¢Êª§ËäØ', technician: 'ÈôàÂ∏àÂÇÖ', result: 'Ê≠£Â∏∏', nextDate: '2024-08-20' },
                { deviceName: 'È£éÊâáA1', deviceIcon: 'üå™Ô∏è', date: '2024-06-30', type: 'ÊïÖÈöúÁª¥‰øÆ', description: 'Êõ¥Êç¢ÁîµÊú∫ËΩ¥ÊâøÔºåÊ∏ÖÊ¥ÅÂè∂Áâá', technician: 'ÂàòÂ∏àÂÇÖ', result: 'Â∑≤‰øÆÂ§ç', nextDate: '2024-08-14' },
                { deviceName: 'ÈÄöÈ£éÁ≥ªÁªüA1', deviceIcon: 'üå¨Ô∏è', date: '2024-07-05', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÈÄöÈ£éÁÆ°ÈÅìÔºåÊ£ÄÊü•È£éÈó®', technician: 'È©¨Â∏àÂÇÖ', result: 'Ê≠£Â∏∏', nextDate: '2024-08-16' },
                { deviceName: 'Ë°•ÂÖâÁÅØA1', deviceIcon: 'üí°', date: '2024-05-10', type: 'ÂÆöÊúü‰øùÂÖª', description: 'Ê∏ÖÊ¥ÅÁÅØÂÖ∑ÔºåÊ£ÄÊü•LEDÊ®°Âùó', technician: 'ËµµÂ∏àÂÇÖ', result: 'ÈúÄË¶ÅÊõ¥Êç¢', nextDate: '2024-08-10' }
            ];

            return records.map(record => {
                const typeColor = record.type === 'ÊïÖÈöúÁª¥‰øÆ' ? '#E74C3C' : '#3498DB';
                const resultColor = record.result === 'Ê≠£Â∏∏' ? '#27AE60' : record.result === 'Â∑≤‰øÆÂ§ç' ? '#3498DB' : '#F39C12';

                return `
                <div style="background: white; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 4px solid ${typeColor}; transition: all 0.3s;" onmouseover="this.style.boxShadow='0 4px 15px rgba(0,0,0,0.1)'" onmouseout="this.style.boxShadow='none'">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 20px; margin-right: 12px;">${record.deviceIcon}</div>
                            <div>
                                <div style="font-size: 16px; font-weight: 600; color: #333;">${record.deviceName}</div>
                                <div style="font-size: 12px; color: #666;">${record.date} | Áª¥Êä§‰∫∫ÂëòÔºö${record.technician}</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <span style="padding: 4px 10px; background: ${typeColor}; color: white; border-radius: 12px; font-size: 11px; font-weight: 600;">${record.type}</span>
                            <span style="padding: 4px 10px; background: ${resultColor}; color: white; border-radius: 12px; font-size: 11px; font-weight: 600;">${record.result}</span>
                        </div>
                    </div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px; line-height: 1.4;">${record.description}</div>
                    <div style="font-size: 12px; color: #3498DB;">‰∏ãÊ¨°Áª¥Êä§Êó∂Èó¥Ôºö${record.nextDate}</div>
                </div>
                `;
            }).join('');
        }

        // Áª¥Êä§ÁÆ°ÁêÜÂäüËÉΩÂáΩÊï∞
        function showMaintenanceScheduleList() {
            const scheduleSection = document.getElementById('maintenanceScheduleSection');
            const recordsSection = document.getElementById('maintenanceRecordsSection');

            scheduleSection.style.display = 'block';
            recordsSection.style.display = 'none';

            UserFriendlyAlert.showInfo('Ê≠£Âú®ÊòæÁ§∫Áª¥Êä§ËÆ°ÂàíÂàóË°®');
        }

        function showMaintenanceRecordsList() {
            const scheduleSection = document.getElementById('maintenanceScheduleSection');
            const recordsSection = document.getElementById('maintenanceRecordsSection');

            scheduleSection.style.display = 'none';
            recordsSection.style.display = 'block';

            UserFriendlyAlert.showInfo('Ê≠£Âú®ÊòæÁ§∫Áª¥Êä§ËÆ∞ÂΩïÂàóË°®');
        }



        function completePlannedMaintenance(deviceName) {
            UserFriendlyAlert.showSuccess(`${deviceName} ÁöÑÁª¥Êä§ËÆ°ÂàíÂ∑≤ÂÆåÊàêÔºåÁª¥Êä§ËÆ∞ÂΩïÂ∑≤Êõ¥Êñ∞`);
            refreshMaintenanceData();
        }

        function postponePlannedMaintenance(deviceName) {
            UserFriendlyAlert.showWarning(`${deviceName} ÁöÑÁª¥Êä§ËÆ°ÂàíÂ∑≤Âª∂ÊúüÔºåËØ∑Â∞ΩÂø´ÂÆâÊéíÁª¥Êä§Â∑•‰Ωú`);
            refreshMaintenanceData();
        }

        function editMaintenancePlan(deviceName) {
            UserFriendlyAlert.showInfo(`Ê≠£Âú®ÁºñËæë ${deviceName} ÁöÑÁª¥Êä§ËÆ°Âàí...`);
        }

        function refreshMaintenanceData() {
            // Âà∑Êñ∞Áª¥Êä§ËÆ°ÂàíÂíåËÆ∞ÂΩïÂàóË°®
            const scheduleList = document.getElementById('maintenanceScheduleList');
            const recordsList = document.getElementById('maintenanceRecordsList');

            if (scheduleList) {
                scheduleList.innerHTML = generateMaintenanceScheduleList();
            }
            if (recordsList) {
                recordsList.innerHTML = generateMaintenanceRecordsList();
            }
        }

        // Êõ¥Êñ∞ËÆæÂ§áÊéßÂà∂ÂºπÊ°Ü‰ª•ÂåÖÂê´Áª¥Êä§‰ø°ÊÅØ
        function showDeviceControlModal(deviceName, deviceIcon, deviceStatus, deviceColor, deviceData) {
            let device;
            try {
                device = deviceData ? JSON.parse(deviceData.replace(/&quot;/g, '"')) : null;
            } catch (e) {
                // Â¶ÇÊûúËß£ÊûêÂ§±Ë¥•ÔºåÊü•ÊâæËÆæÂ§áÊï∞ÊçÆ
                const allDevices = [];
                Object.values(devicesByGreenhouse).forEach(devices => {
                    allDevices.push(...devices);
                });
                device = allDevices.find(d => d.name === deviceName);
            }

            if (!device) {
                // ÂàõÂª∫Âü∫Êú¨ËÆæÂ§áÂØπË±°
                device = {
                    name: deviceName,
                    icon: deviceIcon,
                    status: deviceStatus,
                    color: deviceColor,
                    runningHours: 0,
                    usageFrequency: 0,
                    lastMaintenance: 'Êú™Áü•',
                    nextMaintenance: 'Êú™ËÆæÁΩÆ',
                    maintenanceStatus: 'Êú™Áü•'
                };
            }

            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                backdrop-filter: blur(5px);
            `;

            // Ëé∑ÂèñËÆæÂ§áÁ±ªÂûã
            const deviceType = getDeviceType(deviceName);
            const deviceId = deviceName.replace(/\s+/g, '-').toLowerCase();
            const maintenanceStatusColor = getMaintenanceStatusColor(device.maintenanceStatus);

            // ÂàõÂª∫ÂºπÊ°Ü
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 20px;
                padding: 0;
                max-width: 600px;
                width: 90%;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                transform: scale(0.9);
                transition: transform 0.3s ease;
            `;

            modal.innerHTML = `
                <!-- ÂºπÊ°ÜÂ§¥ÈÉ® -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 20px 20px 0 0; position: relative;">
                    <button onclick="closeDeviceModal()" style="position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); border: none; color: white; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">√ó</button>
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 48px; margin-right: 20px;">${device.icon}</div>
                        <div>
                            <h2 style="margin: 0; font-size: 24px; font-weight: 700;">${device.name}</h2>
                            <div style="font-size: 16px; opacity: 0.9; margin-top: 5px;">ËÆæÂ§áÁ±ªÂûãÔºö${deviceType}</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                        <span style="padding: 6px 12px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; font-weight: 600;">
                            Áä∂ÊÄÅÔºö<span style="color: ${device.color};">${device.status}</span>
                        </span>
                        <span id="device-power-display" style="padding: 6px 12px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; font-weight: 600;">
                            ÂäüÁéáÔºö75%
                        </span>
                        <span style="padding: 6px 12px; background: ${maintenanceStatusColor}; border-radius: 20px; font-size: 14px; font-weight: 600;">
                            Áª¥Êä§Ôºö${device.maintenanceStatus}
                        </span>
                    </div>
                </div>

                <!-- ÂºπÊ°ÜÂÜÖÂÆπ -->
                <div style="padding: 30px;">
                    <!-- ËÆæÂ§á‰ø°ÊÅØ -->
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìã</span>ËÆæÂ§á‰ø°ÊÅØ
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 14px;">
                                <div><strong>ËÆæÂ§áIDÔºö</strong>${deviceId}</div>
                                <div><strong>ËÆæÂ§áÁ±ªÂûãÔºö</strong>${deviceType}</div>
                                <div><strong>ÂΩìÂâçÁä∂ÊÄÅÔºö</strong><span style="color: ${device.color}; font-weight: 600;">${device.status}</span></div>
                                <div><strong>ËøêË°åÊó∂Èó¥Ôºö</strong>${device.runningHours}Â∞èÊó∂</div>
                                <div><strong>‰ΩøÁî®È¢ëÁéáÔºö</strong>${device.usageFrequency}%</div>
                                <div><strong>Áª¥Êä§Áä∂ÊÄÅÔºö</strong><span style="color: ${maintenanceStatusColor}; font-weight: 600;">${device.maintenanceStatus}</span></div>
                                <div><strong>‰∏äÊ¨°Áª¥Êä§Ôºö</strong>${device.lastMaintenance}</div>
                                <div><strong>‰∏ãÊ¨°Áª¥Êä§Ôºö</strong>${device.nextMaintenance}</div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂäüÁéáÊéßÂà∂ -->
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">‚ö°</span>ÂäüÁéáÊéßÂà∂
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ËÆæÁΩÆÂäüÁéáÁ∫ßÂà´Ôºö</label>
                                <input type="range" id="power-slider" min="0" max="100" value="75" 
                                       style="width: 100%; height: 8px; border-radius: 5px; background: #ddd; outline: none; -webkit-appearance: none;"
                                       oninput="updatePowerDisplay(this.value)">
                                <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666; margin-top: 5px;">
                                    <span>0%</span>
                                    <span>25%</span>
                                    <span>50%</span>
                                    <span>75%</span>
                                    <span>100%</span>
                                </div>
                            </div>
                            <div style="text-align: center; font-size: 18px; font-weight: 600; color: #333;">
                                ÂΩìÂâçÂäüÁéáÔºö<span id="power-value">75</span>%
                            </div>
                        </div>
                    </div>

                    <!-- ÊéßÂà∂ÊåâÈíÆ -->
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üéõÔ∏è</span>ËÆæÂ§áÊéßÂà∂
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                            <button onclick="controlDevice('${device.name}', 'start')" style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#229954'" onmouseout="this.style.background='#27AE60'">
                                üöÄ ÂêØÂä®
                            </button>
                            <button onclick="controlDevice('${device.name}', 'stop')" style="padding: 12px 20px; background: #E74C3C; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#C0392B'" onmouseout="this.style.background='#E74C3C'">
                                üõë ÂÅúÊ≠¢
                            </button>
                            <button onclick="controlDevice('${device.name}', 'pause')" style="padding: 12px 20px; background: #F39C12; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#E67E22'" onmouseout="this.style.background='#F39C12'">
                                ‚è∏Ô∏è ÊöÇÂÅú
                            </button>
                            <button onclick="controlDevice('${device.name}', 'reset')" style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#7D3C98'" onmouseout="this.style.background='#8E44AD'">
                                üîÑ ÈáçÁΩÆ
                            </button>
                            <button onclick="closeDeviceModal(); showMaintenanceModal('${device.name}')" style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#2980B9'" onmouseout="this.style.background='#3498DB'">
                                üîß Áª¥Êä§
                            </button>
                        </div>
                    </div>

                    <!-- ËøêË°åÂèÇÊï∞ -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìä</span>ËøêË°åÂèÇÊï∞
                        </h3>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #3498DB;">2.3A</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">ÁîµÊµÅ</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #E74C3C;">220V</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">ÁîµÂéã</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #F39C12;">506W</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">ÂäüËÄó</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                    <div style="font-size: 20px; font-weight: bold; color: #27AE60;">42¬∞C</div>
                                    <div style="font-size: 12px; color: #666; margin-top: 5px;">Ê∏©Â∫¶</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // ÊòæÁ§∫Âä®Áîª
            setTimeout(() => {
                modal.style.transform = 'scale(1)';
            }, 10);

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    closeDeviceModal();
                }
            });

            // ‰øùÂ≠òÂºπÊ°ÜÂºïÁî®‰ª•‰æøÂÖ≥Èó≠
            window.currentDeviceModal = overlay;
        }

        // ÁîüÊàê‰ªªÂä°ÂàóË°®HTML
        function generateTaskListHTML() {
            const tasks = [
                {
                    id: 'env-data-generation',
                    name: 'ÁéØÂ¢ÉÊï∞ÊçÆÁîüÊàê',
                    icon: 'üå°Ô∏è',
                    status: 'running',
                    frequency: 'ÊØè30Áßí',
                    lastExecution: '25ÁßíÂâç',
                    nextExecution: '2024-01-08 13:20:15',
                    executionCount: 156,
                    description: 'Ëá™Âä®ÈááÈõÜÊ∏©ÂÆ§ÁéØÂ¢ÉÊï∞ÊçÆ'
                },
                {
                    id: 'device-status-update',
                    name: 'ËÆæÂ§áÁä∂ÊÄÅÊõ¥Êñ∞',
                    icon: '‚öôÔ∏è',
                    status: 'running',
                    frequency: 'ÊØè1ÂàÜÈíü',
                    lastExecution: '45ÁßíÂâç',
                    nextExecution: '2024-01-08 13:21:30',
                    executionCount: 89,
                    description: 'Êõ¥Êñ∞ÊâÄÊúâËÆæÂ§áËøêË°åÁä∂ÊÄÅ'
                },
                {
                    id: 'alert-detection',
                    name: 'Êä•Ë≠¶Ê£ÄÊµã',
                    icon: 'üö®',
                    status: 'running',
                    frequency: 'ÊØè1ÂàÜÈíü',
                    lastExecution: '30ÁßíÂâç',
                    nextExecution: '2024-01-08 13:21:45',
                    executionCount: 234,
                    description: 'Ê£ÄÊµãÁéØÂ¢ÉÂºÇÂ∏∏Âπ∂ÁîüÊàêÊä•Ë≠¶'
                },
                {
                    id: 'automatic-control',
                    name: 'Ëá™Âä®ÂåñÊéßÂà∂',
                    icon: 'ü§ñ',
                    status: 'running',
                    frequency: 'ÊØè2ÂàÜÈíü',
                    lastExecution: '1ÂàÜÈíüÂâç',
                    nextExecution: '2024-01-08 13:22:10',
                    executionCount: 67,
                    description: 'Ê†πÊçÆÁéØÂ¢ÉÊï∞ÊçÆËá™Âä®ÊéßÂà∂ËÆæÂ§á'
                },
                {
                    id: 'device-fault-detection',
                    name: 'ËÆæÂ§áÊïÖÈöúÊ£ÄÊµã',
                    icon: 'üîß',
                    status: 'running',
                    frequency: 'ÊØè5ÂàÜÈíü',
                    lastExecution: '3ÂàÜÈíüÂâç',
                    nextExecution: '2024-01-08 13:25:00',
                    executionCount: 23,
                    description: 'Ê£ÄÊµãËÆæÂ§áÊïÖÈöúÂíåÂºÇÂ∏∏Áä∂ÊÄÅ'
                },
                {
                    id: 'data-backup',
                    name: 'Êï∞ÊçÆÂ§á‰ªΩ',
                    icon: 'üíæ',
                    status: 'paused',
                    frequency: 'ÊØèÂ∞èÊó∂',
                    lastExecution: '1Â∞èÊó∂Ââç',
                    nextExecution: '2024-01-08 14:20:00',
                    executionCount: 12,
                    description: 'ÂÆöÊúüÂ§á‰ªΩÁ≥ªÁªüÈáçË¶ÅÊï∞ÊçÆ'
                }
            ];

            return tasks.map(task => {
                const statusClass = task.status === 'running' ? 'status-running' :
                    task.status === 'paused' ? 'status-paused' : 'status-stopped';
                const statusText = task.status === 'running' ? 'ËøêË°å‰∏≠' :
                    task.status === 'paused' ? 'Â∑≤ÊöÇÂÅú' : 'Â∑≤ÂÅúÊ≠¢';

                const actions = task.status === 'running' ?
                    `<button style="padding: 4px 8px; background: #F39C12; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="pauseTask('${task.id}')">ÊöÇÂÅú</button>
                     <button style="padding: 4px 8px; background: #E74C3C; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="stopTask('${task.id}')">ÂÅúÊ≠¢</button>
                     <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="triggerTask('${task.id}')">Ëß¶Âèë</button>` :
                    task.status === 'paused' ?
                        `<button style="padding: 4px 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="resumeTask('${task.id}')">ÊÅ¢Â§ç</button>
                     <button style="padding: 4px 8px; background: #E74C3C; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="stopTask('${task.id}')">ÂÅúÊ≠¢</button>
                     <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="triggerTask('${task.id}')">Ëß¶Âèë</button>` :
                        `<button style="padding: 4px 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="startTask('${task.id}')">ÂêØÂä®</button>
                     <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="triggerTask('${task.id}')">Ëß¶Âèë</button>`;

                return `
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1.5fr 1.5fr 1.5fr 1fr 1.5fr; border-bottom: 1px solid rgba(0, 0, 0, 0.1); transition: all 0.3s ease; background: white;" 
                         onmouseover="this.style.background='rgba(52, 73, 94, 0.05)'; this.style.transform='translateX(2px)'" 
                         onmouseout="this.style.background='white'; this.style.transform='translateX(0)'">
                        <div style="padding: 15px 12px; text-align: left; display: flex; align-items: center; font-size: 13px; font-weight: 600; color: #333;">
                            <span style="margin-right: 8px; font-size: 16px;">${task.icon}</span>
                            <div>
                                <div style="font-weight: 600;">${task.name}</div>
                                <div style="font-size: 11px; color: #666; margin-top: 2px;">${task.description}</div>
                            </div>
                        </div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 13px;">
                            <span style="padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; 
                                         background: ${task.status === 'running' ? 'rgba(39, 174, 96, 0.2)' : task.status === 'paused' ? 'rgba(243, 156, 18, 0.2)' : 'rgba(231, 76, 60, 0.2)'};
                                         color: ${task.status === 'running' ? '#27AE60' : task.status === 'paused' ? '#F39C12' : '#E74C3C'};
                                         border: 1px solid ${task.status === 'running' ? 'rgba(39, 174, 96, 0.3)' : task.status === 'paused' ? 'rgba(243, 156, 18, 0.3)' : 'rgba(231, 76, 60, 0.3)'};">
                                ${statusText}
                            </span>
                        </div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; font-family: 'Consolas', 'Monaco', monospace; color: #666;">${task.frequency}</div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 11px; font-family: 'Consolas', 'Monaco', monospace; color: #666;">${task.lastExecution}</div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 11px; font-family: 'Consolas', 'Monaco', monospace; color: #666;">${task.nextExecution}</div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; color: #3498DB;">${task.executionCount}</div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 5px;">
                            ${actions}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ÂÆöÊó∂‰ªªÂä°Áõ∏ÂÖ≥ÂáΩÊï∞
        function startAllTasks() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('tasks_start_all'));
        }

        function stopAllTasks() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('tasks_stop_all'));
        }

        function refreshTaskStatus() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('tasks_refresh'));
        }

        function triggerAllTasks() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('tasks_trigger_all'));
        }

        // Âçï‰∏™‰ªªÂä°ÊéßÂà∂ÂáΩÊï∞
        function startTask(taskId) {
            UserFriendlyAlert.showSuccess(`‰ªªÂä° ${taskId} Â∑≤ÂêØÂä®`);
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÁöÑAPIË∞ÉÁî®
        }

        function stopTask(taskId) {
            UserFriendlyAlert.showInfo(`‰ªªÂä° ${taskId} Â∑≤ÂÅúÊ≠¢`);
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÁöÑAPIË∞ÉÁî®
        }

        function pauseTask(taskId) {
            UserFriendlyAlert.showInfo(`‰ªªÂä° ${taskId} Â∑≤ÊöÇÂÅú`);
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÁöÑAPIË∞ÉÁî®
        }

        function resumeTask(taskId) {
            UserFriendlyAlert.showSuccess(`‰ªªÂä° ${taskId} Â∑≤ÊÅ¢Â§çËøêË°å`);
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÁöÑAPIË∞ÉÁî®
        }

        function triggerTask(taskId) {
            UserFriendlyAlert.showSuccess(`‰ªªÂä° ${taskId} ÊâãÂä®ÊâßË°åÂÆåÊàê`);
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÁöÑAPIË∞ÉÁî®
        }

        // Êï∞ÊçÆÂàÜÊûêÁõ∏ÂÖ≥ÂáΩÊï∞
        function generateReport() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('report_generated'));
        }

        function exportAnalytics() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('analytics_exported'));
        }

        function refreshAnalytics() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('analytics_refreshed'));
        }

        // Êä•Ë°®‰∏≠ÂøÉÁõ∏ÂÖ≥ÂáΩÊï∞
        function generateDailyReport() {
            UserFriendlyAlert.showSuccess('ÁéØÂ¢ÉÊï∞ÊçÆÊó•Êä•ÁîüÊàêÊàêÂäü');
        }

        function exportDailyReport() {
            UserFriendlyAlert.showSuccess('ÁéØÂ¢ÉÊï∞ÊçÆÊó•Êä•ÂØºÂá∫ÊàêÂäü');
        }

        function generateDeviceReport() {
            UserFriendlyAlert.showSuccess('ËÆæÂ§áËøêË°åÊä•ÂëäÁîüÊàêÊàêÂäü');
        }

        function exportDeviceReport() {
            UserFriendlyAlert.showSuccess('ËÆæÂ§áËøêË°åÊä•ÂëäÂØºÂá∫ÊàêÂäü');
        }

        function generateMonthlyReport() {
            UserFriendlyAlert.showSuccess('ÊúàÂ∫¶ÂàÜÊûêÊä•ÂëäÁîüÊàêÊàêÂäü');
        }

        function exportMonthlyReport() {
            UserFriendlyAlert.showSuccess('ÊúàÂ∫¶ÂàÜÊûêÊä•ÂëäÂØºÂá∫ÊàêÂäü');
        }

        function generateAlertReport() {
            UserFriendlyAlert.showSuccess('Êä•Ë≠¶ÁªüËÆ°Êä•ÂëäÁîüÊàêÊàêÂäü');
        }

        function exportAlertReport() {
            UserFriendlyAlert.showSuccess('Êä•Ë≠¶ÁªüËÆ°Êä•ÂëäÂØºÂá∫ÊàêÂäü');
        }

        function generateComprehensiveReport() {
            UserFriendlyAlert.showSuccess('ÁªºÂêàÊä•ÂëäÁîüÊàêÊàêÂäü');
        }

        function exportAllData() {
            UserFriendlyAlert.showSuccess('ÂÖ®ÈÉ®Êï∞ÊçÆÂØºÂá∫ÊàêÂäü');
        }

        function refreshAllAnalytics() {
            UserFriendlyAlert.showSuccess('ÂÖ®ÈÉ®Êï∞ÊçÆÂ∑≤Âà∑Êñ∞');
        }

        function scheduleReport() {
            UserFriendlyAlert.showSuccess('ÂÆöÊó∂Êä•ÂëäËÆæÁΩÆÂ∑≤‰øùÂ≠ò');
        }

        // ÁîüÊàêÁî®Êà∑Ë°®Ê†ºË°å
        function generateUserTableRows() {
            const users = [
                { id: 1, name: 'ÈôàÂøóÂº∫', email: 'chenzhiqiang@yuancho.com', role: 'ÁÆ°ÁêÜÂëò', status: 'Âú®Á∫ø', lastLogin: '2024-01-15 14:30', avatar: 'üë®‚Äçüíº' },
                { id: 2, name: 'ÊùéÁæéÂçé', email: 'limeihua@yuancho.com', role: 'ÊôÆÈÄöÁî®Êà∑', status: 'Á¶ªÁ∫ø', lastLogin: '2024-01-15 10:20', avatar: 'üë©‚Äçüíª' },
                { id: 3, name: 'ÁéãÂª∫ÂõΩ', email: 'wangjianguo@yuancho.com', role: 'ÁÆ°ÁêÜÂëò', status: 'Âú®Á∫ø', lastLogin: '2024-01-15 15:45', avatar: 'üë®‚Äçüîß' },
                { id: 4, name: 'ÂàòÊôìÊïè', email: 'liuxiaomin@yuancho.com', role: 'ÊôÆÈÄöÁî®Êà∑', status: 'Âú®Á∫ø', lastLogin: '2024-01-15 16:10', avatar: 'üë©‚Äçüåæ' },
                { id: 5, name: 'Âº†Ê∞∏Ëæâ', email: 'zhangyonghui@yuancho.com', role: 'ÊôÆÈÄöÁî®Êà∑', status: 'Á¶ªÁ∫ø', lastLogin: '2024-01-14 18:30', avatar: 'üë®‚Äçüéì' },
                { id: 6, name: 'Ëµµ‰∏ΩÂ®ü', email: 'zhaolijuan@yuancho.com', role: 'ÊôÆÈÄöÁî®Êà∑', status: 'Âú®Á∫ø', lastLogin: '2024-01-15 17:20', avatar: 'üë©‚Äçüíº' },
                { id: 7, name: 'Â≠ôÂæ∑Âçé', email: 'sundehua@yuancho.com', role: 'ÁÆ°ÁêÜÂëò', status: 'Âú®Á∫ø', lastLogin: '2024-01-15 16:45', avatar: 'üë®‚Äçüåæ' }
            ];

            return users.map(user => `
                <tr style="border-bottom: 1px solid #e0e0e0; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f8f9fa'" onmouseout="this.style.backgroundColor='white'">
                    <td style="padding: 15px;">
                        <div style="display: flex; align-items: center;">
                            <input type="checkbox" style="margin-right: 12px;" value="${user.id}">
                            <div style="font-size: 24px; margin-right: 12px;">${user.avatar}</div>
                            <div>
                                <div style="font-weight: 600; color: #333; margin-bottom: 2px;">${user.name}</div>
                                <div style="color: #666; font-size: 12px;">${user.email}</div>
                            </div>
                        </div>
                    </td>
                    <td style="padding: 15px;">
                        <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; ${user.role === 'ÁÆ°ÁêÜÂëò' ? 'background: #e3f2fd; color: #1976d2;' : 'background: #f3e5f5; color: #7b1fa2;'}">${user.role}</span>
                    </td>
                    <td style="padding: 15px;">
                        <span style="display: flex; align-items: center; font-size: 14px;">
                            <span style="width: 8px; height: 8px; border-radius: 50%; margin-right: 8px; ${user.status === 'Âú®Á∫ø' ? 'background: #4caf50;' : 'background: #f44336;'}"></span>
                            ${user.status}
                        </span>
                    </td>
                    <td style="padding: 15px; color: #666; font-size: 14px;">${user.lastLogin}</td>
                    <td style="padding: 15px; text-align: center;">
                        <div style="display: flex; gap: 8px; justify-content: center;">
                            <button style="padding: 6px 12px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;" onclick="editUser(${user.id})">ÁºñËæë</button>
                            <button style="padding: 6px 12px; background: #FF9800; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;" onclick="resetPassword(${user.id})">ÈáçÁΩÆÂØÜÁ†Å</button>
                            <button style="padding: 6px 12px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;" onclick="deleteUser(${user.id})">Âà†Èô§</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // Áî®Êà∑ÁÆ°ÁêÜÁõ∏ÂÖ≥ÂáΩÊï∞
        function addNewUser() {
            UserFriendlyAlert.showSuccess('Êñ∞Áî®Êà∑Ê∑ªÂä†ÊàêÂäü');
        }

        function batchManageUsers() {
            UserFriendlyAlert.showSuccess('ÊâπÈáèÁÆ°ÁêÜÊìç‰ΩúÂÆåÊàê');
        }

        function exportUserList() {
            UserFriendlyAlert.showSuccess('Áî®Êà∑ÂàóË°®ÂØºÂá∫ÊàêÂäü');
        }

        function userPermissionSettings() {
            UserFriendlyAlert.showSuccess('ÊùÉÈôêËÆæÁΩÆÂ∑≤Êõ¥Êñ∞');
        }

        function refreshUserList() {
            UserFriendlyAlert.showSuccess('Áî®Êà∑ÂàóË°®Â∑≤Âà∑Êñ∞');
        }

        function searchUsers() {
            const searchInput = document.getElementById('userSearchInput');
            if (searchInput && searchInput.value.trim()) {
                UserFriendlyAlert.showSuccess(`ÊêúÁ¥¢Áî®Êà∑Ôºö${searchInput.value}`);
            } else {
                UserFriendlyAlert.showWarning('ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç');
            }
        }

        function toggleAllUsers(checkbox) {
            const checkboxes = document.querySelectorAll('#userTableBody input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = checkbox.checked);
            UserFriendlyAlert.showInfo(checkbox.checked ? 'Â∑≤ÈÄâÊã©ÂÖ®ÈÉ®Áî®Êà∑' : 'Â∑≤ÂèñÊ∂àÂÖ®ÈÉ®ÈÄâÊã©');
        }

        function editUser(userId) {
            UserFriendlyAlert.showSuccess(`Áî®Êà∑‰ø°ÊÅØÁºñËæëÂÆåÊàê`);
        }

        function resetPassword(userId) {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÈáçÁΩÆÂΩìÂâçÁî®Êà∑ÁöÑÂØÜÁ†ÅÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess(`ÂØÜÁ†ÅÈáçÁΩÆÊàêÂäüÔºåÊñ∞ÂØÜÁ†ÅÂ∑≤ÂèëÈÄÅËá≥Áî®Êà∑ÈÇÆÁÆ±`);
                },
                function () {
                    // Áî®Êà∑ÂèñÊ∂àÔºå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                }
            );
        }

        function deleteUser(userId) {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Áî®Êà∑ÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess(`Áî®Êà∑Âà†Èô§ÊàêÂäü`);
                },
                function () {
                    // Áî®Êà∑ÂèñÊ∂àÔºå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                }
            );
        }

        // Êä•Ë≠¶ÁÆ°ÁêÜÊìç‰ΩúÂáΩÊï∞
        function handleAlert(alertId, action) {
            UserFriendlyAlert.showSuccess(`Êä•Ë≠¶ #${alertId} Â∑≤Ê†áËÆ∞‰∏∫Â∑≤Â§ÑÁêÜ`);
            // Âà∑Êñ∞Êä•Ë≠¶ÂàóË°®
            setTimeout(() => {
                if (currentPage === 'alerts') {
                    loadPageContent('alerts');
                }
            }, 1000);
        }

        function viewAlertDetails(alertId) {
            UserFriendlyAlert.showInfo(`Ê≠£Âú®Êü•ÁúãÊä•Ë≠¶ #${alertId} ÁöÑËØ¶ÁªÜ‰ø°ÊÅØ...`);
            // ËøôÈáåÂèØ‰ª•ÊâìÂºÄËØ¶ÊÉÖÂºπÁ™óÊàñË∑≥ËΩ¨Âà∞ËØ¶ÊÉÖÈ°µÈù¢
        }

        function assignAlert(alertId) {
            showCustomPrompt('ËØ∑ËæìÂÖ•Â§ÑÁêÜ‰∫∫ÂëòÂßìÂêçÔºö', function (assignee) {
                if (assignee && assignee.trim()) {
                    UserFriendlyAlert.showSuccess(`Êä•Ë≠¶ #${alertId} Â∑≤ÂàÜÈÖçÁªô ${assignee} Â§ÑÁêÜ`);
                } else {
                    UserFriendlyAlert.showWarning('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÂ§ÑÁêÜ‰∫∫ÂëòÂßìÂêç');
                }
            });
        }

        // Ëá™ÂÆö‰πâËæìÂÖ•ÂØπËØùÊ°Ü
        function showCustomPrompt(message, onConfirm, onCancel) {
            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
            `;

            // ÂàõÂª∫ÂØπËØùÊ°Ü
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                background: white;
                border-radius: 12px;
                padding: 30px;
                max-width: 400px;
                width: 90%;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                text-align: center;
            `;

            dialog.innerHTML = `
                <div style="font-size: 18px; color: #333; margin-bottom: 20px; line-height: 1.5;">${message}</div>
                <input type="text" id="prompt-input" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; margin-bottom: 20px;" placeholder="ËØ∑ËæìÂÖ•...">
                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button id="prompt-confirm-btn" style="padding: 12px 24px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600;">Á°ÆÂÆö</button>
                    <button id="prompt-cancel-btn" style="padding: 12px 24px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600;">ÂèñÊ∂à</button>
                </div>
            `;

            overlay.appendChild(dialog);
            document.body.appendChild(overlay);

            const input = dialog.querySelector('#prompt-input');
            const confirmBtn = dialog.querySelector('#prompt-confirm-btn');
            const cancelBtn = dialog.querySelector('#prompt-cancel-btn');

            // Ëá™Âä®ËÅöÁÑ¶ËæìÂÖ•Ê°Ü
            setTimeout(() => input.focus(), 100);

            // ÁªëÂÆö‰∫ã‰ª∂
            confirmBtn.addEventListener('click', () => {
                const value = input.value;
                document.body.removeChild(overlay);
                if (onConfirm) onConfirm(value);
            });

            cancelBtn.addEventListener('click', () => {
                document.body.removeChild(overlay);
                if (onCancel) onCancel();
            });

            // ÂõûËΩ¶Á°ÆËÆ§
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const value = input.value;
                    document.body.removeChild(overlay);
                    if (onConfirm) onConfirm(value);
                }
            });

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    document.body.removeChild(overlay);
                    if (onCancel) onCancel();
                }
            });
        }

        function ignoreAlert(alertId) {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÂøΩÁï•Ëøô‰∏™Êä•Ë≠¶ÂêóÔºüÂøΩÁï•ÂêéÂ∞Ü‰∏çÂÜçÊèêÈÜí„ÄÇ',
                function () {
                    UserFriendlyAlert.showSuccess(`Êä•Ë≠¶ #${alertId} Â∑≤ÂøΩÁï•`);
                    // Âà∑Êñ∞Êä•Ë≠¶ÂàóË°®
                    setTimeout(() => {
                        if (currentPage === 'alerts') {
                            loadPageContent('alerts');
                        }
                    }, 1000);
                },
                function () {
                    // Áî®Êà∑ÂèñÊ∂àÔºå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                }
            );
        }

        function escalateAlert(alertId) {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÂ∞ÜÊ≠§‰∏•ÈáçÊä•Ë≠¶‰∏äÊä•Áªô‰∏äÁ∫ßÁÆ°ÁêÜÂëòÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess(`‰∏•ÈáçÊä•Ë≠¶ #${alertId} Â∑≤‰∏äÊä•ÔºåÁõ∏ÂÖ≥‰∫∫ÂëòÂ∞ÜÊî∂Âà∞Á¥ßÊÄ•ÈÄöÁü•`);
                },
                function () {
                    // Áî®Êà∑ÂèñÊ∂àÔºå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                }
            );
        }

        // ÊâπÈáèÊä•Ë≠¶Êìç‰ΩúÂáΩÊï∞
        function batchHandleAlerts() {
            UserFriendlyAlert.showSuccess('ÊâπÈáèÂ§ÑÁêÜÊìç‰ΩúÂÆåÊàê');
        }

        function exportAlerts() {
            UserFriendlyAlert.showSuccess('Êä•Ë≠¶ËÆ∞ÂΩïÂØºÂá∫ÊàêÂäü');
        }

        function refreshAlerts() {
            // ÈáçÊñ∞ÁîüÊàêÊä•Ë≠¶ÂàóË°®
            const alertsList = document.getElementById('alertsList');
            if (alertsList) {
                alertsList.innerHTML = generateAlertItems(currentAlertGreenhouse);
            }

            // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
            updateAlertStats(currentAlertGreenhouse);

            UserFriendlyAlert.showSuccess('Êä•Ë≠¶ÂàóË°®Â∑≤Âà∑Êñ∞');
        }

        function filterAlerts() {
            UserFriendlyAlert.showSuccess('Êä•Ë≠¶Á≠õÈÄâÂ∑≤Â∫îÁî®');
        }

        // ÈÄÄÂá∫Á≥ªÁªüÂáΩÊï∞
        function logoutSystem() {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁªüÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess('Ê≠£Âú®ÈÄÄÂá∫Á≥ªÁªü...');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 1500);
                },
                function () {
                    // Áî®Êà∑ÂèñÊ∂àÔºå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                }
            );
        }

        // ÂéÜÂè≤ËÆ∞ÂΩïÁõ∏ÂÖ≥ÂáΩÊï∞
        function searchHistory() {
            UserFriendlyAlert.showSuccess(`${greenhouseData[currentHistoryGreenhouse].name}ÂéÜÂè≤ËÆ∞ÂΩïÊêúÁ¥¢ÂÆåÊàê`);
        }

        function exportHistory() {
            UserFriendlyAlert.showSuccess(`${greenhouseData[currentHistoryGreenhouse].name}ÂéÜÂè≤ËÆ∞ÂΩïÂØºÂá∫ÊàêÂäü`);
        }

        function exportDeviceStatus() {
            UserFriendlyAlert.showSuccess(`${greenhouseData[currentDeviceGreenhouse].name}ËÆæÂ§áÁä∂ÊÄÅÂØºÂá∫ÊàêÂäü`);
        }

        // ÈÄÄÂá∫Á≥ªÁªüÂáΩÊï∞
        function logoutSystem() {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁªüÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess('Ê≠£Âú®ÈÄÄÂá∫Á≥ªÁªü...');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 1500);
                },
                function () {
                    // Áî®Êà∑ÂèñÊ∂àÔºå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                }
            );
        }



        let taskData = [
            {
                id: 'env-data-generation',
                name: 'ÁéØÂ¢ÉÊï∞ÊçÆÁîüÊàê',
                icon: 'üå°Ô∏è',
                status: 'running',
                frequency: 'ÊØè30Áßí',
                lastExecution: new Date(Date.now() - 25000),
                nextExecution: new Date('2024-01-08T13:20:15'),
                executionCount: 156,
                description: 'Ëá™Âä®ÈááÈõÜÊ∏©ÂÆ§ÁéØÂ¢ÉÊï∞ÊçÆ'
            },
            {
                id: 'device-status-update',
                name: 'ËÆæÂ§áÁä∂ÊÄÅÊõ¥Êñ∞',
                icon: '‚öôÔ∏è',
                status: 'running',
                frequency: 'ÊØè1ÂàÜÈíü',
                lastExecution: new Date(Date.now() - 45000),
                nextExecution: new Date('2024-01-08T13:21:30'),
                executionCount: 89,
                description: 'Êõ¥Êñ∞ÊâÄÊúâËÆæÂ§áËøêË°åÁä∂ÊÄÅ'
            },
            {
                id: 'alert-detection',
                name: 'Êä•Ë≠¶Ê£ÄÊµã',
                icon: 'üö®',
                status: 'running',
                frequency: 'ÊØè1ÂàÜÈíü',
                lastExecution: new Date(Date.now() - 30000),
                nextExecution: new Date('2024-01-08T13:21:45'),
                executionCount: 234,
                description: 'Ê£ÄÊµãÁéØÂ¢ÉÂºÇÂ∏∏Âπ∂ÁîüÊàêÊä•Ë≠¶'
            },
            {
                id: 'automatic-control',
                name: 'Ëá™Âä®ÂåñÊéßÂà∂',
                icon: 'ü§ñ',
                status: 'running',
                frequency: 'ÊØè2ÂàÜÈíü',
                lastExecution: new Date(Date.now() - 80000),
                nextExecution: new Date('2024-01-08T13:22:10'),
                executionCount: 67,
                description: 'Ê†πÊçÆÁéØÂ¢ÉÊï∞ÊçÆËá™Âä®ÊéßÂà∂ËÆæÂ§á'
            },
            {
                id: 'device-fault-detection',
                name: 'ËÆæÂ§áÊïÖÈöúÊ£ÄÊµã',
                icon: 'üîß',
                status: 'running',
                frequency: 'ÊØè5ÂàÜÈíü',
                lastExecution: new Date(Date.now() - 180000),
                nextExecution: new Date('2024-01-08T13:25:00'),
                executionCount: 23,
                description: 'Ê£ÄÊµãËÆæÂ§áÊïÖÈöúÂíåÂºÇÂ∏∏Áä∂ÊÄÅ'
            },
            {
                id: 'data-backup',
                name: 'Êï∞ÊçÆÂ§á‰ªΩ',
                icon: 'üíæ',
                status: 'paused',
                frequency: 'ÊØèÂ∞èÊó∂',
                lastExecution: new Date(Date.now() - 3600000),
                nextExecution: new Date('2024-01-08T14:20:00'),
                executionCount: 12,
                description: 'ÂÆöÊúüÂ§á‰ªΩÁ≥ªÁªüÈáçË¶ÅÊï∞ÊçÆ'
            }
        ];

        // Âä†ËΩΩËÆæÂ§áÊéßÂà∂ÂÜÖÂÆπ
        function loadDevicesContent(container) {
            container.innerHTML = `
                <!-- Ê∏©ÂÆ§ÈÄâÊã©Âô® -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üè†</span>Ê∏©ÂÆ§ÈÄâÊã©
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="device-greenhouse-btn active" onclick="selectDeviceGreenhouse(1)" style="padding: 12px 20px; background: #2C3E50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">1Âè∑Ê∏©ÂÆ§ (Ëî¨ËèúÂå∫)</button>
                        <button class="device-greenhouse-btn" onclick="selectDeviceGreenhouse(2)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">2Âè∑Ê∏©ÂÆ§ (Ëä±ÂçâÂå∫)</button>
                        <button class="device-greenhouse-btn" onclick="selectDeviceGreenhouse(3)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">3Âè∑Ê∏©ÂÆ§ (ËÇ≤ËãóÂå∫)</button>
                        <button class="device-greenhouse-btn" onclick="selectDeviceGreenhouse(4)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">4Âè∑Ê∏©ÂÆ§ (ÂÆûÈ™åÂå∫)</button>
                    </div>
                </div>

                <!-- ËÆæÂ§áÊéßÂà∂Êìç‰ΩúÊ†è -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üõ†Ô∏è</span>ËÆæÂ§áÊìç‰Ωú
                        </h3>
                        <div style="display: flex; gap: 10px;">
                            <span style="padding: 8px 12px; background: #27AE60; color: white; border-radius: 20px; font-size: 12px; font-weight: 600;">ËøêË°å‰∏≠: 8</span>
                            <span style="padding: 8px 12px; background: #F39C12; color: white; border-radius: 20px; font-size: 12px; font-weight: 600;">ÂæÖÊú∫: 3</span>
                            <span style="padding: 8px 12px; background: #95A5A6; color: white; border-radius: 20px; font-size: 12px; font-weight: 600;">ÂÖ≥Èó≠: 1</span>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <button style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="startAllDevices()">üöÄ ÂêØÂä®ÊâÄÊúâËÆæÂ§á</button>
                        <button style="padding: 12px 20px; background: #E74C3C; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="stopAllDevices()">üõë ÂÅúÊ≠¢ÊâÄÊúâËÆæÂ§á</button>
                        <button style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="refreshDevices()">üîÑ Âà∑Êñ∞Áä∂ÊÄÅ</button>
                        <button style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="exportDeviceStatus()">üì§ ÂØºÂá∫Áä∂ÊÄÅ</button>
                    </div>
                </div>

                <!-- ËÆæÂ§áÁΩëÊ†º -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">‚öôÔ∏è</span>ËÆæÂ§áÂàóË°®
                        <span style="margin-left: auto; font-size: 14px; color: #666; font-weight: normal;">ÁÇπÂáªËÆæÂ§áÂç°ÁâáÊü•ÁúãËØ¶ÁªÜÊéßÂà∂ÔºåÁÇπÂáªÁª¥Êä§ÊåâÈíÆÁÆ°ÁêÜÁª¥Êä§</span>
                    </h3>
                    <div id="devicesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        ${generateDeviceCards(currentDeviceGreenhouse)}
                    </div>
                </div>

                <!-- Áª¥Êä§ÁÆ°ÁêÜÊ¶ÇËßà -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-top: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üîß</span>Áª¥Êä§ÁÆ°ÁêÜ‰∏≠ÂøÉ
                        </h3>
                        <div style="display: flex; gap: 10px;">
                            <button style="padding: 8px 16px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="createMaintenancePlan()">+ ÂàõÂª∫Áª¥Êä§ËÆ°Âàí</button>
                            <button style="padding: 8px 16px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="refreshMaintenanceData()">üîÑ Âà∑Êñ∞</button>
                        </div>
                    </div>
                    
                    <!-- Áª¥Êä§Áä∂ÊÄÅÁªüËÆ° -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #E74C3C;">
                            <div style="font-size: 24px; font-weight: bold; color: #E74C3C; margin-bottom: 5px;" id="overdueCount">2</div>
                            <div style="font-size: 14px; color: #666;">Â∑≤ËøáÊúü</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #F39C12;">
                            <div style="font-size: 24px; font-weight: bold; color: #F39C12; margin-bottom: 5px;" id="upcomingCount">5</div>
                            <div style="font-size: 14px; color: #666;">Âç≥Â∞ÜÂà∞Êúü</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #27AE60;">
                            <div style="font-size: 24px; font-weight: bold; color: #27AE60; margin-bottom: 5px;" id="completedCount">12</div>
                            <div style="font-size: 14px; color: #666;">Â∑≤ÂÆåÊàê</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #3498DB;">
                            <div style="font-size: 24px; font-weight: bold; color: #3498DB; margin-bottom: 5px;" id="totalPlansCount">19</div>
                            <div style="font-size: 14px; color: #666;">ÊÄªËÆ°ÂàíÊï∞</div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ËÆ°ÂàíÂàóË°® -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">üìã</span>Áª¥Êä§ËÆ°Âàí
                        </h4>
                        <div style="background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                            <!-- Ë°®Â§¥ -->
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1.5fr; background: #34495E; color: white; font-weight: 600; font-size: 13px;">
                                <div style="padding: 12px 15px;">ËÆæÂ§áÂêçÁß∞</div>
                                <div style="padding: 12px 15px; text-align: center;">Áª¥Êä§Á±ªÂûã</div>
                                <div style="padding: 12px 15px; text-align: center;">ËÆ°ÂàíÊó•Êúü</div>
                                <div style="padding: 12px 15px; text-align: center;">Áä∂ÊÄÅ</div>
                                <div style="padding: 12px 15px; text-align: center;">Ë¥üË¥£‰∫∫</div>
                                <div style="padding: 12px 15px; text-align: center;">Êìç‰Ωú</div>
                            </div>
                            <!-- Áª¥Êä§ËÆ°ÂàíÊï∞ÊçÆ -->
                            <div id="maintenancePlansContainer">
                                ${generateMaintenancePlansHTML()}
                            </div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ËÆ∞ÂΩïÂàóË°® -->
                    <div>
                        <h4 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">üìù</span>Áª¥Êä§ËÆ∞ÂΩï
                        </h4>
                        <div style="background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                            <!-- Ë°®Â§¥ -->
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr 2fr; background: #2C3E50; color: white; font-weight: 600; font-size: 13px;">
                                <div style="padding: 12px 15px;">ËÆæÂ§áÂêçÁß∞</div>
                                <div style="padding: 12px 15px; text-align: center;">Áª¥Êä§Á±ªÂûã</div>
                                <div style="padding: 12px 15px; text-align: center;">ÂÆåÊàêÊó•Êúü</div>
                                <div style="padding: 12px 15px; text-align: center;">ËÄóÊó∂</div>
                                <div style="padding: 12px 15px; text-align: center;">ÊâßË°å‰∫∫</div>
                                <div style="padding: 12px 15px;">Â§áÊ≥®</div>
                            </div>
                            <!-- Áª¥Êä§ËÆ∞ÂΩïÊï∞ÊçÆ -->
                            <div id="maintenanceRecordsContainer">
                                ${generateMaintenanceRecordsHTML()}
                            </div>
                        </div>
                    </div>
                <div font-size: 24px; font-weight: bold; color: #F39C12; margin-bottom: 5px;" id="dueSoonCount">2</div>
                            <div style="font-size: 14px; color: #666;">Âç≥Â∞ÜÂà∞Êúü</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #E67E22;">
                            <div style="font-size: 24px; font-weight: bold; color: #E67E22; margin-bottom: 5px;" id="needMaintenanceCount">1</div>
                            <div style="font-size: 14px; color: #666;">ÈúÄË¶ÅÁª¥Êä§</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #27AE60;">
                            <div style="font-size: 24px; font-weight: bold; color: #27AE60; margin-bottom: 5px;" id="normalCount">5</div>
                            <div style="font-size: 14px; color: #666;">Áä∂ÊÄÅÊ≠£Â∏∏</div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ÁÆ°ÁêÜÊìç‰Ωú -->
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 30px;">
                        <button style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onclick="showMaintenanceScheduleList()">üìÖ Áª¥Êä§ËÆ°Âàí</button>
                        <button style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onclick="showMaintenanceRecordsList()">üìã Áª¥Êä§ËÆ∞ÂΩï</button>
                        <button style="padding: 12px 20px; background: #E67E22; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onclick="createMaintenancePlan()">‚ûï ÂàõÂª∫ËÆ°Âàí</button>
                        <button style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onclick="exportMaintenanceReport()">üìä ÂØºÂá∫Êä•Âëä</button>
                    </div>

                    <!-- Áª¥Êä§ËÆ°ÂàíÂàóË°® -->
                    <div id="maintenanceScheduleSection" style="margin-bottom: 30px;">
                        <h4 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìÖ</span>ËøëÊúüÁª¥Êä§ËÆ°Âàí
                        </h4>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div id="maintenanceScheduleList">
                                ${generateMaintenanceScheduleList()}
                            </div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ËÆ∞ÂΩïÂàóË°® -->
                    <div id="maintenanceRecordsSection">
                        <h4 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üìã</span>ÊúÄËøëÁª¥Êä§ËÆ∞ÂΩï
                        </h4>
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 20px;">
                            <div id="maintenanceRecordsList">
                                ${generateMaintenanceRecordsList()}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Âä†ËΩΩÂÆöÊó∂‰ªªÂä°ÂÜÖÂÆπ
        function loadTasksContent(container) {
            container.innerHTML = `
                <!-- ‰ªªÂä°ÊéßÂà∂‰∏≠ÂøÉ -->
                <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">‚öôÔ∏è</span>‰ªªÂä°ÊéßÂà∂‰∏≠ÂøÉ
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <button style="padding: 15px 25px; background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;" onclick="startAllTasksWithSync()">
                            üöÄ ÂêØÂä®ÊâÄÊúâ‰ªªÂä°
                        </button>
                        <button style="padding: 15px 25px; background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;" onclick="stopAllTasksWithSync()">
                            üõë ÂÅúÊ≠¢ÊâÄÊúâ‰ªªÂä°
                        </button>
                        <button style="padding: 15px 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;" onclick="refreshTaskStatusWithSync()">
                            üîÑ Âà∑Êñ∞Áä∂ÊÄÅ
                        </button>
                        <button style="padding: 15px 25px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;" onclick="triggerAllTasksWithSync()">
                            ‚ö° ÊâãÂä®Ëß¶ÂèëÊâÄÊúâ‰ªªÂä°
                        </button>
                    </div>

                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 15px; padding: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
                        <div style="display: inline-flex; align-items: center; font-size: 1.1rem; font-weight: 500;">
                            <span id="statusDot" style="width: 12px; height: 12px; border-radius: 50%; margin-right: 10px; background: #56ab2f; box-shadow: 0 0 10px rgba(86, 171, 47, 0.5); animation: pulse 2s infinite;"></span>
                            <span>Á≥ªÁªüÁä∂ÊÄÅÔºö<strong id="statusText">ËøêË°å‰∏≠</strong></span>
                        </div>
                    </div>
                </div>

                <!-- ÂΩìÂâç‰ªªÂä°ÂàóË°® -->
                <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üìã</span>ÂΩìÂâç‰ªªÂä°ÂàóË°®
                    </h3>
                    <div style="background: rgba(248, 249, 250, 0.8); border-radius: 15px; overflow: hidden; border: 1px solid rgba(0, 0, 0, 0.1);">
                        <!-- Ë°®Â§¥ -->
                        <div style="display: grid; grid-template-columns: 2fr 1fr 1.5fr 1.5fr 1.5fr 1fr 1.5fr; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;">
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">‰ªªÂä°ÂêçÁß∞</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">Áä∂ÊÄÅ</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">ÊâßË°åÈ¢ëÁéá</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">‰∏äÊ¨°ÊâßË°å</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">‰∏ãÊ¨°ÊâßË°å</div>
                            <div style="padding: 15px 12px; text-align: center; border-right: 1px solid rgba(255, 255, 255, 0.2);">ÊâßË°åÊ¨°Êï∞</div>
                            <div style="padding: 15px 12px; text-align: center;">Êìç‰Ωú</div>
                        </div>
                        <!-- ‰ªªÂä°ÂàóË°® -->
                        <div id="taskListContainer" style="max-height: 400px; overflow-y: auto;">
                            ${generateTaskListHTML()}
                        </div>
                    </div>
                </div>
            `;

            // ÂêØÂä®Êó∂Èó¥Êõ¥Êñ∞ÂÆöÊó∂Âô®
            startTaskTimeUpdater();
        }

        // ÁîüÊàê‰ªªÂä°ÂàóË°®HTML
        function generateTaskListHTML() {
            return taskData.map(task => {
                const statusClass = task.status === 'running' ? 'status-running' :
                    task.status === 'paused' ? 'status-paused' : 'status-stopped';
                const statusText = task.status === 'running' ? 'ËøêË°å‰∏≠' :
                    task.status === 'paused' ? 'Â∑≤ÊöÇÂÅú' : 'Â∑≤ÂÅúÊ≠¢';

                const actions = task.status === 'running' ?
                    `<button style="padding: 4px 8px; background: #F39C12; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="pauseTaskWithSync('${task.id}')">ÊöÇÂÅú</button>
                     <button style="padding: 4px 8px; background: #E74C3C; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="stopTaskWithSync('${task.id}')">ÂÅúÊ≠¢</button>
                     <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="triggerTaskWithSync('${task.id}')">Ëß¶Âèë</button>` :
                    task.status === 'paused' ?
                        `<button style="padding: 4px 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="resumeTaskWithSync('${task.id}')">ÊÅ¢Â§ç</button>
                     <button style="padding: 4px 8px; background: #E74C3C; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="stopTaskWithSync('${task.id}')">ÂÅúÊ≠¢</button>
                     <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="triggerTaskWithSync('${task.id}')">Ëß¶Âèë</button>` :
                        `<button style="padding: 4px 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; margin-right: 5px;" onclick="startTaskWithSync('${task.id}')">ÂêØÂä®</button>
                     <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="triggerTaskWithSync('${task.id}')">Ëß¶Âèë</button>`;

                return `
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1.5fr 1.5fr 1.5fr 1fr 1.5fr; border-bottom: 1px solid rgba(0, 0, 0, 0.1); transition: all 0.3s ease; background: white;" 
                         onmouseover="this.style.background='rgba(102, 126, 234, 0.05)'; this.style.transform='translateX(2px)'" 
                         onmouseout="this.style.background='white'; this.style.transform='translateX(0)'">
                        <div style="padding: 15px 12px; text-align: left; display: flex; align-items: center; font-size: 13px; font-weight: 600; color: #333;">
                            <span style="margin-right: 8px; font-size: 16px;">${task.icon}</span>
                            <div>
                                <div style="font-weight: 600;">${task.name}</div>
                                <div style="font-size: 11px; color: #666; margin-top: 2px;">${task.description}</div>
                            </div>
                        </div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 13px;">
                            <span style="padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; 
                                         background: ${task.status === 'running' ? 'rgba(39, 174, 96, 0.2)' : task.status === 'paused' ? 'rgba(243, 156, 18, 0.2)' : 'rgba(231, 76, 60, 0.2)'};
                                         color: ${task.status === 'running' ? '#27AE60' : task.status === 'paused' ? '#F39C12' : '#E74C3C'};
                                         border: 1px solid ${task.status === 'running' ? 'rgba(39, 174, 96, 0.3)' : task.status === 'paused' ? 'rgba(243, 156, 18, 0.3)' : 'rgba(231, 76, 60, 0.3)'};">
                                ${statusText}
                            </span>
                        </div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; font-family: 'Consolas', 'Monaco', monospace; color: #666;">${task.frequency}</div>
                        <div id="last-${task.id}" style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 11px; font-family: 'Consolas', 'Monaco', monospace; color: #666;">${formatTime(task.lastExecution)}</div>
                        <div id="next-${task.id}" style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 11px; font-family: 'Consolas', 'Monaco', monospace; color: #666;">${formatCountdown(task.nextExecution)}</div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; color: #3498DB;">${task.executionCount}</div>
                        <div style="padding: 15px 12px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 5px;">
                            ${actions}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Ê†ºÂºèÂåñÊó∂Èó¥ÊòæÁ§∫
        function formatTime(date) {
            const now = new Date();
            const diff = Math.abs(now - date);

            if (diff < 60000) { // Â∞è‰∫é1ÂàÜÈíü
                return Math.floor(diff / 1000) + 'ÁßíÂâç';
            } else if (diff < 3600000) { // Â∞è‰∫é1Â∞èÊó∂
                return Math.floor(diff / 60000) + 'ÂàÜÈíüÂâç';
            } else {
                return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            }
        }

        // Ê†ºÂºèÂåñÂÄíËÆ°Êó∂
        function formatCountdown(date) {
            const now = new Date();
            const diff = date - now;

            if (diff <= 0) {
                return '2024-01-08 13:20:15';
            }

            if (diff < 60000) { // Â∞è‰∫é1ÂàÜÈíü
                return Math.floor(diff / 1000) + 'ÁßíÂêé';
            } else if (diff < 3600000) { // Â∞è‰∫é1Â∞èÊó∂
                return Math.floor(diff / 60000) + 'ÂàÜÈíüÂêé';
            } else {
                return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
            }
        }

        // Ëé∑ÂèñÈ¢ëÁéáÂØπÂ∫îÁöÑÊØ´ÁßíÊï∞
        function getFrequencyMs(frequency) {
            const frequencyMap = {
                'ÊØè30Áßí': 30000,
                'ÊØè1ÂàÜÈíü': 60000,
                'ÊØè2ÂàÜÈíü': 120000,
                'ÊØè5ÂàÜÈíü': 300000,
                'ÊØèÂ∞èÊó∂': 3600000
            };
            return frequencyMap[frequency] || 60000;
        }

        // Êõ¥Êñ∞‰ªªÂä°ÂàóË°®ÊòæÁ§∫
        function updateTaskList() {
            const container = document.getElementById('taskListContainer');
            if (container) {
                container.innerHTML = generateTaskListHTML();
            }
        }

        // Êõ¥Êñ∞Á≥ªÁªüÁä∂ÊÄÅÊòæÁ§∫
        function updateSystemStatus() {
            const runningTasks = taskData.filter(task => task.status === 'running').length;
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');

            if (runningTasks > 0) {
                statusDot.style.background = '#56ab2f';
                statusDot.style.boxShadow = '0 0 10px rgba(86, 171, 47, 0.5)';
                statusText.textContent = 'ËøêË°å‰∏≠';
            } else {
                statusDot.style.background = '#ff416c';
                statusDot.style.boxShadow = '0 0 10px rgba(255, 65, 108, 0.5)';
                statusText.textContent = 'Â∑≤ÂÅúÊ≠¢';
            }
        }

        // ÂêØÂä®Êó∂Èó¥Êõ¥Êñ∞ÂÆöÊó∂Âô®
        function startTaskTimeUpdater() {
            setInterval(() => {
                taskData.forEach(task => {
                    const lastElement = document.getElementById(`last-${task.id}`);
                    const nextElement = document.getElementById(`next-${task.id}`);

                    if (lastElement) {
                        lastElement.textContent = formatTime(task.lastExecution);
                    }

                    if (nextElement) {
                        nextElement.textContent = formatCountdown(task.nextExecution);
                    }
                });
            }, 1000);
        }

        // Â∏¶ÂêåÊ≠•ÁöÑ‰ªªÂä°ÊéßÂà∂ÂáΩÊï∞
        function startAllTasksWithSync() {
            let startedCount = 0;
            taskData.forEach(task => {
                if (task.status === 'stopped' || task.status === 'paused') {
                    task.status = 'running';
                    task.nextExecution = new Date(Date.now() + getFrequencyMs(task.frequency));
                    startedCount++;
                }
            });

            updateTaskList();
            updateSystemStatus();
            UserFriendlyAlert.showSuccess(`Â∑≤ÂêØÂä® ${startedCount} ‰∏™ÂÆöÊó∂‰ªªÂä°`);
        }

        function stopAllTasksWithSync() {
            let stoppedCount = 0;
            taskData.forEach(task => {
                if (task.status === 'running' || task.status === 'paused') {
                    task.status = 'stopped';
                    stoppedCount++;
                }
            });

            updateTaskList();
            updateSystemStatus();
            UserFriendlyAlert.showSuccess(`Â∑≤ÂÅúÊ≠¢ ${stoppedCount} ‰∏™ÂÆöÊó∂‰ªªÂä°`);
        }

        function refreshTaskStatusWithSync() {
            updateTaskList();
            updateSystemStatus();
            UserFriendlyAlert.showSuccess('‰ªªÂä°Áä∂ÊÄÅÂ∑≤Âà∑Êñ∞');
        }

        function triggerAllTasksWithSync() {
            taskData.forEach(task => {
                task.executionCount++;
                task.lastExecution = new Date();
                task.nextExecution = new Date(Date.now() + getFrequencyMs(task.frequency));
            });

            updateTaskList();
            UserFriendlyAlert.showSuccess('ÊâÄÊúâ‰ªªÂä°ÊâãÂä®Ëß¶ÂèëÂÆåÊàê');
        }

        // Âçï‰∏™‰ªªÂä°ÊéßÂà∂ÂáΩÊï∞
        function startTaskWithSync(taskId) {
            const task = taskData.find(t => t.id === taskId);
            if (task) {
                task.status = 'running';
                task.nextExecution = new Date(Date.now() + getFrequencyMs(task.frequency));
                updateTaskList();
                updateSystemStatus();
                UserFriendlyAlert.showSuccess(`${task.icon} ${task.name} Â∑≤ÂêØÂä®`);
            }
        }

        function stopTaskWithSync(taskId) {
            const task = taskData.find(t => t.id === taskId);
            if (task) {
                task.status = 'stopped';
                updateTaskList();
                updateSystemStatus();
                UserFriendlyAlert.showInfo(`${task.icon} ${task.name} Â∑≤ÂÅúÊ≠¢`);
            }
        }

        function pauseTaskWithSync(taskId) {
            const task = taskData.find(t => t.id === taskId);
            if (task) {
                task.status = 'paused';
                updateTaskList();
                updateSystemStatus();
                UserFriendlyAlert.showInfo(`${task.icon} ${task.name} Â∑≤ÊöÇÂÅú`);
            }
        }

        function resumeTaskWithSync(taskId) {
            const task = taskData.find(t => t.id === taskId);
            if (task) {
                task.status = 'running';
                task.nextExecution = new Date(Date.now() + getFrequencyMs(task.frequency));
                updateTaskList();
                updateSystemStatus();
                UserFriendlyAlert.showSuccess(`${task.icon} ${task.name} Â∑≤ÊÅ¢Â§çËøêË°å`);
            }
        }

        function triggerTaskWithSync(taskId) {
            const task = taskData.find(t => t.id === taskId);
            if (task) {
                task.executionCount++;
                task.lastExecution = new Date();
                task.nextExecution = new Date(Date.now() + getFrequencyMs(task.frequency));
                updateTaskList();
                UserFriendlyAlert.showSuccess(`${task.icon} ${task.name} ÊâãÂä®ÊâßË°åÂÆåÊàê`);
            }
        }

        // ËÆæÂ§áÊéßÂà∂Áõ∏ÂÖ≥ÂáΩÊï∞
        function startAllDevices() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_start_all'));
        }

        function stopAllDevices() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_stop_all'));
        }

        function refreshDevices() {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_refresh'));
        }

        function startDevice(deviceName) {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_start_single', deviceName));
        }

        function stopDevice(deviceName) {
            UserFriendlyAlert.showSuccess(MessageFormatter.formatSuccess('device_stop_single', deviceName));
        }

        // Áª¥Êä§ËÆ°ÂàíÊï∞ÊçÆÂ≠òÂÇ®
        let maintenancePlans = [
            { id: 1, deviceName: 'Ê∏©Â∫¶ÊéßÂà∂Âô®', deviceIcon: 'üå°Ô∏è', type: 'ÂÆöÊúüÊ£ÄÊü•', plannedDate: '2024-01-16', status: 'ÂæÖÊâßË°å', assignee: 'Âº†Â∑•Á®ãÂ∏à', priority: 'normal', description: 'Ê£ÄÊü•Ê∏©Â∫¶‰º†ÊÑüÂô®Á≤æÂ∫¶ÔºåÊ∏ÖÊ¥ÅËÆæÂ§áÂ§ñÂ£≥' },
            { id: 2, deviceName: 'ÁÅåÊ∫âÁ≥ªÁªü', deviceIcon: 'üíß', type: 'Ê∑±Â∫¶Ê∏ÖÊ¥Å', plannedDate: '2024-01-15', status: 'Â∑≤ËøáÊúü', assignee: 'ÊùéÊäÄÂ∏à', priority: 'high', description: 'Ê∏ÖÁêÜÁÆ°ÈÅìÂ†µÂ°ûÔºåÊõ¥Êç¢ËÄÅÂåñÂØÜÂ∞ÅÂúà' },
            { id: 3, deviceName: 'Ë°•ÂÖâÁÅØ', deviceIcon: 'üí°', type: 'ÁÅØÊ≥°Êõ¥Êç¢', plannedDate: '2024-01-18', status: 'ÂæÖÊâßË°å', assignee: 'ÁéãÂ∏àÂÇÖ', priority: 'normal', description: 'Êõ¥Êç¢ËÄÅÂåñLEDÁÅØÊ≥°ÔºåÊ£ÄÊü•ÁîµË∑ØËøûÊé•' },
            { id: 4, deviceName: 'ÈÄöÈ£éÁ≥ªÁªü', deviceIcon: 'üå™Ô∏è', type: 'Êª§ÁΩëÊ∏ÖÊ¥ó', plannedDate: '2024-01-17', status: 'ÂæÖÊâßË°å', assignee: 'ÈôàÊäÄÂ∏à', priority: 'normal', description: 'Ê∏ÖÊ¥óËøõÈ£éÂè£Êª§ÁΩëÔºåÊ£ÄÊü•È£éÊâáËøêËΩ¨' },
            { id: 5, deviceName: 'Âä†ÁÉ≠Âô®', deviceIcon: 'üî•', type: 'ÂÆâÂÖ®Ê£ÄÊü•', plannedDate: '2024-01-14', status: 'Â∑≤ËøáÊúü', assignee: 'ÂàòÂ∑•Á®ãÂ∏à', priority: 'high', description: 'Ê£ÄÊü•Âä†ÁÉ≠ÂÖÉ‰ª∂ÂíåÊ∏©ÊéßÁ≥ªÁªüÂÆâÂÖ®ÊÄß' },
            { id: 6, deviceName: 'ÊπøÂ∫¶‰º†ÊÑüÂô®', deviceIcon: 'üí®', type: 'Ê†°ÂáÜÊ£ÄÊµã', plannedDate: '2024-01-19', status: 'ÂæÖÊâßË°å', assignee: 'ËµµÊäÄÂ∏à', priority: 'low', description: 'ÈáçÊñ∞Ê†°ÂáÜ‰º†ÊÑüÂô®ÔºåÊèêÂçáÊ£ÄÊµãÁ≤æÂ∫¶' }
        ];

        // Áª¥Êä§ÁÆ°ÁêÜÁõ∏ÂÖ≥ÂáΩÊï∞
        function createMaintenancePlan() {
            console.log('createMaintenancePlan called');

            try {
                showMaintenancePlanModal();
            } catch (error) {
                console.error('Error in createMaintenancePlan:', error);
                alert('ÂàõÂª∫Áª¥Êä§ËÆ°ÂàíÊó∂ÂèëÁîüÈîôËØØ: ' + error.message);
            }
        }

        // ÊòæÁ§∫Áª¥Êä§ËÆ°ÂàíÂàõÂª∫ÂºπÁ™ó
        function showMaintenancePlanModal(planData = null) {
            const isEdit = planData !== null;
            const modalTitle = isEdit ? 'ÁºñËæëÁª¥Êä§ËÆ°Âàí' : 'ÂàõÂª∫Áª¥Êä§ËÆ°Âàí';

            // ÈáçÁΩÆÂÖ®Â±ÄÂèòÈáè
            if (!isEdit) {
                maintenanceSteps = [];
                requiredTools = [];
                stepCounter = 0;
            }

            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.3s ease;
            `;

            // ÂàõÂª∫ÂºπÁ™ó
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 15px;
                width: 90%;
                max-width: 600px;
                max-height: 90vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                animation: slideIn 0.3s ease;
            `;

            modal.innerHTML = `
                <div style="padding: 25px; border-bottom: 1px solid #eee;">
                    <h3 style="margin: 0; color: #333; font-size: 20px; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üìã</span>${modalTitle}
                    </h3>
                </div>
                
                <form id="maintenancePlanForm" style="padding: 25px;">
                    <!-- Âü∫Êú¨‰ø°ÊÅØ -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="margin-bottom: 15px; color: #333; font-size: 16px;">Âü∫Êú¨‰ø°ÊÅØ</h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">ËÆæÂ§áÂêçÁß∞ *</label>
                                <select name="deviceName" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                                    <option value="">ËØ∑ÈÄâÊã©ËÆæÂ§á</option>
                                    <option value="Ê∏©Â∫¶ÊéßÂà∂Âô®">üå°Ô∏è Ê∏©Â∫¶ÊéßÂà∂Âô®</option>
                                    <option value="ÊπøÂ∫¶ÊéßÂà∂Âô®">üí® ÊπøÂ∫¶ÊéßÂà∂Âô®</option>
                                    <option value="Ë°•ÂÖâÁÅØÁ≥ªÁªü">üí° Ë°•ÂÖâÁÅØÁ≥ªÁªü</option>
                                    <option value="ÈÄöÈ£éÁ≥ªÁªü">üå™Ô∏è ÈÄöÈ£éÁ≥ªÁªü</option>
                                    <option value="ÁÅåÊ∫âÁ≥ªÁªü">üíß ÁÅåÊ∫âÁ≥ªÁªü</option>
                                    <option value="Âä†ÁÉ≠Âô®">üî• Âä†ÁÉ≠Âô®</option>
                                    <option value="ÂÜ∑Âç¥Âô®">‚ùÑÔ∏è ÂÜ∑Âç¥Âô®</option>
                                    <option value="CO2ÂèëÁîüÂô®">üí® CO2ÂèëÁîüÂô®</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">Áª¥Êä§Á±ªÂûã *</label>
                                <select name="type" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                                    <option value="">ËØ∑ÈÄâÊã©Á±ªÂûã</option>
                                    <option value="ÂÆöÊúü‰øùÂÖª">ÂÆöÊúü‰øùÂÖª</option>
                                    <option value="ÊïÖÈöúÁª¥‰øÆ">ÊïÖÈöúÁª¥‰øÆ</option>
                                    <option value="È¢ÑÈò≤ÊÄßÁª¥Êä§">È¢ÑÈò≤ÊÄßÁª¥Êä§</option>
                                    <option value="Á¥ßÊÄ•Áª¥‰øÆ">Á¥ßÊÄ•Áª¥‰øÆ</option>
                                    <option value="ËÆæÂ§áÂçáÁ∫ß">ËÆæÂ§áÂçáÁ∫ß</option>
                                    <option value="ÂÆâÂÖ®Ê£ÄÊü•">ÂÆâÂÖ®Ê£ÄÊü•</option>
                                </select>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">ËÆ°ÂàíÊó•Êúü *</label>
                                <input type="date" name="plannedDate" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">‰ºòÂÖàÁ∫ß</label>
                                <select name="priority" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                                    <option value="low">‰Ωé‰ºòÂÖàÁ∫ß</option>
                                    <option value="normal" selected>ÊôÆÈÄö‰ºòÂÖàÁ∫ß</option>
                                    <option value="high">È´ò‰ºòÂÖàÁ∫ß</option>
                                    <option value="urgent">Á¥ßÊÄ•</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ‰∫∫ÂëòÂàÜÈÖç -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="margin-bottom: 15px; color: #333; font-size: 16px;">‰∫∫ÂëòÂàÜÈÖç</h4>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">Ë¥üË¥£‰∫∫ *</label>
                            <select name="assignee" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                                <option value="">ËØ∑ÈÄâÊã©Ë¥üË¥£‰∫∫</option>
                                <option value="Âº†Â∑•Á®ãÂ∏à">Âº†Â∑•Á®ãÂ∏à</option>
                                <option value="ÊùéÊäÄÂ∏à">ÊùéÊäÄÂ∏à</option>
                                <option value="ÁéãÂ∏àÂÇÖ">ÁéãÂ∏àÂÇÖ</option>
                                <option value="ÈôàÊäÄÂ∏à">ÈôàÊäÄÂ∏à</option>
                                <option value="ÂàòÂ∑•Á®ãÂ∏à">ÂàòÂ∑•Á®ãÂ∏à</option>
                                <option value="ËµµÊäÄÂ∏à">ËµµÊäÄÂ∏à</option>
                                <option value="Â≠ôÂ∏àÂÇÖ">Â≠ôÂ∏àÂÇÖ</option>
                                <option value="Âë®ÊäÄÂ∏à">Âë®ÊäÄÂ∏à</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Áª¥Êä§ÂÜÖÂÆπ -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="margin-bottom: 15px; color: #333; font-size: 16px;">Áª¥Êä§ÂÜÖÂÆπ</h4>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">Áª¥Êä§ÊèèËø∞</label>
                            <textarea name="description" rows="3" placeholder="ËØ∑ÁÆÄË¶ÅÊèèËø∞Áª¥Êä§ÁõÆÊ†áÂíåÊÄª‰ΩìË¶ÅÊ±Ç..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;"></textarea>
                        </div>
                        
                        <!-- Áª¥Êä§Ê≠•È™§ÁÆ°ÁêÜ -->
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <label style="font-weight: 600; color: #555;">Áª¥Êä§Ê≠•È™§</label>
                                <button type="button" onclick="addMaintenanceStep()" style="padding: 6px 12px; background: #3498DB; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                    <span style="margin-right: 5px;">+</span>Ê∑ªÂä†Ê≠•È™§
                                </button>
                            </div>
                            <div id="maintenanceStepsContainer" style="border: 1px solid #e0e0e0; border-radius: 6px; min-height: 60px; background: #fafafa;">
                                <div style="padding: 20px; text-align: center; color: #999; font-size: 14px;" id="noStepsMessage">
                                    ÊöÇÊó†Áª¥Êä§Ê≠•È™§ÔºåÁÇπÂáª"Ê∑ªÂä†Ê≠•È™§"ÂºÄÂßãÂàõÂª∫
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÊâÄÈúÄÂ∑•ÂÖ∑ -->
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">ÊâÄÈúÄÂ∑•ÂÖ∑</label>
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="text" id="toolInput" placeholder="ËæìÂÖ•Â∑•ÂÖ∑ÂêçÁß∞..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                <button type="button" onclick="addTool()" style="padding: 8px 15px; background: #27AE60; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 600;">Ê∑ªÂä†</button>
                            </div>
                            <div id="toolsList" style="display: flex; flex-wrap: wrap; gap: 8px; min-height: 30px;">
                                <!-- Â∑•ÂÖ∑Ê†áÁ≠æÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                            </div>
                        </div>
                        
                        <!-- ÂÆâÂÖ®Ê≥®ÊÑè‰∫ãÈ°π -->
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">ÂÆâÂÖ®Ê≥®ÊÑè‰∫ãÈ°π</label>
                            <textarea name="safetyNotes" rows="3" placeholder="ËØ∑ÂàóÂá∫ÈáçË¶ÅÁöÑÂÆâÂÖ®Ê≥®ÊÑè‰∫ãÈ°πÂíåÈ£éÈô©ÊèêÈÜí..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;"></textarea>
                        </div>
                    </div>
                </form>
                
                <div style="padding: 20px 25px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px;">
                    <button type="button" onclick="closeMaintenancePlanModal()" style="padding: 10px 20px; background: #95A5A6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">ÂèñÊ∂à</button>
                    <button type="button" onclick="saveMaintenancePlan(${isEdit ? planData?.id : 'null'})" style="padding: 10px 20px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">${isEdit ? 'Êõ¥Êñ∞ËÆ°Âàí' : 'ÂàõÂª∫ËÆ°Âàí'}</button>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // Â¶ÇÊûúÊòØÁºñËæëÊ®°ÂºèÔºåÂ°´ÂÖÖÁé∞ÊúâÊï∞ÊçÆ
            if (isEdit && planData) {
                const form = modal.querySelector('#maintenancePlanForm');
                form.deviceName.value = planData.deviceName;
                form.type.value = planData.type;
                form.plannedDate.value = planData.plannedDate;
                form.priority.value = planData.priority;
                form.assignee.value = planData.assignee;
                form.description.value = planData.description || '';
                form.safetyNotes.value = planData.safetyNotes || '';

                // Âä†ËΩΩÁª¥Êä§Ê≠•È™§
                if (planData.maintenanceSteps && planData.maintenanceSteps.length > 0) {
                    // Ê∏ÖÁ©∫Áé∞ÊúâÊ≠•È™§
                    const container = document.getElementById('maintenanceStepsContainer');
                    container.innerHTML = '';

                    // Ê∑ªÂä†ÊØè‰∏™Ê≠•È™§
                    planData.maintenanceSteps.forEach((step, index) => {
                        stepCounter++;
                        const stepId = `step_${stepCounter}`;

                        const stepHtml = `
                            <div class="maintenance-step" data-step-id="${stepId}" style="border: 1px solid #ddd; border-radius: 6px; margin-bottom: 10px; background: white;">
                                <div style="padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <h5 style="margin: 0; color: #333; font-size: 14px; font-weight: 600;">Ê≠•È™§ ${step.stepNumber}</h5>
                                        <div style="display: flex; gap: 5px;">
                                            <button type="button" onclick="moveStepUp('${stepId}')" style="padding: 4px 8px; background: #95A5A6; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;" title="‰∏äÁßª">‚Üë</button>
                                            <button type="button" onclick="moveStepDown('${stepId}')" style="padding: 4px 8px; background: #95A5A6; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;" title="‰∏ãÁßª">‚Üì</button>
                                            <button type="button" onclick="removeMaintenanceStep('${stepId}')" style="padding: 4px 8px; background: #E74C3C; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;" title="Âà†Èô§">√ó</button>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">Ê≠•È™§ÊèèËø∞ *</label>
                                        <textarea class="step-description" rows="2" placeholder="ËØ¶ÁªÜÊèèËø∞Ê≠§Ê≠•È™§ÁöÑÊìç‰ΩúÂÜÖÂÆπ..." style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; resize: vertical;" required>${step.description}</textarea>
                                    </div>
                                    
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                                        <div>
                                            <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">È¢ÑËÆ°Êó∂Èó¥ÔºàÂàÜÈíüÔºâ</label>
                                            <input type="number" class="step-time" min="1" placeholder="30" value="${step.estimatedTime || ''}" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">ÊâÄÈúÄÂ∑•ÂÖ∑</label>
                                            <input type="text" class="step-tools" placeholder="Ëû∫‰∏ùÂàÄ, ‰∏áÁî®Ë°®..." value="${step.requiredTools ? step.requiredTools.join(', ') : ''}" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">ÂÆâÂÖ®Ë≠¶Âëä</label>
                                        <input type="text" class="step-safety" placeholder="Ê≥®ÊÑèÊñ≠ÁîµÊìç‰Ωú„ÄÅ‰Ω©Êà¥Èò≤Êä§Áî®ÂìÅÁ≠â..." value="${step.safetyWarning || ''}" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                    </div>
                                </div>
                            </div>
                        `;

                        container.insertAdjacentHTML('beforeend', stepHtml);
                    });
                }

                // Âä†ËΩΩÊâÄÈúÄÂ∑•ÂÖ∑
                if (planData.requiredTools && planData.requiredTools.length > 0) {
                    requiredTools = [...planData.requiredTools];
                    updateToolsList();
                }
            }

            // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫ÊòéÂ§©
            if (!isEdit) {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                const dateInput = modal.querySelector('input[name="plannedDate"]');
                dateInput.value = tomorrow.toISOString().split('T')[0];
            }

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
            overlay.addEventListener('click', function (e) {
                if (e.target === overlay) {
                    closeMaintenancePlanModal();
                }
            });

            // ‰øùÂ≠òÂºπÁ™óÂºïÁî®
            window.currentMaintenancePlanModal = overlay;
        }

        // ÂÖ≥Èó≠Áª¥Êä§ËÆ°ÂàíÂºπÁ™ó
        function closeMaintenancePlanModal() {
            if (window.currentMaintenancePlanModal) {
                document.body.removeChild(window.currentMaintenancePlanModal);
                window.currentMaintenancePlanModal = null;
            }
        }

        // Áª¥Êä§Ê≠•È™§ÁÆ°ÁêÜÁõ∏ÂÖ≥ÂèòÈáè
        let maintenanceSteps = [];
        let requiredTools = [];
        let stepCounter = 0;

        // Ê∑ªÂä†Áª¥Êä§Ê≠•È™§
        function addMaintenanceStep() {
            stepCounter++;
            const stepId = `step_${stepCounter}`;

            const stepHtml = `
                <div class="maintenance-step" data-step-id="${stepId}" style="border: 1px solid #ddd; border-radius: 6px; margin-bottom: 10px; background: white;">
                    <div style="padding: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h5 style="margin: 0; color: #333; font-size: 14px; font-weight: 600;">Ê≠•È™§ ${stepCounter}</h5>
                            <div style="display: flex; gap: 5px;">
                                <button type="button" onclick="moveStepUp('${stepId}')" style="padding: 4px 8px; background: #95A5A6; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;" title="‰∏äÁßª">‚Üë</button>
                                <button type="button" onclick="moveStepDown('${stepId}')" style="padding: 4px 8px; background: #95A5A6; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;" title="‰∏ãÁßª">‚Üì</button>
                                <button type="button" onclick="removeMaintenanceStep('${stepId}')" style="padding: 4px 8px; background: #E74C3C; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;" title="Âà†Èô§">√ó</button>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 10px;">
                            <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">Ê≠•È™§ÊèèËø∞ *</label>
                            <textarea class="step-description" rows="2" placeholder="ËØ¶ÁªÜÊèèËø∞Ê≠§Ê≠•È™§ÁöÑÊìç‰ΩúÂÜÖÂÆπ..." style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; resize: vertical;" required></textarea>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">È¢ÑËÆ°Êó∂Èó¥ÔºàÂàÜÈíüÔºâ</label>
                                <input type="number" class="step-time" min="1" placeholder="30" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">ÊâÄÈúÄÂ∑•ÂÖ∑</label>
                                <input type="text" class="step-tools" placeholder="Ëû∫‰∏ùÂàÄ, ‰∏áÁî®Ë°®..." style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            </div>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 3px; font-size: 12px; color: #666; font-weight: 600;">ÂÆâÂÖ®Ë≠¶Âëä</label>
                            <input type="text" class="step-safety" placeholder="Ê≥®ÊÑèÊñ≠ÁîµÊìç‰Ωú„ÄÅ‰Ω©Êà¥Èò≤Êä§Áî®ÂìÅÁ≠â..." style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                        </div>
                    </div>
                </div>
            `;

            const container = document.getElementById('maintenanceStepsContainer');
            const noStepsMessage = document.getElementById('noStepsMessage');

            if (noStepsMessage) {
                noStepsMessage.remove();
            }

            container.insertAdjacentHTML('beforeend', stepHtml);

            // ÊªöÂä®Âà∞Êñ∞Ê∑ªÂä†ÁöÑÊ≠•È™§
            const newStep = container.lastElementChild;
            newStep.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Âà†Èô§Áª¥Êä§Ê≠•È™§
        function removeMaintenanceStep(stepId) {
            const stepElement = document.querySelector(`[data-step-id="${stepId}"]`);
            if (stepElement) {
                stepElement.remove();

                // ÈáçÊñ∞ÁºñÂè∑Ê≠•È™§
                renumberMaintenanceSteps();

                // Â¶ÇÊûúÊ≤°ÊúâÊ≠•È™§‰∫ÜÔºåÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ
                const container = document.getElementById('maintenanceStepsContainer');
                if (container.children.length === 0) {
                    container.innerHTML = '<div style="padding: 20px; text-align: center; color: #999; font-size: 14px;" id="noStepsMessage">ÊöÇÊó†Áª¥Êä§Ê≠•È™§ÔºåÁÇπÂáª"Ê∑ªÂä†Ê≠•È™§"ÂºÄÂßãÂàõÂª∫</div>';
                }
            }
        }

        // ‰∏äÁßªÊ≠•È™§
        function moveStepUp(stepId) {
            const stepElement = document.querySelector(`[data-step-id="${stepId}"]`);
            const previousStep = stepElement.previousElementSibling;

            if (previousStep) {
                stepElement.parentNode.insertBefore(stepElement, previousStep);
                renumberMaintenanceSteps();
            }
        }

        // ‰∏ãÁßªÊ≠•È™§
        function moveStepDown(stepId) {
            const stepElement = document.querySelector(`[data-step-id="${stepId}"]`);
            const nextStep = stepElement.nextElementSibling;

            if (nextStep) {
                stepElement.parentNode.insertBefore(nextStep, stepElement);
                renumberMaintenanceSteps();
            }
        }

        // ÈáçÊñ∞ÁºñÂè∑Áª¥Êä§Ê≠•È™§
        function renumberMaintenanceSteps() {
            const steps = document.querySelectorAll('.maintenance-step');
            steps.forEach((step, index) => {
                const stepNumber = index + 1;
                const stepTitle = step.querySelector('h5');
                stepTitle.textContent = `Ê≠•È™§ ${stepNumber}`;
            });
        }

        // Ê∑ªÂä†Â∑•ÂÖ∑
        function addTool() {
            const toolInput = document.getElementById('toolInput');
            const toolName = toolInput.value.trim();

            if (toolName && !requiredTools.includes(toolName)) {
                requiredTools.push(toolName);
                updateToolsList();
                toolInput.value = '';
            }
        }

        // Âà†Èô§Â∑•ÂÖ∑
        function removeTool(toolName) {
            const index = requiredTools.indexOf(toolName);
            if (index > -1) {
                requiredTools.splice(index, 1);
                updateToolsList();
            }
        }

        // Êõ¥Êñ∞Â∑•ÂÖ∑ÂàóË°®ÊòæÁ§∫
        function updateToolsList() {
            const toolsList = document.getElementById('toolsList');
            toolsList.innerHTML = '';

            requiredTools.forEach(tool => {
                const toolTag = document.createElement('span');
                toolTag.style.cssText = `
                    display: inline-flex;
                    align-items: center;
                    padding: 4px 8px;
                    background: #3498DB;
                    color: white;
                    border-radius: 12px;
                    font-size: 12px;
                    font-weight: 500;
                `;
                toolTag.innerHTML = `
                    ${tool}
                    <button onclick="removeTool('${tool}')" style="margin-left: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 14px; padding: 0; line-height: 1;">√ó</button>
                `;
                toolsList.appendChild(toolTag);
            });
        }

        // Ëé∑ÂèñÁª¥Êä§Ê≠•È™§Êï∞ÊçÆ
        function getMaintenanceStepsData() {
            const steps = [];
            const stepElements = document.querySelectorAll('.maintenance-step');

            stepElements.forEach((stepElement, index) => {
                const description = stepElement.querySelector('.step-description').value.trim();
                const time = stepElement.querySelector('.step-time').value;
                const tools = stepElement.querySelector('.step-tools').value.trim();
                const safety = stepElement.querySelector('.step-safety').value.trim();

                if (description) {
                    steps.push({
                        stepNumber: index + 1,
                        description: description,
                        estimatedTime: time ? parseInt(time) : null,
                        requiredTools: tools ? tools.split(',').map(t => t.trim()) : [],
                        safetyWarning: safety
                    });
                }
            });

            return steps;
        }

        // Â∑•ÂÖ∑ËæìÂÖ•Ê°ÜÂõûËΩ¶‰∫ã‰ª∂
        document.addEventListener('DOMContentLoaded', function () {
            // ‰∏∫Âä®ÊÄÅÊ∑ªÂä†ÁöÑÂ∑•ÂÖ∑ËæìÂÖ•Ê°ÜÁªëÂÆöÂõûËΩ¶‰∫ã‰ª∂
            document.addEventListener('keypress', function (e) {
                if (e.target.id === 'toolInput' && e.key === 'Enter') {
                    e.preventDefault();
                    addTool();
                }
            });
        });

        // ‰øùÂ≠òÁª¥Êä§ËÆ°Âàí
        function saveMaintenancePlan(editId = null) {
            const form = document.getElementById('maintenancePlanForm');
            const formData = new FormData(form);

            // È™åËØÅÂøÖÂ°´Â≠óÊÆµ
            const requiredFields = ['deviceName', 'type', 'plannedDate', 'assignee'];
            for (let field of requiredFields) {
                if (!formData.get(field)) {
                    UserFriendlyAlert.showError(`ËØ∑Â°´ÂÜô${getFieldLabel(field)}`);
                    return;
                }
            }

            // Ëé∑ÂèñËÆæÂ§áÂõæÊ†á
            const deviceIcons = {
                'Ê∏©Â∫¶ÊéßÂà∂Âô®': 'üå°Ô∏è',
                'ÊπøÂ∫¶ÊéßÂà∂Âô®': 'üí®',
                'Ë°•ÂÖâÁÅØÁ≥ªÁªü': 'üí°',
                'ÈÄöÈ£éÁ≥ªÁªü': 'üå™Ô∏è',
                'ÁÅåÊ∫âÁ≥ªÁªü': 'üíß',
                'Âä†ÁÉ≠Âô®': 'üî•',
                'ÂÜ∑Âç¥Âô®': '‚ùÑÔ∏è',
                'CO2ÂèëÁîüÂô®': 'üí®'
            };

            // Ëé∑ÂèñÁª¥Êä§Ê≠•È™§Êï∞ÊçÆ
            const maintenanceStepsData = getMaintenanceStepsData();

            // È™åËØÅËá≥Â∞ëÊúâ‰∏Ä‰∏™Áª¥Êä§Ê≠•È™§
            if (maintenanceStepsData.length === 0) {
                UserFriendlyAlert.showError('ËØ∑Ëá≥Â∞ëÊ∑ªÂä†‰∏Ä‰∏™Áª¥Êä§Ê≠•È™§');
                return;
            }

            const planData = {
                deviceName: formData.get('deviceName'),
                deviceIcon: deviceIcons[formData.get('deviceName')] || '‚öôÔ∏è',
                type: formData.get('type'),
                plannedDate: formData.get('plannedDate'),
                priority: formData.get('priority'),
                assignee: formData.get('assignee'),
                description: formData.get('description') || '',
                maintenanceSteps: maintenanceStepsData,
                requiredTools: [...requiredTools],
                safetyNotes: formData.get('safetyNotes') || '',
                status: 'ÂæÖÊâßË°å',
                createdAt: new Date().toISOString()
            };

            if (editId) {
                // ÁºñËæëÁé∞ÊúâËÆ°Âàí
                const index = maintenancePlans.findIndex(p => p.id == editId);
                if (index !== -1) {
                    maintenancePlans[index] = { ...maintenancePlans[index], ...planData };
                    UserFriendlyAlert.showSuccess('Áª¥Êä§ËÆ°ÂàíÊõ¥Êñ∞ÊàêÂäü');
                }
            } else {
                // ÂàõÂª∫Êñ∞ËÆ°Âàí
                planData.id = Date.now(); // ÁÆÄÂçïÁöÑIDÁîüÊàê
                maintenancePlans.unshift(planData);
                UserFriendlyAlert.showSuccess('Áª¥Êä§ËÆ°ÂàíÂàõÂª∫ÊàêÂäü');
            }

            // ÂÖ≥Èó≠ÂºπÁ™ó
            closeMaintenancePlanModal();

            // Âà∑Êñ∞ÂàóË°®
            refreshMaintenanceData();
        }

        // Ëé∑ÂèñÂ≠óÊÆµÊ†áÁ≠æ
        function getFieldLabel(field) {
            const labels = {
                'deviceName': 'ËÆæÂ§áÂêçÁß∞',
                'type': 'Áª¥Êä§Á±ªÂûã',
                'plannedDate': 'ËÆ°ÂàíÊó•Êúü',
                'assignee': 'Ë¥üË¥£‰∫∫'
            };
            return labels[field] || field;
        }

        // Êü•ÁúãÁª¥Êä§ËÆ°ÂàíËØ¶ÊÉÖ
        function viewMaintenancePlan(planId) {
            const plan = maintenancePlans.find(p => p.id == planId);
            if (!plan) {
                UserFriendlyAlert.showError('Êú™ÊâæÂà∞Áª¥Êä§ËÆ°Âàí');
                return;
            }

            showMaintenancePlanDetail(plan);
        }

        // ÊòæÁ§∫Áª¥Êä§ËÆ°ÂàíËØ¶ÊÉÖ
        function showMaintenancePlanDetail(plan) {
            // ÂàõÂª∫ÈÅÆÁΩ©Â±Ç
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.3s ease;
            `;

            // ÂàõÂª∫ËØ¶ÊÉÖÂºπÁ™ó
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: white;
                border-radius: 15px;
                width: 90%;
                max-width: 500px;
                max-height: 90vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                animation: slideIn 0.3s ease;
            `;

            const priorityColors = {
                'low': '#27AE60',
                'normal': '#3498DB',
                'high': '#F39C12',
                'urgent': '#E74C3C'
            };

            const priorityLabels = {
                'low': '‰Ωé‰ºòÂÖàÁ∫ß',
                'normal': 'ÊôÆÈÄö‰ºòÂÖàÁ∫ß',
                'high': 'È´ò‰ºòÂÖàÁ∫ß',
                'urgent': 'Á¥ßÊÄ•'
            };

            const statusColors = {
                'ÂæÖÊâßË°å': '#3498DB',
                'ÊâßË°å‰∏≠': '#F39C12',
                'Â∑≤ÂÆåÊàê': '#27AE60',
                'Â∑≤ËøáÊúü': '#E74C3C',
                'Â∑≤ÂèñÊ∂à': '#95A5A6'
            };

            modal.innerHTML = `
                <div style="padding: 25px; border-bottom: 1px solid #eee;">
                    <h3 style="margin: 0; color: #333; font-size: 20px; display: flex; align-items: center; justify-content: space-between;">
                        <span style="display: flex; align-items: center;">
                            <span style="margin-right: 10px;">${plan.deviceIcon}</span>Áª¥Êä§ËÆ°ÂàíËØ¶ÊÉÖ
                        </span>
                        <button onclick="closeMaintenancePlanDetail()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">√ó</button>
                    </h3>
                </div>
                
                <div style="padding: 25px;">
                    <!-- Âü∫Êú¨‰ø°ÊÅØÂç°Áâá -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Âü∫Êú¨‰ø°ÊÅØ</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">ËÆæÂ§áÂêçÁß∞</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">${plan.deviceIcon} ${plan.deviceName}</div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Áª¥Êä§Á±ªÂûã</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">${plan.type}</div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">‰ºòÂÖàÁ∫ß</label>
                                <div style="margin-top: 5px;">
                                    <span style="background: ${priorityColors[plan.priority]}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">
                                        ${priorityLabels[plan.priority]}
                                    </span>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Áä∂ÊÄÅ</label>
                                <div style="margin-top: 5px;">
                                    <span style="background: ${statusColors[plan.status]}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">
                                        ${plan.status}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Êó∂Èó¥Âíå‰∫∫Âëò‰ø°ÊÅØ -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Êó∂Èó¥Âíå‰∫∫Âëò</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">ËÆ°ÂàíÊó•Êúü</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">${plan.plannedDate}</div>
                            </div>
                            <div>
                                <label style="font-size: 12px; color: #666; font-weight: 600;">Ë¥üË¥£‰∫∫</label>
                                <div style="font-size: 14px; color: #333; margin-top: 2px;">${plan.assignee}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Áª¥Êä§ÂÜÖÂÆπ -->
                    ${plan.description ? `
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Áª¥Êä§ÊèèËø∞</h4>
                        <div style="font-size: 14px; color: #333; line-height: 1.6;">${plan.description}</div>
                    </div>
                    ` : ''}
                    
                    <!-- Áª¥Êä§Ê≠•È™§ -->
                    ${plan.maintenanceSteps && plan.maintenanceSteps.length > 0 ? `
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">Áª¥Êä§Ê≠•È™§</h4>
                        <div style="space-y: 10px;">
                            ${plan.maintenanceSteps.map(step => `
                                <div style="background: white; border-radius: 8px; padding: 15px; margin-bottom: 10px; border-left: 4px solid #3498DB;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                        <h5 style="margin: 0; color: #333; font-size: 14px; font-weight: 600;">Ê≠•È™§ ${step.stepNumber}</h5>
                                        ${step.estimatedTime ? `<span style="background: #e9ecef; color: #495057; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">${step.estimatedTime}ÂàÜÈíü</span>` : ''}
                                    </div>
                                    <div style="font-size: 13px; color: #333; line-height: 1.5; margin-bottom: 8px;">${step.description}</div>
                                    ${step.requiredTools && step.requiredTools.length > 0 ? `
                                        <div style="margin-bottom: 8px;">
                                            <span style="font-size: 11px; color: #666; font-weight: 600;">ÊâÄÈúÄÂ∑•ÂÖ∑Ôºö</span>
                                            <span style="font-size: 12px; color: #495057;">${step.requiredTools.join(', ')}</span>
                                        </div>
                                    ` : ''}
                                    ${step.safetyWarning ? `
                                        <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 6px 10px; margin-top: 8px;">
                                            <span style="font-size: 11px; color: #856404; font-weight: 600;">‚ö†Ô∏è ÂÆâÂÖ®ÊèêÈÜíÔºö</span>
                                            <span style="font-size: 11px; color: #856404;">${step.safetyWarning}</span>
                                        </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ÊâÄÈúÄÂ∑•ÂÖ∑ -->
                    ${plan.requiredTools && plan.requiredTools.length > 0 ? `
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">ÊâÄÈúÄÂ∑•ÂÖ∑</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${plan.requiredTools.map(tool => `
                                <span style="background: #3498DB; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 500;">${tool}</span>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ÂÆâÂÖ®Ê≥®ÊÑè‰∫ãÈ°π -->
                    ${plan.safetyNotes ? `
                    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #856404; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">‚ö†Ô∏è</span>ÂÆâÂÖ®Ê≥®ÊÑè‰∫ãÈ°π
                        </h4>
                        <div style="font-size: 14px; color: #856404; line-height: 1.6;">${plan.safetyNotes}</div>
                    </div>
                    ` : ''}
                </div>
                
                <div style="padding: 20px 25px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px;">
                    <button type="button" onclick="editMaintenancePlan(${plan.id})" style="padding: 10px 20px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">ÁºñËæë</button>
                    <button type="button" onclick="closeMaintenancePlanDetail()" style="padding: 10px 20px; background: #95A5A6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">ÂÖ≥Èó≠</button>
                </div>
            `;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
            overlay.addEventListener('click', function (e) {
                if (e.target === overlay) {
                    closeMaintenancePlanDetail();
                }
            });

            // ‰øùÂ≠òÂºπÁ™óÂºïÁî®
            window.currentMaintenancePlanDetailModal = overlay;
        }

        // ÂÖ≥Èó≠Áª¥Êä§ËÆ°ÂàíËØ¶ÊÉÖÂºπÁ™ó
        function closeMaintenancePlanDetail() {
            if (window.currentMaintenancePlanDetailModal) {
                document.body.removeChild(window.currentMaintenancePlanDetailModal);
                window.currentMaintenancePlanDetailModal = null;
            }
        }

        // ÁºñËæëÁª¥Êä§ËÆ°Âàí
        function editMaintenancePlan(planId) {
            const plan = maintenancePlans.find(p => p.id == planId);
            if (!plan) {
                UserFriendlyAlert.showError('Êú™ÊâæÂà∞Áª¥Êä§ËÆ°Âàí');
                return;
            }

            // ÂÖ≥Èó≠ËØ¶ÊÉÖÂºπÁ™ó
            closeMaintenancePlanDetail();

            // ÊâìÂºÄÁºñËæëÂºπÁ™ó
            showMaintenancePlanModal(plan);
        }

        function refreshMaintenanceData() {
            // Âà∑Êñ∞Áª¥Êä§ËÆ°ÂàíÂàóË°®
            const maintenancePlansContainer = document.getElementById('maintenancePlansContainer');
            if (maintenancePlansContainer) {
                maintenancePlansContainer.innerHTML = generateMaintenancePlansHTML();
            }

            // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
            updateMaintenanceStats();

            UserFriendlyAlert.showSuccess('Áª¥Êä§Êï∞ÊçÆÂ∑≤Âà∑Êñ∞');
        }

        // Êõ¥Êñ∞Áª¥Êä§ÁªüËÆ°Êï∞ÊçÆ
        function updateMaintenanceStats() {
            const overdueCount = maintenancePlans.filter(p => {
                const planDate = new Date(p.plannedDate);
                const today = new Date();
                return planDate < today && p.status === 'ÂæÖÊâßË°å';
            }).length;

            const upcomingCount = maintenancePlans.filter(p => {
                const planDate = new Date(p.plannedDate);
                const today = new Date();
                const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
                return planDate >= today && planDate <= nextWeek && p.status === 'ÂæÖÊâßË°å';
            }).length;

            const completedCount = maintenancePlans.filter(p => p.status === 'Â∑≤ÂÆåÊàê').length;
            const totalCount = maintenancePlans.length;

            // Êõ¥Êñ∞ÁªüËÆ°ÊòæÁ§∫
            const overdueElement = document.getElementById('overdueCount');
            const upcomingElement = document.getElementById('upcomingCount');
            const completedElement = document.getElementById('completedCount');
            const totalElement = document.getElementById('totalPlansCount');

            if (overdueElement) overdueElement.textContent = overdueCount;
            if (upcomingElement) upcomingElement.textContent = upcomingCount;
            if (completedElement) completedElement.textContent = completedCount;
            if (totalElement) totalElement.textContent = totalCount;
        }

        function executeMaintenance(planId) {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÊâßË°åÊ≠§Áª¥Êä§ËÆ°ÂàíÂêóÔºü',
                function () {
                    UserFriendlyAlert.showSuccess(`Áª¥Êä§ËÆ°Âàí #${planId} ÊâßË°åÂÆåÊàê`);
                    refreshMaintenanceData();
                }
            );
        }

        function postponeMaintenance(planId) {
            UserFriendlyAlert.showInfo(`Áª¥Êä§ËÆ°Âàí #${planId} Â∑≤Âª∂Êúü`);
        }

        function cancelMaintenance(planId) {
            UserFriendlyAlert.showConfirm('Á°ÆÂÆöË¶ÅÂèñÊ∂àÊ≠§Áª¥Êä§ËÆ°ÂàíÂêóÔºü',
                function () {
                    UserFriendlyAlert.showInfo(`Áª¥Êä§ËÆ°Âàí #${planId} Â∑≤ÂèñÊ∂à`);
                    refreshMaintenanceData();
                }
            );
        }

        // ÁîüÊàêÁª¥Êä§ËÆ°ÂàíHTML
        function generateMaintenancePlansHTML() {
            return maintenancePlans.map(plan => {
                const statusColor = plan.status === 'Â∑≤ËøáÊúü' ? '#E74C3C' : plan.status === 'ÊâßË°å‰∏≠' ? '#F39C12' : plan.status === 'Â∑≤ÂÆåÊàê' ? '#27AE60' : '#3498DB';
                const priorityColor = plan.priority === 'high' || plan.priority === 'urgent' ? '#E74C3C' : plan.priority === 'low' ? '#95A5A6' : '#3498DB';

                const priorityLabel = {
                    'low': '‰Ωé',
                    'normal': '‰∏≠',
                    'high': 'È´ò',
                    'urgent': 'Á¥ßÊÄ•'
                }[plan.priority] || '‰∏≠';

                return `
                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1.5fr; border-bottom: 1px solid rgba(0, 0, 0, 0.1); transition: all 0.3s ease; background: white;" 
                     onmouseover="this.style.background='rgba(52, 73, 94, 0.05)'; this.style.transform='translateX(2px)'" 
                     onmouseout="this.style.background='white'; this.style.transform='translateX(0)'">
                    <div style="padding: 15px; display: flex; align-items: center; font-size: 13px; font-weight: 600; color: #333;">
                        <span style="margin-right: 8px; font-size: 16px;">${plan.deviceIcon}</span>
                        <div>
                            <div style="font-weight: 600;">${plan.deviceName}</div>
                            <div style="font-size: 11px; color: ${priorityColor}; margin-top: 2px;">‰ºòÂÖàÁ∫ß: ${priorityLabel}</div>
                        </div>
                    </div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${plan.type}</div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${plan.plannedDate}</div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 13px;">
                        <span style="padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; background: ${statusColor === '#E74C3C' ? 'rgba(231, 76, 60, 0.2)' : statusColor === '#F39C12' ? 'rgba(243, 156, 18, 0.2)' : statusColor === '#27AE60' ? 'rgba(39, 174, 96, 0.2)' : 'rgba(52, 152, 219, 0.2)'}; color: ${statusColor}; border: 1px solid ${statusColor === '#E74C3C' ? 'rgba(231, 76, 60, 0.3)' : statusColor === '#F39C12' ? 'rgba(243, 156, 18, 0.3)' : statusColor === '#27AE60' ? 'rgba(39, 174, 96, 0.3)' : 'rgba(52, 152, 219, 0.3)'};">
                            ${plan.status}
                        </span>
                    </div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${plan.assignee}</div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 5px;">
                        <button style="padding: 4px 8px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="viewMaintenancePlan(${plan.id})" title="Êü•ÁúãËØ¶ÊÉÖ">Êü•Áúã</button>
                        <button style="padding: 4px 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="executeMaintenance(${plan.id})" title="ÊâßË°åÁª¥Êä§">ÊâßË°å</button>
                        <button style="padding: 4px 8px; background: #F39C12; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px;" onclick="postponeMaintenance(${plan.id})" title="Âª∂Êúü">Âª∂Êúü</button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // ÁîüÊàêÁª¥Êä§ËÆ∞ÂΩïHTML
        function generateMaintenanceRecordsHTML() {
            const maintenanceRecords = [
                { id: 1, deviceName: 'Ê∏©Â∫¶ÊéßÂà∂Âô®', deviceIcon: 'üå°Ô∏è', type: 'ÂÆöÊúüÊ£ÄÊü•', completedDate: '2024-01-10', duration: '2Â∞èÊó∂', executor: 'Âº†Â∑•Á®ãÂ∏à', notes: 'ËÆæÂ§áËøêË°åÊ≠£Â∏∏ÔºåÂ∑≤Êõ¥Êñ∞Ê†°ÂáÜÂèÇÊï∞' },
                { id: 2, deviceName: 'ÁÅåÊ∫âÁ≥ªÁªü', deviceIcon: 'üíß', type: 'ÁÆ°ÈÅìÊ∏ÖÊ¥ó', completedDate: '2024-01-08', duration: '3Â∞èÊó∂', executor: 'ÊùéÊäÄÂ∏à', notes: 'Ê∏ÖÁêÜ‰∫ÜÂ†µÂ°ûÁöÑÂñ∑Â§¥ÔºåÊõ¥Êç¢‰∫ÜËÄÅÂåñÁöÑÂØÜÂ∞ÅÂúà' },
                { id: 3, deviceName: 'Ë°•ÂÖâÁÅØ', deviceIcon: 'üí°', type: 'ÁÅØÊ≥°Êõ¥Êç¢', completedDate: '2024-01-05', duration: '1Â∞èÊó∂', executor: 'ÁéãÂ∏àÂÇÖ', notes: 'Êõ¥Êç¢‰∫Ü3‰∏™ËÄÅÂåñÁöÑLEDÁÅØÊ≥°Ôºå‰∫ÆÂ∫¶ÊÅ¢Â§çÊ≠£Â∏∏' },
                { id: 4, deviceName: 'ÈÄöÈ£éÁ≥ªÁªü', deviceIcon: 'üå™Ô∏è', type: 'Êª§ÁΩëÊ∏ÖÊ¥ó', completedDate: '2024-01-03', duration: '1.5Â∞èÊó∂', executor: 'ÈôàÊäÄÂ∏à', notes: 'Ê∏ÖÊ¥ó‰∫ÜËøõÈ£éÂè£Êª§ÁΩëÔºåÈ£éÈáèÊòéÊòæÊîπÂñÑ' },
                { id: 5, deviceName: 'Âä†ÁÉ≠Âô®', deviceIcon: 'üî•', type: 'ÂÆâÂÖ®Ê£ÄÊü•', completedDate: '2024-01-01', duration: '2.5Â∞èÊó∂', executor: 'ÂàòÂ∑•Á®ãÂ∏à', notes: 'Ê£ÄÊü•‰∫ÜÂä†ÁÉ≠ÂÖÉ‰ª∂ÂíåÊ∏©ÊéßÁ≥ªÁªüÔºå‰∏ÄÂàáÊ≠£Â∏∏' },
                { id: 6, deviceName: 'ÊπøÂ∫¶‰º†ÊÑüÂô®', deviceIcon: 'üí®', type: 'Ê†°ÂáÜÊ£ÄÊµã', completedDate: '2023-12-28', duration: '1Â∞èÊó∂', executor: 'ËµµÊäÄÂ∏à', notes: 'ÈáçÊñ∞Ê†°ÂáÜ‰∫Ü‰º†ÊÑüÂô®ÔºåÁ≤æÂ∫¶ÊèêÂçáÂà∞¬±2%' },
                { id: 7, deviceName: 'Ê∞¥Ê≥µ', deviceIcon: '‚ö°', type: 'Ê∂¶Êªë‰øùÂÖª', completedDate: '2023-12-25', duration: '2Â∞èÊó∂', executor: 'Â≠ôÂ∏àÂÇÖ', notes: 'Êõ¥Êç¢‰∫ÜÊ∂¶ÊªëÊ≤πÔºåÊ£ÄÊü•‰∫ÜËΩ¥ÊâøÁ£®ÊçüÊÉÖÂÜµ' },
                { id: 8, deviceName: 'CO2‰º†ÊÑüÂô®', deviceIcon: 'üåø', type: 'Á≤æÂ∫¶Ê†°È™å', completedDate: '2023-12-22', duration: '1.5Â∞èÊó∂', executor: 'Âë®ÊäÄÂ∏à', notes: '‰ΩøÁî®Ê†áÂáÜÊ∞î‰ΩìÊ†°È™åÔºåÁ≤æÂ∫¶Á¨¶ÂêàË¶ÅÊ±Ç' }
            ];

            return maintenanceRecords.map(record => `
                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr 2fr; border-bottom: 1px solid rgba(0, 0, 0, 0.1); transition: all 0.3s ease; background: white;" 
                     onmouseover="this.style.background='rgba(52, 73, 94, 0.05)'; this.style.transform='translateX(2px)'" 
                     onmouseout="this.style.background='white'; this.style.transform='translateX(0)'">
                    <div style="padding: 15px; display: flex; align-items: center; font-size: 13px; font-weight: 600; color: #333;">
                        <span style="margin-right: 8px; font-size: 16px;">${record.deviceIcon}</span>
                        <div style="font-weight: 600;">${record.deviceName}</div>
                    </div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${record.type}</div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${record.completedDate}</div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${record.duration}</div>
                    <div style="padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #666;">${record.executor}</div>
                    <div style="padding: 15px; font-size: 11px; color: #666; line-height: 1.4;">${record.notes}</div>
                </div>
            `).join('');
        }



        // Âä†ËΩΩËÆæÂ§áÊéßÂà∂ÂÜÖÂÆπ
        function loadDevicesContent(container) {
            container.innerHTML = `
                <!-- Ê∏©ÂÆ§ÈÄâÊã©Âô® -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">üè†</span>Ê∏©ÂÆ§ÈÄâÊã©
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="device-greenhouse-btn active" onclick="selectDeviceGreenhouse(1)" style="padding: 12px 20px; background: #2C3E50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">1Âè∑Ê∏©ÂÆ§ (Ëî¨ËèúÂå∫)</button>
                        <button class="device-greenhouse-btn" onclick="selectDeviceGreenhouse(2)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">2Âè∑Ê∏©ÂÆ§ (Ëä±ÂçâÂå∫)</button>
                        <button class="device-greenhouse-btn" onclick="selectDeviceGreenhouse(3)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">3Âè∑Ê∏©ÂÆ§ (ËÇ≤ËãóÂå∫)</button>
                        <button class="device-greenhouse-btn" onclick="selectDeviceGreenhouse(4)" style="padding: 12px 20px; background: #95A5A6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">4Âè∑Ê∏©ÂÆ§ (ÂÆûÈ™åÂå∫)</button>
                    </div>
                </div>

                <!-- ËÆæÂ§áÊéßÂà∂Êìç‰ΩúÊ†è -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üõ†Ô∏è</span>ËÆæÂ§áÊìç‰Ωú
                        </h3>
                        <div style="display: flex; gap: 10px;">
                            <span style="padding: 8px 12px; background: #27AE60; color: white; border-radius: 20px; font-size: 12px; font-weight: 600;">ËøêË°å‰∏≠: 8</span>
                            <span style="padding: 8px 12px; background: #F39C12; color: white; border-radius: 20px; font-size: 12px; font-weight: 600;">ÂæÖÊú∫: 3</span>
                            <span style="padding: 8px 12px; background: #95A5A6; color: white; border-radius: 20px; font-size: 12px; font-weight: 600;">ÂÖ≥Èó≠: 1</span>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <button style="padding: 12px 20px; background: #27AE60; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="startAllDevices()">üöÄ ÂêØÂä®ÊâÄÊúâËÆæÂ§á</button>
                        <button style="padding: 12px 20px; background: #E74C3C; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="stopAllDevices()">üõë ÂÅúÊ≠¢ÊâÄÊúâËÆæÂ§á</button>
                        <button style="padding: 12px 20px; background: #3498DB; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="refreshDevices()">üîÑ Âà∑Êñ∞Áä∂ÊÄÅ</button>
                        <button style="padding: 12px 20px; background: #8E44AD; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;" onclick="exportDeviceStatus()">üì§ ÂØºÂá∫Áä∂ÊÄÅ</button>
                    </div>
                </div>

                <!-- ËÆæÂ§áÁΩëÊ†º -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #333; display: flex; align-items: center;">
                        <span style="margin-right: 10px;">‚öôÔ∏è</span>ËÆæÂ§áÂàóË°®
                        <span style="margin-left: auto; font-size: 14px; color: #666; font-weight: normal;">ÁÇπÂáªËÆæÂ§áÂç°ÁâáÊü•ÁúãËØ¶ÁªÜÊéßÂà∂</span>
                    </h3>
                    <div id="devicesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        ${generateDeviceCards(currentDeviceGreenhouse)}
                    </div>
                </div>

                <!-- Áª¥Êä§ÁÆ°ÁêÜÊ¶ÇËßà -->
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">üîß</span>Áª¥Êä§ÁÆ°ÁêÜ‰∏≠ÂøÉ
                        </h3>
                        <div style="display: flex; gap: 10px;">
                            <button style="padding: 8px 16px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="createMaintenancePlan()">+ ÂàõÂª∫Áª¥Êä§ËÆ°Âàí</button>
                            <button style="padding: 8px 16px; background: #3498DB; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="refreshMaintenanceData()">üîÑ Âà∑Êñ∞</button>
                        </div>
                    </div>
                    
                    <!-- Áª¥Êä§Áä∂ÊÄÅÁªüËÆ° -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #E74C3C;">
                            <div style="font-size: 24px; font-weight: bold; color: #E74C3C; margin-bottom: 5px;" id="overdueCount">2</div>
                            <div style="font-size: 14px; color: #666;">Â∑≤ËøáÊúü</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #F39C12;">
                            <div style="font-size: 24px; font-weight: bold; color: #F39C12; margin-bottom: 5px;" id="upcomingCount">5</div>
                            <div style="font-size: 14px; color: #666;">Âç≥Â∞ÜÂà∞Êúü</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #27AE60;">
                            <div style="font-size: 24px; font-weight: bold; color: #27AE60; margin-bottom: 5px;" id="completedCount">12</div>
                            <div style="font-size: 14px; color: #666;">Â∑≤ÂÆåÊàê</div>
                        </div>
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; text-align: center; border-left: 4px solid #3498DB;">
                            <div style="font-size: 24px; font-weight: bold; color: #3498DB; margin-bottom: 5px;" id="totalPlansCount">19</div>
                            <div style="font-size: 14px; color: #666;">ÊÄªËÆ°ÂàíÊï∞</div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ËÆ°ÂàíÂàóË°® -->
                    <div style="margin-bottom: 30px;">
                        <h4 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">üìã</span>Áª¥Êä§ËÆ°Âàí
                        </h4>
                        <div style="background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                            <!-- Ë°®Â§¥ -->
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1.5fr; background: #34495E; color: white; font-weight: 600; font-size: 13px;">
                                <div style="padding: 12px 15px;">ËÆæÂ§áÂêçÁß∞</div>
                                <div style="padding: 12px 15px; text-align: center;">Áª¥Êä§Á±ªÂûã</div>
                                <div style="padding: 12px 15px; text-align: center;">ËÆ°ÂàíÊó•Êúü</div>
                                <div style="padding: 12px 15px; text-align: center;">Áä∂ÊÄÅ</div>
                                <div style="padding: 12px 15px; text-align: center;">Ë¥üË¥£‰∫∫</div>
                                <div style="padding: 12px 15px; text-align: center;">Êìç‰Ωú</div>
                            </div>
                            <!-- Áª¥Êä§ËÆ°ÂàíÊï∞ÊçÆ -->
                            <div id="maintenancePlansContainer">
                                ${generateMaintenancePlansHTML()}
                            </div>
                        </div>
                    </div>

                    <!-- Áª¥Êä§ËÆ∞ÂΩïÂàóË°® -->
                    <div>
                        <h4 style="margin-bottom: 15px; color: #333; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">üìù</span>Áª¥Êä§ËÆ∞ÂΩï
                        </h4>
                        <div style="background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                            <!-- Ë°®Â§¥ -->
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr 2fr; background: #2C3E50; color: white; font-weight: 600; font-size: 13px;">
                                <div style="padding: 12px 15px;">ËÆæÂ§áÂêçÁß∞</div>
                                <div style="padding: 12px 15px; text-align: center;">Áª¥Êä§Á±ªÂûã</div>
                                <div style="padding: 12px 15px; text-align: center;">ÂÆåÊàêÊó•Êúü</div>
                                <div style="padding: 12px 15px; text-align: center;">ËÄóÊó∂</div>
                                <div style="padding: 12px 15px; text-align: center;">ÊâßË°å‰∫∫</div>
                                <div style="padding: 12px 15px;">Â§áÊ≥®</div>
                            </div>
                            <!-- Áª¥Êä§ËÆ∞ÂΩïÊï∞ÊçÆ -->
                            <div id="maintenanceRecordsContainer">
                                ${generateMaintenanceRecordsHTML()}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ÁîüÊàêËÆæÂ§áÂç°Áâá
        function generateDeviceCards(greenhouseId) {
            const devices = [
                { name: 'Ê∏©Â∫¶ÊéßÂà∂Âô®', icon: 'üå°Ô∏è', status: 'ËøêË°å‰∏≠', color: '#27AE60' },
                { name: 'ÊπøÂ∫¶ÊéßÂà∂Âô®', icon: 'üí®', status: 'ËøêË°å‰∏≠', color: '#3498DB' },
                { name: 'Ë°•ÂÖâÁÅØÁ≥ªÁªü', icon: 'üí°', status: 'ÂæÖÊú∫', color: '#F39C12' },
                { name: 'ÈÄöÈ£éÁ≥ªÁªü', icon: 'üå™Ô∏è', status: 'ËøêË°å‰∏≠', color: '#27AE60' },
                { name: 'ÁÅåÊ∫âÁ≥ªÁªü', icon: 'üíß', status: 'ËøêË°å‰∏≠', color: '#3498DB' },
                { name: 'Âä†ÁÉ≠Âô®', icon: 'üî•', status: 'ÂÖ≥Èó≠', color: '#95A5A6' }
            ];

            return devices.map(device => `
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: all 0.3s; cursor: pointer;" 
                     onmouseover="this.style.boxShadow='0 6px 20px rgba(0,0,0,0.15)'; this.style.transform='translateY(-2px)'" 
                     onmouseout="this.style.boxShadow='0 4px 15px rgba(0,0,0,0.1)'; this.style.transform='translateY(0)'">
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 32px; margin-right: 15px;">${device.icon}</div>
                        <div style="flex: 1;">
                            <div style="font-size: 18px; font-weight: bold; color: #333;">${device.name}</div>
                            <div style="color: ${device.color}; font-size: 14px; font-weight: 600;">${device.status}</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button style="flex: 1; padding: 8px; background: #27AE60; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="event.stopPropagation(); startDevice('${device.name}')">ÂêØÂä®</button>
                        <button style="flex: 1; padding: 8px; background: #E74C3C; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;" onclick="event.stopPropagation(); stopDevice('${device.name}')">ÂÅúÊ≠¢</button>
                    </div>
                </div>
            `).join('');
        }

        // Ê∏©ÂÆ§ÈÄâÊã©ÂáΩÊï∞
        function selectDeviceGreenhouse(greenhouseId) {
            currentDeviceGreenhouse = greenhouseId;

            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.device-greenhouse-btn').forEach(btn => {
                btn.style.background = '#95A5A6';
            });
            event.target.style.background = '#2C3E50';

            // ÈáçÊñ∞ÁîüÊàêËÆæÂ§áÁΩëÊ†º
            const devicesGrid = document.getElementById('devicesGrid');
            if (devicesGrid) {
                devicesGrid.innerHTML = generateDeviceCards(greenhouseId);
            }

            UserFriendlyAlert.showInfo(`Â∑≤ÂàáÊç¢Âà∞${greenhouseId}Âè∑Ê∏©ÂÆ§`);
        }

        function exportDeviceStatus() {
            UserFriendlyAlert.showSuccess('ËÆæÂ§áÁä∂ÊÄÅÂØºÂá∫ÊàêÂäü');
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function () {
            // ÂàùÂßãÂåñÂä†ËΩΩËÆæÂ§áÊéßÂà∂È°µÈù¢ÂÜÖÂÆπ
            if (currentPage === 'devices') {
                loadPageContent('devices');
            }

            // Ê®°ÊãüÁ≥ªÁªüÁä∂ÊÄÅÊõ¥Êñ∞
            setInterval(function () {
                const deviceCount = Math.floor(Math.random() * 3) + 10;
                const alertCount = Math.floor(Math.random() * 5) + 1;

                document.getElementById('deviceCount').textContent = deviceCount;
                document.getElementById('alertCount').textContent = alertCount;
            }, 60000);
        });
    </script>
</body>

</html>